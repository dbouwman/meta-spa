define(function(){return function(t){function e(e){for(var o,a,s=e[0],u=e[1],c=e[2],p=0,l=[];p<s.length;p++)a=s[p],r[a]&&l.push(r[a][0]),r[a]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(t[o]=u[o]);for(d&&d(e);l.length;)l.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,s=1;s<n.length;s++){var u=n[s];0!==r[u]&&(o=!1)}o&&(i.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},r={1:0},i=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var d=u;return i.push([282,0]),n()}([,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(6),r=n(1),i=n(5);function a(t,e){r(e[t],"no layout in appConfig with id "+t);var n=o.isImmutable(e[t])?e[t]:o(e[t]),i=null,a={};Object.keys(n).forEach(function(t){if(!isNaN(parseInt(t))){var e=n[t];if(a[t]||(a[t]=[]),void 0===e.parentId)return r(null===i,"Only one root layout is allowed"),void(i=t);var o=e.parentId;n[o]&&(a[o]||(a[o]=[]),a[o].push(t))}}),r(null!==i,"Root layout id missing");var s={},u=function(e){if(0===a[e].length)return s[e]=o(n[e]).set("layoutId",t),s[e];var r=[];return a[e].forEach(function(t){r.push(u(t))}),s[e]=o(n[e]).update("content",function(t){return[].concat(t||[],r)}).set("layoutId",t),s[e]};return u(i),s[i]}function s(t,e){return Math.round(100*t/e)}function u(t,e){return t*e/100}function c(t,e,n,o){if(null==n&&null==o)return t;var r=t.x,i=t.y,a=t.w,s=t.h;return n?r=(e-a)/2:"right"===o&&(r=Math.max(0,e-r-a)),{x:r,y:i,w:a,h:s}}function d(t,e,n){var o=t.x,r=t.y,i=t.w,a=t.h;return"bottom"===n&&(r=Math.max(0,e-r-a)),{x:o,y:r,w:i,h:a}}e.emptyFunc=function(){},e.perc=function(t){return 100*t+"%"},e.clamp=function(t,e,n){return Math.min(n,Math.max(e,t))},e.autoBindHandlers=function(t,e){e.forEach(function(e){return t[e]=t[e].bind(t)})},e.setTransform=function(t){var e=t.x,n=t.y,o=t.h,r="translate("+e+"px,"+n+"px)";return{transform:r,WebkitTransform:r,MozTransform:r,msTransform:r,OTransform:r,width:t.w+"px",height:o+"px",position:"absolute"}},e.isStaticLayout=function(t){return t.setting&&!0===t.setting.static},e.isActiveLayout=function(t){return t.setting&&!0===t.setting.active},e.getSectionLayout=function(t,e){return t?a(t,e.layouts):{info:{layoutId:t,layoutItemId:"10000"},pos:{x:0,y:0,w:100,h:100},setting:{widthInPixel:!1,heightInPixel:!1}}},e.getMaximumId=function(t){var e=-1;return Object.keys(t).forEach(function(t){var n=parseInt(t);n>e&&(e=n)}),e},e.generateLayoutStructure=a,e.setNextNodeId=function(t){t},e.randomColor=function(){return"rgba("+Math.floor(255*Math.random())+", "+Math.floor(255*Math.random())+", "+Math.floor(255*Math.random())+", 0.5)"},e.getLayoutItem=function(t,e){for(var n=0,o=(t=t||[]).length;n<o;n++)if(t[n].id===e)return t[n]},e.validateLayoutType=function(t){return t===i.LayoutType.SIDEBAR_LAYOUT||t===i.LayoutType.FIXED_LAYOUT||t===i.LayoutType.GRID_LAYOUT||t===i.LayoutType.WIDGET||t===i.LayoutType.SECTION_LAYOUT?t:i.LayoutType.UNKNOWN},e.useInteract=function(){return!(!window||!window.jimuConfig)&&window.jimuConfig.isInBuilder},e.adjustHorizontal=c,e.adjustVertical=d,e.calPixelPosition=function(t,e,n,o){var r=o.xyInPixel,i=o.alignCenter,a=o.hPriority,s=o.vPriority,p=o.widthInPixel,l=o.heightInPixel,f=o.gridSize||1,g=t.x,y=t.y,h=t.w,I=t.h;return r?(g=Math.round(g/f)*f,y=Math.round(y/f)*f):(g=Math.round(u(g,e)/f)*f,y=Math.round(u(y,n)/f)*f),d(c({x:g,y:y,w:h=isNaN(parseInt(""+h))?e-g:p?Math.round(h/f)*f:Math.round(u(h,e)/f)*f,h:I=isNaN(parseInt(""+I))?n-y:l?Math.round(I/f)*f:Math.round(u(I,n)/f)*f},e,i,a),n,s)},e.calLayoutPosition=function(t,e,n,o){var r=t.x,i=t.y,a=t.w,u=t.h,c=o.xyInPixel,d=o.widthInPixel,p=o.heightInPixel;return o.restrict&&(r=Math.max(0,r),i=Math.max(0,i),r+a>=e&&(r=e-a,a=1/0),i+u>=n&&(i=n-u,u=1/0)),c||(r=s(r,e),i=s(i,n)),d||a===1/0||(a=s(a,e)),p||u===1/0||(u=s(u,n)),{x:r,y:i,w:a,h:u}}},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.UNKNOWN="unknown",t.FIXED_LAYOUT="fixed",t.GRID_LAYOUT="grid",t.WIDGET="widget",t.SIDEBAR_LAYOUT="sidebar",t.SECTION_LAYOUT="section",t.VERTICAL_LAYOUT="vertical"}(e.LayoutType||(e.LayoutType={})),function(t){t.TOP="top",t.LEFT="left",t.BOTTOM="bottom",t.RIGHT="right"}(e.AttachType||(e.AttachType={})),function(t){t[t.BRING_FORWARD=0]="BRING_FORWARD",t[t.SEND_BACKWARD=1]="SEND_BACKWARD",t[t.BRING_TO_FRONT=2]="BRING_TO_FRONT",t[t.SEND_TO_BACK=3]="SEND_TO_BACK"}(e.OrderAdjustType||(e.OrderAdjustType={})),function(t){t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t.NONE="none"}(e.CompactType||(e.CompactType={}))},,,,function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(14),s=n(5),u=n(51),c=n(3),d=n(146),p=n(25);n(140);var l=n(13),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={hasFocus:!1},e}return o(e,t),e.prototype._onMouseEnter=function(){this.setState({hasFocus:!0})},e.prototype._onMouseLeave=function(){this.setState({hasFocus:!1})},e.prototype.render=function(){var t,e=this,n=this.props,o=n.pos,f=n.layout,g=n.style,y=n.className,h=n.appMode,I=o.x,m=o.y,v=o.w,_=o.h;f.type===s.LayoutType.WIDGET?t=i.createElement(d.default,{layout:f,widgetId:f.widgetId}):c.useInteract()&&u.isRegistered(f.type)?t=u.LayoutFactory.createLayout(f.type,f,{width:o.w,height:o.h,appMode:h}):!c.useInteract()&&u.isViewerRegistered(f.type)&&(t=u.LayoutFactory.createLayoutViewer(f,{width:o.w,height:o.h,appMode:h}));var b=h!==l.AppMode.Run&&(c.isActiveLayout(f)||this.state.hasFocus&&f.type===s.LayoutType.WIDGET),w=r({},c.setTransform({x:I,y:m,w:v,h:_}),g,f.setting&&f.setting.style||{}),O=a("layout-item",y,f.setting&&f.setting.className,{"has-focus":b});return i.createElement(p.ActionContext.Consumer,null,function(n){return i.createElement("div",{"data-layoutitemid":f.id,"data-layoutid":f.layoutId,className:O,style:w,onClick:function(t){h===l.AppMode.Design&&(t.preventDefault(),t.stopPropagation(),n.activate({layoutId:f.layoutId,layoutItemId:f.id}))},onMouseEnter:function(){e._onMouseEnter()},onMouseLeave:function(){e._onMouseLeave()}},i.createElement("div",{className:"layout-item__content"},t))})},e}(i.PureComponent);e.LayoutItem=f},function(t,e,n){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.InitStoreExtensionState="INIT_STORE_EXTENSION_STATE",t.AppConfigLoaded="APPCONFIG_LOADED",t.AppConfigChanged="APPCONFIG_CHANGED",t.InitPortalUrl="INIT_PORTAL_URL",t.WidgetClassLoaded="WIDGET_CLASS_LOADED",t.OpenWidget="OPEN_WIDGET",t.CloseWidget="CLOSE_WIDGET",t.SetWidgetIsSettingState="SET_WIDGET_IS_SETTING_STATE",t.SetAppInBuilder="SET_APP_IN_BUILDER",t.LayoutClassLoaded="LAYOUT_CLASS_LOADED",t.AppContextInit="APP_CONTEXT_INIT",t.JimuCoreNlsLoaded="JIMU_CORE_NLS_LOADED",t.QueryObjectChanged="QUERY_OBJECT_CHANGED",t.AppModeChanged="APP_MODE_CHANGED",t.DataSourceStatusChanged="DATA_SOURCE_STATUS_CHANGE",t.DataSourceCurrentIndexesChanged="DATA_SOURCE_CURRENT_INDEXES_CHANGE",t.ToggleWidgetHighLight="TOGGLE_WIDGET_HIGH_LIGHT",t.WidgetStatePropChange="WIDGET_STATE_PROP_CHANGE",t.SessionStart="SESSION_START",t.UserSignIn="USER_SIGN_IN",t.UserSignOut="USER_SIGN_OUT",t.IsMobileChanged="IS_MOBILE_CHANGED"}(o=e.ActionKeys||(e.ActionKeys={})),e.appConfigLoaded=function(t){return{type:o.AppConfigLoaded,appConfig:t}},e.appConfigChanged=function(t,e){return{type:o.AppConfigChanged,appConfig:t,appConfigDiff:e}},e.widgetClassLoaded=function(t){return{type:o.WidgetClassLoaded,widgetId:t}},e.openWidget=function(t){return{type:o.OpenWidget,widgetId:t}},e.closeWidget=function(t){return{type:o.CloseWidget,widgetId:t}},e.initAppContext=function(t){return{type:o.AppContextInit,appContext:t}},e.jimuCoreNlsLoaded=function(t){return{type:o.JimuCoreNlsLoaded,nls:t}},e.queryObjectChanged=function(t){return{type:o.QueryObjectChanged,query:t}},e.setAppInBuilder=function(){return{type:o.SetAppInBuilder}},e.appModeChanged=function(t){return{type:o.AppModeChanged,mode:t}},e.toggleWidgetHighlight=function(t,e){return{type:o.ToggleWidgetHighLight,widgetId:t,isHighlight:e}},e.layoutClassLoaded=function(t){return{type:o.LayoutClassLoaded,layoutName:t}},e.dataSourceStatusChanged=function(t,e){return{type:o.DataSourceStatusChanged,dataSourceId:t,status:e}},e.initStoreExtensionState=function(){return{type:o.InitStoreExtensionState}},e.widgetStatePropChange=function(t,e,n){return{type:o.WidgetStatePropChange,widgetId:t,propKey:e,value:n}},e.initPortalUrl=function(t){return{type:o.InitPortalUrl,portalUrl:t}},e.dataSourceCurrentIndexesChanged=function(t,e){return{type:o.DataSourceCurrentIndexesChanged,dataSourceId:t,currentIndexes:e}},e.sessionStart=function(t){return{type:o.SessionStart,token:t}},e.userSignIn=function(t){return{type:o.UserSignIn,user:t}},e.userSignOut=function(){return{type:o.UserSignOut}},e.isMobileChanged=function(t){return{type:o.IsMobileChanged,isMobile:t}},e.setWidgetIsSettingState=function(t,e){return{type:o.SetWidgetIsSettingState,widgetId:t,isSetting:e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(267),r=n(68);e.store=r.createStore(o.default,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())},function(t,e,n){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.AppConfigProcessor="APP_CONFIG_PROCESSOR",t.WidgetClassWrapper="WIDGET_CLASS_WRAPPER",t.AppConfigService="APP_CONFIG_SERVICE",t.ReduxStore="REDUX_STORE",t.DependencyDefine="DEPENDENCY_DEFINE",t.DataSourceFactory="DATA_SOURCE_FACTORY"}(o=e.ExtensionPoints||(e.ExtensionPoints={})),e.EP_SUPPORT_MULTIPLE_EXTENTIONS=[o.ReduxStore,o.DataSourceFactory];var r=function(){return function(){}}();e.DummyExtension=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Fetching="FETCHING",t.Success="SUCCESS",t.Error="ERROR"}(e.AjaxState||(e.AjaxState={})),function(t){t.Config="CONFIG",t.Design="DESIGN",t.Preview="PREVIEW",t.Run="RUN"}(e.AppMode||(e.AppMode={}))},,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(21),r=n(32),i=n(12),a=function(){function t(){this.extensions={},this.extensionClasses={}}return t.getInstance=function(){return t.instance||(t.instance=new t,window._extensionManager=t.instance),t.instance},t.prototype.getExtensions=function(t){return this.extensions[t]||[]},t.prototype.onStoreChange=function(){},t.prototype.registerExtension=function(t){this.getExtensionById(t.extension.id)?console.log("Extension "+t.extension.id+" has been registered."):this.extensions[t.epName]?i.EP_SUPPORT_MULTIPLE_EXTENTIONS.indexOf(t.epName)>-1&&(this.extensions[t.epName].push(t.extension),this.extensions[t.epName]=this.extensions[t.epName].sort(function(t,e){return t.index-e.index})):this.extensions[t.epName]=[t.extension]},t.prototype.registerAllWidgetExtensions=function(t){var e=this,n=[];return o.getAllWidgets(t).forEach(function(t){n.push(e.registerWidgetExtensions(t))}),Promise.all(n)},t.prototype.clean=function(){this.extensions={}},t.prototype.registerWidgetExtensions=function(t){var e=this,n=[];return t.manifest.extentions&&t.manifest.extentions.forEach(function(o){n.push(e.registerWidgetExtension(t,o))}),Promise.all(n)},t.prototype.registerWidgetExtension=function(t,e){var n=this;if(this.extensions[e.point]){if(!i.EP_SUPPORT_MULTIPLE_EXTENTIONS[e.point])return Promise.resolve();if(this.extensions[e.point].filter(function(n){return n.name===e.name&&n.widgetId===t.id}).length>0)return Promise.resolve()}return this.loadWidgetExtensionClass(t,e).then(function(t){var o=new t;n.registerExtension({epName:e.point,extension:o})})},t.prototype.loadWidgetExtensionClass=function(t,e){var n=t.manifest.name+"-"+e.name;if(this.extensionClasses[n])return Promise.resolve(this.extensionClasses[n]);var o=t.context.amdFolder+"dist/"+e.uri;return r.amdRequire(o).then(function(t){return t.default})},t.prototype.getExtensionById=function(t){for(var e in this.extensions){return this.extensions[e].filter(function(e){return e.id===t})[0]}},t}();e.default=a},function(t,e,n){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.ADD_LAYOUT="GLOBAL_ADD_LAYOUT",t.REMOVE_LAYOUT="GLOBAL_REMOVE_LAYOUT",t.UPDATE_LAYOUT="GLOBAL_UPDATE_LAYOUT",t.RESIZE_LAYOUTS="GLOBAL_RESIZE_LAYOUTS",t.DRAG_DROP_LAYOUT="GLOBAL_DRAG_DROP_LAYOUT",t.ADD_WIDGET="GLOBAL_ADD_WIDGET",t.REMOVE_WIDGET="GLOBAL_REMOVE_WIDGET",t.ACTIVATE="GLOBAL_ACTIVATE",t.UPDATE_SETTING="GLOBAL_UPDATE_SETTING",t.ADD_SECTION="GLOBAL_ADD_SECTION",t.REMOVE_SECTION="GLOBAL_REMOVE_SECTION",t.CHANGE_ORDER="GLOBAL_CHANGE_ORDER"}(o=e.GlobalLayoutActions||(e.GlobalLayoutActions={})),e.updateLayout=function(t,e,n){return{type:o.UPDATE_LAYOUT,layoutInfo:t,pos:e,newSetting:n}},e.updateSetting=function(t,e){return{type:o.UPDATE_SETTING,layoutInfo:t,newSetting:e}},e.addLayout=function(t,e,n,r){return{type:o.ADD_LAYOUT,layoutId:t,parentId:e,initPosition:n,layoutType:r}},e.removeLayout=function(t){return{type:o.REMOVE_LAYOUT,layoutInfo:t}},e.resizeLayouts=function(t,e){return{type:o.RESIZE_LAYOUTS,layouts:t,breakpoint:e}},e.dndLayout=function(t,e,n){return{type:o.DRAG_DROP_LAYOUT,layoutInfo:t,parentLayoutInfo:e,newPosition:n}},e.activate=function(t){return{type:o.ACTIVATE,layoutInfo:t}},e.removeWidget=function(t){return{type:o.REMOVE_WIDGET,widgetId:t}},e.addWidget=function(t,e){return{type:o.ADD_WIDGET,widgetId:t,layoutInfo:e}},e.addSection=function(t,e){return{type:o.ADD_SECTION,sectionId:t,layoutInfo:e}},e.removeSection=function(t){return{type:o.REMOVE_SECTION,sectionId:t}},e.changeOrder=function(t,e){return{type:o.CHANGE_ORDER,layoutInfo:t,orderType:e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(107);e.getWidgetContext=function(t){var e={};return e.amdFolder=t,/\/$/.test(e.amdFolder)||(e.amdFolder+="/"),e.folderUrl=window.amdRequire.toUrl(e.amdFolder),/^http(s)?:\/\//.test(t)||/^\/\//.test(t)?e.isRemote=!0:e.isRemote=!1,e},e.addThemeManifestProperies=function(t){t.panels.forEach(function(t){t.uri="panels/"+t.name+"/Panel.js"}),t.styles.forEach(function(t){t.uri="styles/"+t.name+"/style.css"}),t.layouts.forEach(function(t){t.uri="layouts/"+t.name+"/config.json",t.icon="layouts/"+t.name+"/icon.png",t.RTLIcon="layouts/"+t.name+"/icon_rtl.png"})},e.addWidgetManifestProperties=function(t){void 0===t.properties&&(t.properties={}),["isController","hasVersionManager","isDojoWidget"].forEach(function(e){void 0===t.properties[e]&&(t.properties[e]=!1)}),["inPanel","hasMainClass","hasLocale","hasConfig","hasSettingPage","hasSettingLocale","keepConfigAfterMapSwitched","isController","hasVersionManager","supportMultiInstance"].forEach(function(e){void 0===t.properties[e]&&(t.properties[e]=!0)})},e.addWidgetDefaultLabelAndIcon=function(t){t.icon=t.icon?t.icon:t.context.folderUrl+"dist/runtime/assets/icon.svg",t.label=t.label?t.label:t.manifest.name},e.getAllWidgets=function(t){var e=[];return Object.keys(t.widgets).forEach(function(n){e.push(t.widgets[n])}),e},e.getWidgetsByName=function(t,e){var n=[];return Object.keys(t.widgets).forEach(function(o){t.widgets[o].manifest.name===e&&n.push(t.widgets[o])}),n},e.getCleanAppConfig=function(t){var e=t.asMutable({deep:!0});return Object.keys(e.widgets).forEach(function(t){var n=e.widgets[t];delete n.context,delete n.manifest}),e},e.getContainerInfoByLayoutId=function(t,e){var n;return Object.keys(o.ContainerType).some(function(r){if(Object.keys(t[o.ContainerType[r]]).some(function(i){if(t[o.ContainerType[r]][i].layout===e)return n={containerType:o.ContainerType[r],containerId:i},!0}),n)return!0}),n},e.getWidgetContainerInfo=function(t,e){var n;if(t.widgets&&t.widgets[e])return Object.keys(o.ContainerType).some(function(r){var i=function(t,e,n){var o;if(t[n])return Object.keys(t[n]).some(function(r){var i=t[n][r];if(i.widgets&&i.widgets.indexOf(e)>-1)return o=r}),o||void 0}(t,e,o.ContainerType[r]);if(i)return n={containerType:o.ContainerType[r],containerId:i},!0}),n},e.getSectionContainerInfo=function(t,e){var n;if(t.sections&&t.sections[e])return Object.keys(o.ContainerType).some(function(r){var i=function(t,e,n){var o;if(t[n])return Object.keys(t[n]).some(function(r){var i=t[n][r];if(i.sections&&i.sections.indexOf(e)>-1)return o=r}),o||void 0}(t,e,o.ContainerType[r]);if(i)return n={containerType:o.ContainerType[r],containerId:i},!0}),n},e.getUniqueId=function(t,e){var n=0;return t[e+"s"]?(Object.keys(t[e+"s"]).forEach(function(t){var o=t.substring((e+"_").length,t.length);/^\d+$/.test(o)&&(n=Math.max(n,parseInt(o)))}),e+"_"+(n+1)):e+"_"+(n+1)},e.getUniqueLabel=function(t,e){var n=0;return t[e+"s"]?(Object.keys(t[e+"s"]).forEach(function(o){var r=t[e+"s"][o].label,i=r.substring((e+" ").length,r.length);/^\d+$/.test(i)&&(n=Math.max(n,parseInt(i)))}),e+" "+(n+1)):e+" "+(n+1)},e.getAppConfigDiff=function(t,e){var n={removedWidgets:[]};return t.widgets===e.widgets?n:(Object.keys(t.widgets).forEach(function(t){e.widgets[t]||n.removedWidgets.push(t)}),n)}},,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=function(){};e.ActionContext=o.createContext({updateSetting:r,addLayout:r,removeLayout:r,resizeLayouts:r,dndLayout:r,activate:r,removeWidget:r})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_LAYOUT_SETTING={active:!1,static:!1,restrict:!1,draggable:!0,resizable:!0,droppable:!0,xyInPixel:!0,widthInPixel:!0,heightInPixel:!0,className:""}},,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(263);function r(t,e){switch(t){case"opened":switch(e){case"opened":return null;case"closed":return"onOpen";case"active":return"onDeActive"}case"closed":switch(e){case"opened":return"onClose";case"closed":return null;case"active":return["onDeActive","onClose"]}case"active":switch(e){case"opened":return"onDeActive";case"closed":return["onOpen","onActive"];case"active":return null}}}e.logShallowDiff=function(t,e,n){var r=!1;for(var i in e)e[i]!==n[i]&&(r=!0);if(!r)return console.group(t,"no diff."),void console.groupEnd();for(var i in console.group(t),e)e[i]!==n[i]&&console.log(i,{pre:n[i],cur:e[i],isEqual:o(e[i],n[i])});console.groupEnd()},e.getWidgetCallbackNamesFromWidgetState=function(t,e){return r(t,e)},e.getPanelCallbackNamesFromPanelState=function(t,e){return r(t,e)},e.isMobileBrowser=function(){return!1},e.isMobileSize=function(t){return t.width<600},e.loadstyle=function(t,e){return new Promise(function(n){var o;o=e?document.getElementById(e):document.getElementsByTagName("head")[0];var r=document.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href",t),r.onload=function(){n()},o.appendChild(r)})},e.applyMixins=function(t,e){e.forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(n){t.prototype[n]=e.prototype[n]})})},e.getDataSourceInfosFromQueryObject=function(t){var e={};return t.data&&t.data.split(",").forEach(function(t){var n=t.split(":")[0],o=parseInt(t.split(":")[1]);e[n]=o}),e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.amdRequire=function(t){return new Promise(function(e){window.amdRequire("string"==typeof t?[t]:t,function(t){e(t)})})}},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},i=this&&this.__rest||function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&(n[o[r]]=t[o[r]])}return n};Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),s=n(14),u=n(23),c=n(116),d=n(3);n(150),e.default=function(t){return function(e){var n=function(n){function u(){var t=null!==n&&n.apply(this,arguments)||this;return t.state={deltaSize:{width:0,height:0},deltaPos:{x:0,y:0},isResizing:!1},t}return o(u,n),u.prototype._enableResizing=function(){var t=this.props,e=t.left,n=t.right,o=t.top,r=t.bottom,i=t.disableInteract;return{top:!0!==i&&!1!==o,right:!0!==i&&!1!==n,bottom:!0!==i&&!1!==r,left:!0!==i&&!1!==e,topRight:!0!==i&&!1!==o&&!1!==n,bottomRight:!0!==i&&!1!==r&&!1!==n,bottomLeft:!0!==i&&!1!==r&&!1!==e,topLeft:!0!==i&&!1!==o&&!1!==e}},u.prototype._onResizeStop=function(t,e,n,o,r){t.preventDefault(),t.stopPropagation();var i=this.props,a=i.layout,s=i.onResizeEnd;s&&s(a.id,r.x,r.y,o.width,o.height),this.setState({deltaSize:{width:0,height:0},deltaPos:{x:0,y:0},isResizing:!1})},u.prototype._onResize=function(t,e,n,o,r){t.preventDefault(),t.stopPropagation();var i=this.props,a=i.layout,s=i.onResizing;s&&s(a.id,r.x,r.y,o.width,o.height),this.setState({isResizing:!0,deltaSize:o,deltaPos:r})},u.prototype._onResizeStart=function(t){t.preventDefault(),t.stopPropagation();var e=this.props,n=e.layout,o=e.onResizeStart;o&&o(n.id)},u.prototype.render=function(){var n=this.props,o=n.pos,u=n.className,p=n.minHeight,l=n.minWidth,f=n.maxHeight,g=n.maxWidth,y=n.resizeGrid,h=n.appMode,I=n.disableInteract,m=i(n,["pos","className","minHeight","minWidth","maxHeight","maxWidth","resizeGrid","appMode","disableInteract"]),v=this.state,_=v.deltaSize,b=v.deltaPos,w=v.isResizing,O={x:0,y:0,w:o.w+_.width,h:o.h+_.height},A=this._enableResizing(),M=this._actionHandlers(A),T=d.isActiveLayout(this.props.layout)&&!0!==I,x=s("exb-resizable",u,{active:T});return a.createElement(c.default,{disableDragging:!0,className:x,enableResizing:A,minHeight:p||10,minWidth:l||10,maxHeight:f,maxWidth:g,resizeGrid:y||[1,1],position:{x:w?b.x:o.x,y:w?b.y:o.y},size:{width:O.w,height:O.h},onResizeStart:this._onResizeStart.bind(this),onResize:this._onResize.bind(this),onResizeStop:this._onResizeStop.bind(this)},a.createElement(e,r({pos:O,appMode:h,disableInteract:I},t,m)),T&&M)},u.prototype._getLayoutId=function(){return this.props.layout?this.props.layout.id:""},u.prototype._actionHandlers=function(t){var e=[];return t.top&&e.push(a.createElement("span",{key:"2",className:"handle handle-resize top-resize-cursor handle-resize-side top"})),t.right&&e.push(a.createElement("span",{key:"4",className:"handle handle-resize right-resize-cursor handle-resize-side right"})),t.bottom&&e.push(a.createElement("span",{key:"6",className:"handle handle-resize bottom-resize-cursor handle-resize-side bottom"})),t.left&&e.push(a.createElement("span",{key:"8",className:"handle handle-resize left-resize-cursor handle-resize-side left"})),t.topLeft&&e.push(a.createElement("span",{key:"1",className:"handle handle-resize top-left-resize-cursor handle-resize-corner top left"})),t.topRight&&e.push(a.createElement("span",{key:"3",className:"handle handle-resize top-right-resize-cursor handle-resize-corner top right"})),t.bottomRight&&e.push(a.createElement("span",{key:"5",className:"handle handle-resize bottom-right-resize-cursor handle-resize-corner bottom right"})),t.bottomLeft&&e.push(a.createElement("span",{key:"7",className:"handle handle-resize bottom-left-resize-cursor handle-resize-corner bottom left"})),e},u.displayName="resizable("+function(t){return t.displayName||t.name||"Component"}(e)+")",u}(a.PureComponent);return u(n,e),n}}},,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(260),r=n(45),i=n(10),a=n(11),s=function(){function t(){}return t.prototype._setSession=function(t,e){return void 0===e&&(e="exb_session"),this._session=t,a.store.dispatch(i.sessionStart(t.token)),localStorage.setItem(e,t.serialize()),this._session.getUser().then(function(t){return a.store.dispatch(i.userSignIn(t)),t})},t.prototype._clearSession=function(t){void 0===t&&(t="exb_session"),delete this._session,a.store.dispatch(i.userSignOut()),localStorage.removeItem(t)},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getPortalUrl=function(){return a.store.getState().portalUrl},t.prototype.getSession=function(){return this._session},t.prototype.initFromLocalStorage=function(t){void 0===t&&(t="exb_session");var e=localStorage.getItem(t);e&&this._setSession(o.UserSession.deserialize(e))},t.prototype.initFromCredential=function(t){this._setSession(o.UserSession.fromCredential(t))},t.prototype.signIn=function(){var t=this,e={portal:this.getPortalUrl(),clientId:"QQ6D3PZqPSV6y4SM",redirectUri:window.location.origin+window.amdRequire.toUrl("jimu-core")+"/oauth-callback.html",popup:!0};return o.UserSession.beginOAuth2(e).then(function(e){return t._setSession(e)})},t.prototype.handleAuthError=function(t){var e=t.options;if(t instanceof r.ArcGISAuthError&&!e.authentication)return this._retryPromise||(this._retryPromise=t.retry(this.signIn.bind(this))),this._retryPromise;throw t},t.prototype.signOut=function(){this._clearSession()},t}();e.default=s},,function(t,e,n){"use strict";var o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(117);e.History=i.History;var a=n(10),s=n(11),u=n(109),c=n(262),d=n(103);e.Location=d.Location,e.browserHistory=i.createBrowserHistory();e.browserHistory.listen(function(t,e){var n=s.store.getState().queryObject.asMutable();if(t.search){var o=u.parse(t.search);c(n,o)||s.store.dispatch(a.queryObjectChanged(o))}});var p=r.createContext(e.browserHistory);function l(t,n){void 0===n&&(n=!1);var o=s.store.getState().queryObject.merge(t),r=f(e.browserHistory.location,"?"+u.stringify(o)),i=e.browserHistory.createHref(r);n?e.browserHistory.replace(i):e.browserHistory.push(i)}function f(t,e){var n=d.parsePath(e);return d.isAbsoluteUrl(n.pathname)||"/"===n.pathname.charAt(0)?n:""===n.pathname?(n.pathname=t.pathname,n):"."===n.pathname.charAt(0)?(n.pathname=t.pathname+"/"+n.pathname.substr(2),n):(n.pathname=t.pathname+"/"+n.pathname,n)}e.HistoryProvider=function(t){return r.createElement(p.Provider,{value:e.browserHistory},t.children)},e.withHistory=function(t){return function(e){return r.createElement(p.Consumer,null,function(n){return r.createElement(t,o({},e,{history:n}))})}},e.changeQueryObject=l,e.changePage=function(t){if(s.store.getState().queryObject.page!==t)return l({page:t})},e.changeView=function(t,e){var n=s.store.getState().queryObject.views?s.store.getState().queryObject.views.split(","):[];if(!(n.indexOf(e)>-1))return(n=n.filter(function(e){return s.store.getState().appConfig.sections[t].views.indexOf(e)<0})).push(e),l({views:n.join(",")})},e.createLocation=f},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(8),s=n(21),u=n(31),c=n(11),d=n(10),p=n(108),l=n(19),f=n(32),g=n(12),y=n(106),h=n(105),I=n(44),m=function(){function t(){this.widgetRawClasses={},this.widgetClasses={},this.dependencyResources={}}return t.getInstance=function(){return t.instance||(t.instance=new t,window._widgetManager=t.instance),t.instance},t.prototype.getWidgetClass=function(t){return this.widgetClasses[t]},t.prototype.deleteWidgetClass=function(t){delete this.widgetClasses[t]},t.prototype.loadWidgetClass=function(t){var e,n=this;e="string"==typeof t?c.store.getState().appConfig.widgets[t]:t;return this.loadRawClass(e).then(function(t){return function(t,o){var r=t.default?t.default:t;if(e.manifest.properties.isDojoWidget)return n.appWidgetClassWrapperExtension(r,e,o);var i=n.injectWidgetProps(r,o,e);return n.appWidgetClassWrapperExtension(i,e,o)}(t.clazz,t.nls)}).then(function(t){return n.widgetClasses[e.id]=t,c.store.dispatch(d.widgetClassLoaded(e.id)),t})},t.prototype.loadRawClass=function(t){var e=this,n=t.manifest.name;return this.widgetRawClasses[n]?this.widgetRawClasses[n]:(this.widgetRawClasses[n]=this.loadWidgetDependency(t).then(function(){var e=t.uri+"/dist/runtime/widget";return f.amdRequire(e)}).then(function(n){return t.manifest.properties.hasLocale?e.loadWidgetNls(t).then(function(t){return{clazz:n,nls:t}}):{clazz:n,nls:{}}}),this.widgetRawClasses[n])},t.prototype.appWidgetClassWrapperExtension=function(t,e,n){var o=l.default.getInstance().getExtensions(g.ExtensionPoints.WidgetClassWrapper)[0];if(!o){if(e.manifest.properties.isDojoWidget)throw Error("Please write a WidgetClassWrapperExtension to support Dojo widget.");return t}return o.wrap(t,e,n)},t.prototype.handleNewWidgetJson=function(e){var n=this;return e.context=s.getWidgetContext(e.uri),t.getInstance().loadWidgetManifest(e).then(function(t){return e.manifest=t,s.addWidgetDefaultLabelAndIcon(e),n.loadWidgetConfig(e)}).then(function(t){return e.config=t,e})},t.prototype.loadWidgetManifest=function(t){var e,n=this;return e=t.context.isRemote?t.context.folderUrl+"manifest.json?f=json":t.context.folderUrl+"manifest.json",t.manifest?Promise.resolve(t.manifest):fetch(e).then(function(t){return t.json()}).then(function(e){if(e.error&&e.error.code)return Promise.reject(e.error);var o=e;return s.addWidgetManifestProperties(o),t.label?o:o.properties.hasLocale?n.loadWidgetNls(t).then(function(t){var e;return o.i18nLabels=((e={})[c.store.getState().appContext.locale]=t._widgetLabel,e),o}):o})},t.prototype.loadWidgetConfig=function(t){var e=this;return this.tryLoadWidgetConfig(t).then(function(n){return e.upgradeWidgetConfig(t,n).then(function(e){return t.config=e,e})})},t.prototype.upgradeWidgetConfig=function(t,e){var n,o=t.manifest.version,r=t.version;return o===r?Promise.resolve(e):!1===t.manifest.properties.hasVersionManager?(t.version=o,Promise.resolve(e)):new Promise(function(i,a){window.amdRequire([t.context.amdFolder+"VersionManager"],function(s){var u=new s;if(u.getVersionIndex(r)>u.getVersionIndex(o))a("Bad widget version number, "+t.manifest.name+","+r);else try{n=u.upgrade(e,r,o),t.version=o,i(n)}catch(n){console.log("Read widget ["+t.manifest.name+"] old config error,"+n.stack),i(e)}})})},t.prototype.tryLoadWidgetConfig=function(t){return t.config?"object"==typeof t.config?Promise.resolve(t.config):fetch(t.config).then(function(t){return t.json()}).then(function(e){return t.config=e,e}):t.manifest.properties.hasConfig?fetch(t.context.folderUrl+"config.json").then(function(t){return t.json()}).then(function(e){return t.config=e,e}):(t.config={},Promise.resolve({}))},t.prototype.loadWidgetNls=function(t){return p.default.getInstance().loadNls(t.context.amdFolder+"dist/runtime/nls/strings")},t.prototype.loadWidgetDependency=function(t){var e=this;if(!t.manifest.dependency)return Promise.resolve();var n=l.default.getInstance().getExtensions(g.ExtensionPoints.DependencyDefine),o=[];("string"==typeof t.manifest.dependency?[t.manifest.dependency]:t.manifest.dependency).forEach(function(e){var r=n.filter(function(t){return t.getDependencyKey()===e})[0];r?o=o.concat(r.getResources()):/^http/.test(e)?o.push(e):console.error("Unknown dependency in widget.",t.manifest.name)});var r=o.filter(function(t){return!e.dependencyResources[t]});if(r.forEach(function(t){e.dependencyResources[t]="loading"}),0===r.length)return Promise.resolve();var i=r.filter(function(t){return/\.css$/.test(t)}),a=r.filter(function(t){return/\.js$/.test(t)});return Promise.all([Promise.all(i.map(function(t){return u.loadstyle(t)})).then(function(){i.forEach(function(t){e.dependencyResources[t]="loaded"})}),f.amdRequire(a).then(function(){a.forEach(function(t){e.dependencyResources[t]="loaded"})})]).then(function(){})},t.prototype.injectWidgetProps=function(t,e,n){var s=function(a){function s(t){var e=a.call(this,t)||this;return e.dsManager=h.default.getInstance(),e.state={dataSources:{}},e}return o(s,a),s.prototype.onSignIn=function(){return I.default.getInstance().signIn()},s.prototype.onSignOut=function(){return I.default.getInstance().signOut()},s.prototype.componentDidMount=function(){var t=this,e={};this.props.useDataSources&&this.props.useDataSources.forEach(function(n){var o=t.dsManager.getDataSource(n);o||(o=t.dsManager.createDataSource(n)),e[n]=o}),this.setState({dataSources:e})},s.prototype.render=function(){var n={nls:e,onSignIn:this.onSignIn,onSignOut:this.onSignOut};return n.dataSources=this.state.dataSources,i.createElement(t,r({},this.props,n))},s.displayName="WidgetWrapper("+n.manifest.name+")",s}(y.default);for(var u in t)s[u]||(s[u]=t[u]);return a.connect(function(e){var o=e.widgetsRuntimeInfo[n.id],r={queryObject:e.queryObject,portalUrl:e.portalUrl,dataSourcesInfo:{},user:e.user,token:e.token};n.useDataSources&&n.useDataSources.forEach(function(t){e.dataSourcesInfo&&e.dataSourcesInfo[t]&&(r.dataSourcesInfo[t]={status:e.dataSourcesInfo[t].status,currentIndexes:e.dataSourcesInfo[t].currentIndexes})}),c.store.getState().appContext.isBuilder&&(r.appState=e.appState);var i=Object.assign(r,e.appConfig.widgets[n.id],o);return Object.assign(i,t.mapExtraStateProps?t.mapExtraStateProps(e,i):{})})(s)},t}();e.default=m},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(128),r=n(20),i=function(){function t(){this.id="global-layout-redux-store-extension"}return t.prototype.getActions=function(){return[r.GlobalLayoutActions.ADD_WIDGET,r.GlobalLayoutActions.ADD_SECTION,r.GlobalLayoutActions.REMOVE_LAYOUT,r.GlobalLayoutActions.RESIZE_LAYOUTS,r.GlobalLayoutActions.UPDATE_SETTING,r.GlobalLayoutActions.REMOVE_WIDGET,r.GlobalLayoutActions.ADD_LAYOUT,r.GlobalLayoutActions.DRAG_DROP_LAYOUT,r.GlobalLayoutActions.ACTIVATE,r.GlobalLayoutActions.REMOVE_SECTION,r.GlobalLayoutActions.UPDATE_LAYOUT,r.GlobalLayoutActions.CHANGE_ORDER]},t.prototype.getInitLocalState=function(){return{default:{0:{id:"0",pos:{x:0,y:0,w:100,h:100},type:0}}}},t.prototype.getReducer=function(){return o.globalLayoutReducer},t.prototype.getStoreKey=function(){return"appConfig.layouts"},t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(10),r=n(11),i=n(46),a=n(47),s=n(20),u=n(21),c=window.top._builderPubsub;function d(t,e){c&&c.publish(t,e)}e.listenBuilderEvents=function(){c&&(c.subscribe("to_app",function(t,e){console.log(t,e)}),c.subscribe("to_app.app_config_changed",function(t,e){var n=u.getAppConfigDiff(r.store.getState().appConfig,e);n.removedWidgets.forEach(function(t){a.default.getInstance().deleteWidgetClass(t)}),r.store.dispatch(o.appConfigChanged(e,n))}),c.subscribe("to_app.app_mode_changed",function(t,e){r.store.dispatch(o.appModeChanged(e))}),c.subscribe("to_app.high_light",function(t,e){r.store.dispatch(o.toggleWidgetHighlight(e,!0))}),c.subscribe("to_app.remove_high_light",function(t,e){r.store.dispatch(o.toggleWidgetHighlight(e,!1))}),c.subscribe("to_app.set_app_in_builder",function(t){r.store.dispatch(o.setAppInBuilder())}),c.subscribe("to_app.change_page",function(t,e){i.changePage(e)}),c.subscribe("to_app.change_view",function(t,e){var n=e.sectionId,o=e.viewId;i.changeView(n,o)}),c.subscribe("to_app.change_current_setting_widget",function(t,e){r.store.dispatch(o.setWidgetIsSettingState(e,!0))}),c.subscribe("to_app.toggle_widget_highlight",function(t,e){var n=e.widgetId,i=e.isHighlight;r.store.dispatch(o.toggleWidgetHighlight(n,i))}),c.subscribe("to_app.add_widget",function(t,e){r.store.dispatch(s.addWidget(e.widgetId,e.layoutInfo))}),c.subscribe("to_app.add_section",function(t,e){r.store.dispatch(s.addSection(e.sectionId,e.layoutInfo))}),c.subscribe("to_app.remove_widget",function(t,e){r.store.dispatch(s.removeWidget(e.widgetId))}),c.subscribe("to_app.remove_section",function(t,e){r.store.dispatch(s.removeSection(e.sectionId))}),c.subscribe("to_app.update_layout_item",function(t,e){r.store.dispatch(s.updateLayout(e.layoutInfo,e.layoutContent.pos,e.layoutContent.setting))}))},e.publishAppStateChangeToBuilder=function(){d("to_builder.app_state_changed",r.store.getState())},e.publishCurrentEditWidgetChangeToBuilder=function(t){r.store.dispatch(o.setWidgetIsSettingState(t,!0)),d("to_builder.current_widget_changed",t)},e.publishRemoveWidgetToBuilder=function(t){d("to_builder.widget_removed",t)},e.letBuilderPopupChooseWidget=function(t,e){d("to_builder.popup_choose_widget",{layoutId:t,layoutItemId:e})},e.publishWidgetConfigChangeToBuilder=function(t,e){d("to_builder.widget_config_changed",{widgetId:t,widgetConfig:e})}},function(t,e,n){"use strict";var o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(1),a=n(5),s=n(25),u={},c={};e.registerLayout=function(t,e){u[t]=e},e.registerLayoutViewer=function(t,e){c[t]=e},e.isRegistered=function(t){return void 0!==u[t]},e.isViewerRegistered=function(t){return void 0!==c[t]};var d=function(){function t(){}return t.createLayout=function(t,e,n){i(u[t],t+" not registered");var a=u[t];return r.createElement(s.ActionContext.Consumer,null,function(t){return r.createElement(a,o({layout:e},n,{actionContext:t}))})},t.createLayoutViewer=function(t,e){var n=t.type;i(c[n],n+" not registered");var u=c[n];return n===a.LayoutType.SIDEBAR_LAYOUT?r.createElement(s.ActionContext.Consumer,null,function(n){return r.createElement(u,o({layout:t},e,{actionContext:n}))}):r.createElement(u,o({layout:t},e))},t}();e.LayoutFactory=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.LAYOUT="layout"}(e.DND_TYPES||(e.DND_TYPES={}))},,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(8),a=n(1),s=n(3),u=n(9),c=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype._getCurrentLayoutId=function(){var t=this.props,e=t.appConfig,n=t.queryObject,o=t.layout,r=t.isMobile,i=t.width,s=t.height,u=e.sections[o.sectionId];if(a(u,"no section in appConfig with id "+o.sectionId),u.views&&u.views.length>0){var c=u.views[0];if(n.views)n.views.split(",").forEach(function(t){u.views.indexOf(t)>-1&&(c=t)});var d=e.views[c];return a(d,"no view in appConfig with id "+c),r?d.mobileTheresholdSize&&(d.mobileTheresholdSize.width>i||d.mobileTheresholdSize.height>s)?d.mobileLayoutCompact||d.mobileLayout||d.layout:d.mobileLayout||d.layout:d.desktopThresholdSize&&(d.desktopThresholdSize.width>i||d.desktopThresholdSize.height>s)&&d.desktopLayoutCompact||d.layout}return null},e.prototype.render=function(){var t=this.props,e=t.appConfig,n=t.layout,o=t.width,i=t.height,a=t.appMode,c=this._getCurrentLayoutId(),d=s.getSectionLayout(c,e);if(!d)return null;var p={x:0,y:0,w:o-2,h:i-2};return r.createElement("div",{className:"section-layout","data-sectionid":n.sectionId,"data-layoutitemid":n.id,"data-layoutid":n.layoutId},r.createElement(u.LayoutItem,{layout:d,appMode:a,pos:p,style:{position:"relative"}}))},e.defaultProps={actionContext:{updateSetting:s.emptyFunc,addLayout:s.emptyFunc,removeLayout:s.emptyFunc,resizeLayouts:s.emptyFunc,dndLayout:s.emptyFunc,activate:s.emptyFunc,removeWidget:s.emptyFunc}},e}(r.Component);e.SectionLayout=c;e.default=i.connect(function(t){return{appConfig:t.appConfig,queryObject:t.queryObject,appMode:t.appMode,isMobile:t.appContext.isMobile}})(c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),r=n(26);e.DEFAULT_SIDEBAR_SETTING=o({},r.DEFAULT_LAYOUT_SETTING,{draggable:!1,overlay:!1,togglable:!0,toggleOn:!0})},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(6),a=n(8),s=n(33),u=n(5),c=n(3),d=n(134),p=n(9);n(131);var l=n(129),f=function(t){function e(e){var n=t.call(this,e)||this;n.state={layout:null,layoutMap:null,resizingSide:null,delta:null},c.autoBindHandlers(n,["_onResizeStart","_onResizeEnd","_onResizing","_onItemToggleChange"]),n.interactComponent=s.default({onToggleChange:n._onItemToggleChange})(d.Sidebar);var o=n.props,r=o.layout,i=o.queryObject,a=l.collectSidebars(r.content||[],i&&i.layouts);return n.state={layout:r,layoutMap:a,resizingSide:null,delta:null},n}return o(e,t),e.getDerivedStateFromProps=function(t,e){if(t.layout!==e.layout){var n=t.layout,o=l.collectSidebars(n.content||[]);return{layout:t.layout,layoutMap:o}}return null},e.prototype._onResizeStart=function(t){var e;this.props.layout.content.some(function(n){if(n.id===t)return e=n,!0}),this.setState({resizingSide:e.setting.attach})},e.prototype._onResizing=function(t,e,n,o,r){this.setState({delta:{w:o,h:r}})},e.prototype._onResizeEnd=function(t,e,n,o,r){var i=this.state,a=i.layoutMap,s=i.resizingSide,c=i.delta,d=this.props,p=d.width,f=d.height,g=d.actionContext,y=d.layout,h=l.calculatePosition(a,p,f,s,c);if(s&&c)switch(s){case u.AttachType.LEFT:h.left.w+=c.w;break;case u.AttachType.RIGHT:h.right.x-=c.w,h.right.w+=c.w;break;case u.AttachType.TOP:h.header.h+=c.h;break;case u.AttachType.BOTTOM:h.footer.y-=c.h,h.footer.h+=c.h}var I=[];Object.keys(h).forEach(function(t){"main"!==t&&I.push({id:a[t].id,layoutId:y.layoutId,pos:h[t]})}),this.setState({resizingSide:null,delta:null}),g.resizeLayouts(I)},e.prototype._onItemToggleChange=function(t,e){var n=this.props,o=n.layout,r=n.actionContext,a=c.getLayoutItem(o.content,t);if(a){var s=i(a.setting||{}).set("toggleOn",e);r.updateSetting({layoutId:o.layoutId,layoutItemId:t},s)}},e.prototype._createSidebar=function(t,e){var n=this.state.layoutMap,o=n[t].setting,i=o.attach,a=o.min,s=o.max,c=o.resizable,d=o.togglable,p=o.toggleOn,l=i===u.AttachType.LEFT||i===u.AttachType.RIGHT,f=this.interactComponent;return r.createElement(f,{pos:e,layout:n[t],appMode:this.props.appMode,disableInteract:!c||d&&!p,onResizeStart:this._onResizeStart,onResizing:this._onResizing,onResizeEnd:this._onResizeEnd,minWidth:l?a:null,maxWidth:l?s:null,minHeight:l?null:a,maxHeight:l?null:s,left:i===u.AttachType.RIGHT,right:i===u.AttachType.LEFT,top:i===u.AttachType.BOTTOM,bottom:i===u.AttachType.TOP,className:t})},e.prototype.render=function(){var t=this.state,e=t.layoutMap,n=t.resizingSide,o=t.delta,i=this.props,a=i.width,s=i.height,u=i.layout,c=i.appMode,d=l.calculatePosition(e,a,s,n,o);return r.createElement("div",{className:"sidebar-layout","data-layoutid":u.layoutId,"data-layoutitemid":u.id},d.main&&r.createElement(p.LayoutItem,{layout:e.main,pos:d.main,appMode:c}),d.header&&this._createSidebar("header",d.header),d.left&&this._createSidebar("left",d.left),d.right&&this._createSidebar("right",d.right),d.footer&&this._createSidebar("footer",d.footer))},e.defaultProps={layout:null,width:0,height:0,actionContext:{updateSetting:c.emptyFunc,addLayout:c.emptyFunc,removeLayout:c.emptyFunc,resizeLayouts:c.emptyFunc,dndLayout:c.emptyFunc,activate:c.emptyFunc,removeWidget:c.emptyFunc}},e}(r.Component);e.SidebarLayout=a.connect(function(t){return{queryObject:t.queryObject}})(f)},function(t,e,n){var o=n(135);"string"==typeof o&&(o=[[t.i,o,""]]);var r={transform:void 0};n(15)(o,r);o.locals&&(t.exports=o.locals)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),r=n(26);e.DEFAULT_FIX_LAYOUT_SETTING=o({},r.DEFAULT_LAYOUT_SETTING,{static:!1,order:0,gridSize:16,restrict:!1,alignCenter:!1,hPriority:"left",vPriority:"top"})},function(t,e,n){var o=n(138);"string"==typeof o&&(o=[[t.i,o,""]]);var r={transform:void 0};n(15)(o,r);o.locals&&(t.exports=o.locals)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(6),i=n(5),a=n(3);function s(t){var e,n=0;return t.forEach(function(t){(e=t.pos.y+t.pos.h)>n&&(n=e)}),n}function u(t,e){if(t===e)return!1;var n=t.pos,o=e.pos;return!(n.x+n.w<=o.x)&&(!(n.x>=o.x+o.w)&&(!(n.y+n.h<=o.y)&&!(n.y>=o.y+o.h)))}function c(t,e,n){for(var i=h(t),s=v(t,e),u=Array(t.length),c=function(c,d){var p=-1;t.some(function(t,e){if(t.id===s[c].id)return p=e,!0}),o(p>=0,"sorted item is not in the original array");var f=void 0;f=r.isImmutable(s[c])?s[c]:r(s[c]),a.isStaticLayout(f)||(f=l(i,f,e,n,s),i.push(f)),f=f.set("moved",!1),u[p]=f},d=0,p=s.length;d<p;d++)c(d);return u}e.bottom=s,e.collides=u,e.compact=c;var d={x:"w",y:"h"};function p(t,e,n,o){var i=d[o];e=e.setIn(["pos",o],e.pos[o]+1);var s=0;t.some(function(t,n){if(t.id===e.id)return s=n,!0});for(var c=s+1;c<t.length;c++){var l=r(t[c]);if(!a.isStaticLayout(l)){if(l.pos.y>e.pos.y+e.pos.h)break;u(e,l)&&(t[c]=p(t,l,n+e.pos[i],o))}}return e.setIn(["pos",o],n)}function l(t,e,n,o,r){if(n===i.CompactType.VERTICAL)for(e=e.setIn(["pos","y"],Math.min(s(t),e.pos.y));e.pos.y>0&&!g(t,e);)e=e.setIn(["pos","y"],e.pos.y-1);else if(n===i.CompactType.HORIZONTAL)for(e=e.setIn(["pos","y"],Math.min(s(t),e.pos.y));e.pos.x>0&&!g(t,e);)e=e.setIn(["pos","x"],e.pos.x-1);for(var a=g(t,e);a;)e=n===i.CompactType.HORIZONTAL?p(r,e,a.pos.x+a.pos.w,"x"):p(r,e,a.pos.y+a.pos.h,"y"),n===i.CompactType.HORIZONTAL&&e.pos.x+e.pos.w>o&&(e=(e=e.setIn(["pos","x"],o-e.pos.w)).setIn(["pos","y"],e.pos.y+1)),a=g(t,e);return e}function f(t,e){for(var n=Array(t.length),o=h(t),i=0,s=t.length;i<s;i++){var u=r(t[i]);if(u.pos.x+u.pos.w>e&&(u=u.setIn(["pos","x"],e-u.pos.w)),u.pos.x<0&&(u=(u=u.setIn(["pos","x"],0)).setIn(["pos","w"],e)),a.isStaticLayout(u))for(;g(o,u);)u=u.setIn(["pos","y"],u.pos.y+1);else o.push(u);n[i]=u}return n}function g(t,e){for(var n=0,o=t.length;n<o;n++)if(u(t[n],e))return t[n]}function y(t,e){return t.filter(function(t){return u(t,e)})}function h(t){var e=t.filter(function(t){return a.isStaticLayout(t)});return r.isImmutable(e)?e.asMutable():e}function I(t,e,n,s,u,c,d,p){var l;l=r.isImmutable(t[0])?t:t.map(function(t){return r(t)});var f=a.getLayoutItem(l,e),g=l.indexOf(f);if(o(g>=0,"layoutId should in the layouts array"),a.isStaticLayout(f))return l;if(f.pos.y===c&&f.pos.x===u)return l;var h=f.pos.x,I=f.pos.y;"number"==typeof u&&(f=f.setIn(["pos","x"],u)),"number"==typeof c&&(f=f.setIn(["pos","y"],c)),f=f.set("moved",!0),l[g]=f;var _=v(l,n);(n===i.CompactType.VERTICAL&&"number"==typeof c?I>=c:n===i.CompactType.HORIZONTAL&&"number"==typeof u&&h>=u)&&(_=_.reverse());var b=y(_,f);if(p&&b.length)return f=(f=(f=f.setIn(["pos","x"],h)).setIn(["pos","y"],I)).set("moved",!1),l[g]=f,l;for(var w=0,O=b.length;w<O;w++){var A=b[w];A.moved||(l=a.isStaticLayout(A)?m(l,A,f,n,s,d):m(l,f,A,n,s,d))}return l}function m(t,e,n,o,r,a){var s=o===i.CompactType.HORIZONTAL,u=o===i.CompactType.VERTICAL;if(a){a=!1;var c={pos:{x:s?Math.max(e.pos.x-n.pos.w,0):n.pos.x,y:u?Math.max(e.pos.y-n.pos.h,0):n.pos.y,w:n.pos.w,h:n.pos.h},id:"-1"};if(!g(t,c))return I(t,n.id,o,r,s?c.pos.x:void 0,u?c.pos.y:void 0,a,!1)}return I(t,n.id,o,r,s?n.pos.x+1:void 0,u?n.pos.y+1:void 0,a,!1)}function v(t,e){return e===i.CompactType.HORIZONTAL?b(t):e===i.CompactType.VERTICAL?_(t):t}function _(t){return[].concat(t).sort(function(t,e){return t.pos.y>e.pos.y||t.pos.y===e.pos.y&&t.pos.x>e.pos.x?1:t.pos.y===e.pos.y&&t.pos.x===e.pos.x?0:-1})}function b(t){return[].concat(t).sort(function(t,e){return t.pos.x>e.pos.x||t.pos.x===e.pos.x&&t.pos.y>e.pos.y?1:t.pos.y===e.pos.y&&t.pos.x===e.pos.x?0:-1})}function w(t){return Object.keys(t).sort(function(e,n){return t[e]-t[n]})}e.compactItem=l,e.correctBounds=f,e.getFirstCollision=g,e.getAllCollisions=y,e.getStatics=h,e.moveElement=I,e.moveElementAwayFromCollision=m,e.sortLayoutItems=v,e.sortLayoutItemsByRowCol=_,e.sortLayoutItemsByColRow=b,e.synchronizeLayoutWithChildren=function(t,e,n){return c(f(t=t||[],e),n,e)},e.sortBreakpoints=w,e.getBreakpointFromWidth=function(t,e){for(var n=w(t),o=n[0],r=1,i=n.length;r<i;r++){var a=n[r];e>t[a]&&(o=a)}return o},e.getColsFromBreakpoint=function(t,e){return o(e[t],"ResponsiveReactGridLayout: `cols` entry for breakpoint "+t+" is missing!"),e[t]},e.generateResponsiveLayout=function(t,e,n){return c(f(t=t||[],e),n,e)},e.collectLayoutsAtBreakpoint=function(t,e,n){if(!t)return[];var o=w(n.breakpoints),i=o.indexOf(e),a=o.slice(i);return t.map(function(t){var n;n=r.isImmutable(t)?t:r(t);var s=t.pos[e];if(!s&&(a.some(function(e){if(t.pos[e])return s=t.pos[e],!0}),!s&&0!==i))for(var u=i-1;u>=0;u--)if(t.pos[o[u]]){s=t.pos[o[u]];break}return n.set("pos",s||{x:t.pos.x,y:t.pos.y,w:t.pos.w,h:t.pos.h})})},e.toGridPosition=function(t,e,n,o){var r=e.space,i=e.rowHeight,a=Math.round((t.x-r)/(o+r)),s=Math.round((t.y-r)/(i+r)),u=Math.round((t.w+r)/(o+r)),c=Math.round((t.h+r)/(i+r));return{x:a=Math.max(Math.min(a,n-u),0),y:s=Math.max(s,0),w:u=Math.max(Math.min(u,n-a),1),h:c=Math.max(c,1)}},e.toPixelPosition=function(t,e,n,o,r){var i=e.space,a=e.padding,s=e.rowHeight,u={x:Math.round((n+i)*t.x+a[0]),y:Math.round((s+i)*t.y+a[1]),w:t.w===1/0?t.w:Math.round(n*t.w+Math.max(0,t.w-1)*i),h:t.h===1/0?t.h:Math.round(s*t.h+Math.max(0,t.h-1)*i)};return o&&(u.w=Math.round(o.w),u.h=Math.round(o.h)),r&&(u.y=Math.round(r.y),u.x=Math.round(r.x)),u}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),r=n(7),i=n(26);e.DEFAULT_GRID_LAYOUT_SETTING=r({},i.DEFAULT_LAYOUT_SETTING,{padding:[10,10],rowHeight:32,breakpoints:{lg:1200,md:992,sm:768,xs:576,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},space:10,compactType:o.CompactType.VERTICAL,restrict:!0})},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},i=this&&this.__rest||function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&(n[o[r]]=t[o[r]])}return n};Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),s=n(14),u=n(43),c=n(52),d=n(3);e.default=function(t){return function(e){var n=function(n){function u(){return null!==n&&n.apply(this,arguments)||this}return o(u,n),u.prototype.render=function(){var n=this.props,o=n.pos,u=n.isDragging,c=n.className,p=(n.style,n.connectDragSource),l=n.appMode,f=i(n,["pos","isDragging","className","style","connectDragSource","appMode"]),g={x:0,y:0,w:o.w,h:o.h},y={position:"absolute",left:0,top:0,width:o.w,height:o.h,backgroundColor:"#F1F1F1",outline:"1px solid #55BCFF",boxShadow:"inset 0 0 8px 0 rgba(0,0,0,0.15)"},h=s("exb-draggable",c);return p&&p(a.createElement("div",{className:h,style:d.setTransform(o)},a.createElement(e,r({pos:g,appMode:l,style:{position:"relative"}},t,f)),u&&a.createElement("div",{style:y})))},u.displayName="react-dnd-draggable("+function(t){return t.displayName||t.name||"Component"}(e)+")",u}(a.PureComponent);return u.DragSource(c.DND_TYPES.LAYOUT,{beginDrag:function(t){return"function"==typeof t.onMoveStart&&t.onMoveStart(t.layout.id),{layout:t.layout,width:t.pos.w,height:t.pos.h}},endDrag:function(t,e){if("function"==typeof t.onMoveEnd){var n=t.layout,o=e.getDifferenceFromInitialOffset();t.onMoveEnd(n.id,o.x,o.y)}},canDrag:function(t){return!(t.disableInteract||t.layout&&t.layout.setting&&!1===t.layout.setting.draggable)}},function(t,e){return{connectDragSource:t.dragSource(),isDragging:e.isDragging()}})(n)}}},,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(11),r=n(21),i=n(32),a=function(){function t(){this.messageActions=[],this.messageActionClasses={}}return t.getInstance=function(){return t.instance||(t.instance=new t,window._messageManager=t.instance),t.instance},t.prototype.createMessageActions=function(t){var e=this,n=[];return r.getAllWidgets(t).forEach(function(t){t.manifest.messageActions&&t.manifest.messageActions.forEach(function(o){n.push(e.createMessageAction(t,o))})}),Promise.all(n)},t.prototype.createMessageAction=function(t,e){var n=this,o=this.messageActions.filter(function(n){return n.widgetId===t.id&&n.name===e.name})[0];return o?Promise.resolve(o):this.loadMessageActionClass(t,e).then(function(r){return o=new r(t.id,e.name),n.messageActions.push(o),Promise.resolve(o)})},t.prototype.loadMessageActionClass=function(t,e){var n=this;if(this.messageActionClasses[e.name])return Promise.resolve(this.messageActionClasses[e.name]);var o=t.context.amdFolder+"dist/"+e.uri;return i.amdRequire(o).then(function(t){return n.messageActionClasses[e.name]=t.default,t.default})},t.prototype.publishMessage=function(t){var e=this,n=o.store.getState().appConfig.messages,r=n&&n.filter(function(e){return e.messageType===t.type&&e.widgetId===t.widgetId})[0];r&&r.actions.forEach(function(n){var o=e.messageActions.filter(function(t){return t.widgetId===n.widgetId&&t.name===n.actionName})[0];o?o.filterMessage(t)&&o.onExecute(t,n.config):console.error("Not find action: "+o.name)})},t}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parsePath=function(t){var e=t||"/",n="",o="",r=e.indexOf("#");-1!==r&&(o=e.substr(r),e=e.substr(0,r));var i=e.indexOf("?");return-1!==i&&(n=e.substr(i),e=e.substr(0,i)),{pathname:e,search:"?"===n?"":n,hash:"#"===o?"":o}},e.isAbsoluteUrl=function(t){return/(^http:)|(^https:)|(^\/\/)/.test(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Unloaded="UNLOADED",t.UnloadedLoading="UNLOADED_LOADING",t.LoadedLoading="LOADED_LOADING",t.Loaded="LOADED",t.Closed="CLOSED",t.Connecting="CONNECTING",t.Connected="CONNECTED",t.Closing="CLOSING"}(e.DataSourceStatus||(e.DataSourceStatus={}));var o=function(){function t(){this.isDataSourceSet=!1,this.records=[],this.currentIndexes=[]}return t.prototype.updateStatus=function(t){this.status=t,this.dataSourceManager&&this.dataSourceManager.onDataSourceStatusChanged(this.id,t)},t.prototype.getRecords=function(){return this.records},t.prototype.getCurrentRecord=function(){return this.records[this.currentIndexes[0]]},t.prototype.getCurrentRecords=function(){var t=this;return this.currentIndexes.map(function(e){return t.records[e]})},t.prototype.getCurrentRecordIndexes=function(){return this.currentIndexes},t.prototype.nextRecord=function(){if(this.currentIndexes.length>1)return console.warn('method "nextRecord" only works when single record is selected'),null;if(this.currentIndexes.indexOf(this.records.length-1))throw Error("Reach the end of data.");return this.currentIndexes[0]++,this.getCurrentRecord()},t.prototype.prevRecord=function(){if(this.currentIndexes.length>1)return console.warn('method "prevRecord" only works when single record is selected'),null;if(this.currentIndexes.indexOf(0))throw Error("Reach the start of data.");return this.currentIndexes[0]--,this.getCurrentRecord()},t.prototype.findRecord=function(t){return this.records[t]},t.prototype.clearData=function(){this.records=[],this.currentIndexes=[]},t.prototype.destroy=function(){},t}();e.AbstractDataSource=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i,a=n(11),s=n(104),u=n(19),c=n(12),d=n(10),p=n(46),l=n(261),f=n(44);!function(t){t.HubAnnotations="HUB_ANNOTATIONS"}(i=e.DataSourceTypes||(e.DataSourceTypes={}));var g=[i.HubAnnotations],y=function(){function t(t,e){this.feature=t,this.user=e}return t.prototype.getData=function(){return this.user?r({user:this.user},this.feature.attributes):this.feature.attributes},t}();e.HubAnnotationDataRecord=y;var h=function(t){function e(e){var n=t.call(this)||this;return n.url=e.url,n.type=i.HubAnnotations,n.id=e.id,n}return o(e,t),e.prototype.init=function(){this.updateStatus(s.DataSourceStatus.Unloaded)},e.prototype.query=function(t){var e=this,n=f.default.getInstance(),o=r({authentication:n.getSession(),url:this.url},t);return this.status&&this.status!==s.DataSourceStatus.Unloaded?this.updateStatus(s.DataSourceStatus.LoadedLoading):this.updateStatus(s.DataSourceStatus.UnloadedLoading),l.queryFeatures(o).then(function(t){var n=t.features.map(function(t){return new y(t,void 0)});return e.records=n,e.updateStatus(s.DataSourceStatus.Loaded),n}).catch(n.handleAuthError.bind(n))},e.prototype.selectRecord=function(t){this.currentIndexes=[t],this.dataSourceManager.onDataSourceCurrentIndexesChanged(this.id,[t])},e.prototype.addRecord=function(t){var e=f.default.getInstance(),n=t.getData(),o={attributes:n},r={url:this.url,adds:[o],authentication:e.getSession()};return l.addFeatures(r).then(function(t){var e=t.addResults[0].objectId;return n.OBJECTID=e,new y({attributes:n})}).catch(e.handleAuthError.bind(e))},e.prototype.addAnnotation=function(t,e,n){var o=f.default.getInstance().getSession().username,r=window&&window.location.toString(),i=new y({attributes:{author:o,source:r,target:e,feature_id:n,description:t,created_at:(new Date).getTime(),status:"pending"}});return this.addRecord(i)},e.prototype.getDataSchema=function(){},e}(s.AbstractDataSource);e.HubAnnotationsDataSource=h;var I=function(){function t(){this.dataSources={}}return t.getInstance=function(){return t.instance||(t.instance=new t,window._dataSourceManager=t.instance),t.instance},t.prototype.getDataSource=function(t){return this.dataSources[t]},t.prototype.destroyDataSource=function(t){this.dataSources[t]&&(this.dataSources[t].destroy(),delete this.dataSources[t])},t.prototype.createAllDataSources=function(){var t=this;return Object.keys(a.store.getState().appConfig.dataSources).forEach(function(e){t.dataSources[e]||t.createDataSource(e)}),Object.keys(this.dataSources).map(function(e){return t.dataSources[e]})},t.prototype.createDataSource=function(t){var e,n;if(!(e="string"==typeof t?a.store.getState().appConfig.dataSources[t]:t))throw Error("Unknown data source id:"+e.id);if(g.indexOf(e.type)>-1)e.type===i.HubAnnotations&&(n=this.createHubAnnotationsDataSource(e));else{var o=u.default.getInstance().getExtensions(c.ExtensionPoints.DataSourceFactory).filter(function(t){return t.getSupportDataSourceTypes().indexOf(e.type)>-1})[0];if(!o)throw Error("Unknown data source type:"+e.type);n=o.createDataSource(e)}return n&&(n.dataSourceManager=this,n.init(),this.dataSources[e.id]=n),n},t.prototype.onDataSourceStatusChanged=function(t,e){a.store.dispatch(d.dataSourceStatusChanged(t,e))},t.prototype.onDataSourceCurrentIndexesChanged=function(t,e){if(!a.store.getState().dataSourcesInfo[t]||!a.store.getState().dataSourcesInfo[t].currentIndexes||a.store.getState().dataSourcesInfo[t].currentIndexes[0]!==e[0]){var n=a.store.getState().queryObject.data,o=[];n&&(o=n.split(","));var r=[],i=!1;o.forEach(function(n){var o=n.split(":")[0];n.split(":")[1];o===t?(r.push(t+":"+e[0]),i=!0):r.push(n)}),i||r.push(t+":"+e[0]),p.changeQueryObject({data:r.join(",")},!0),a.store.dispatch(d.dataSourceCurrentIndexesChanged(t,e))}},t.prototype.createHubAnnotationsDataSource=function(t){return new h(t)},t}();e.default=I},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(31),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showDiffLog=!1,e}return o(e,t),e.prototype.onOpen=function(){console.log("base widget onOpen")},e.prototype.onClose=function(){},e.prototype.onActive=function(){},e.prototype.onDeActive=function(){},e.prototype.componentDidUpdate=function(t,e){var n=this,o=this.props.state,r=t.state;this.showDiffLog&&(i.logShallowDiff("Widget "+this.props.manifest.name+" Props diff:",this.props,t),i.logShallowDiff("Widget "+this.props.manifest.name+" State diff:",this.state,e));var a=i.getWidgetCallbackNamesFromWidgetState(o,r);a&&("string"==typeof a?this[a]():Array.isArray(a)?a.forEach(function(t){return n[t]()}):console.error("Bad widget callback name."))},e}(r.PureComponent);e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Page="pages",t.View="views",t.SharedArea="sharedArea"}(e.ContainerType||(e.ContainerType={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(32),r=function(){function t(){}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.loadNls=function(t){return o.amdRequire(""+t).then(function(e){var n=window.jimuConfig.locale;if("en"===n)return e.root;if(!e[n])return e.root;var r=t.split("/"),i=r.slice(0,r.length-2).join("/"),a=r[r.length-1];return o.amdRequire(i+"/"+n+"/"+a).then(function(t){return Object.assign(e.root,t)})})},t}();e.default=r},,,,,,,,,,function(t,e,n){"use strict";var o,r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.FeatureSelectionChange="FEATURE_SELECTION_CHANGE",t.StringSelectionChange="STRING_SELECTION_CHANGE"}(o=e.MessageType||(e.MessageType={}));var i=function(){return function(t,e){this.type=o.StringSelectionChange,this.widgetId=t,this.str=e}}();e.StringSelectionChangeMessage=i;var a=function(){return function(t,e){this.type=o.FeatureSelectionChange,this.widgetId=t,this.feature=e}}();e.FeatureSelectionChangeMessage=a;var s=function(){function t(t,e){this.name=e,this.widgetId=t}return Object.defineProperty(t.prototype,"id",{get:function(){return this.widgetId+"-"+this.name},enumerable:!0,configurable:!0}),t}();e.MessageAction=s;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.filterMessageType=function(t){return!0},e.prototype.filterMessage=function(t){return!0},e.prototype.onExecute=function(t,e){return!0},e}(s);e.DummyMessageAction=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(7),a=n(74),s=n(9),u=n(3);n(73);var c=function(t){function e(e){var n=t.call(this,e)||this;return n.setting=i({},a.DEFAULT_FIX_LAYOUT_SETTING,n.props.layout.setting),n}return o(e,t),e.prototype._processLayoutItem=function(t,e){var n=this.props,o=n.width,c=n.height,d=n.appMode,p=i({},a.DEFAULT_FIX_LAYOUT_SETTING,t.setting),l=u.calPixelPosition(t.pos,o,c,p);return r.createElement(s.LayoutItem,{key:e,layout:t,pos:l,appMode:d})},e.prototype.render=function(){var t=this,e=this.props.layout.content||[];return r.createElement("div",{className:"fixed-layout"},e.map(function(e,n){return t._processLayoutItem(e,n)}))},e}(r.Component);e.FixedLayoutViewer=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(14),s=n(7),u=n(77),c=n(76),d=n(3),p=n(9);n(75);var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={width:0,numOfCols:-1,activeDrag:null,pixelLayouts:[],gridLayouts:[],breakpoint:"",setting:u.DEFAULT_GRID_LAYOUT_SETTING},e}return o(e,t),e.getDerivedStateFromProps=function(t,e){var n=s({},u.DEFAULT_GRID_LAYOUT_SETTING,t.layout.setting),o=n.space,r=n.padding,i=c.getBreakpointFromWidth(n.breakpoints,t.width),a=c.getColsFromBreakpoint(i,n.cols),d=(t.width-o*(a-1)-2*r[0])/a,p=c.collectLayoutsAtBreakpoint(t.layout.content,i,n),l=c.generateResponsiveLayout(p,a,n.compactType);return{breakpoint:i,pixelLayouts:l.map(function(t){return{id:t.id,pos:c.toPixelPosition(t.pos,n,d)}}),gridLayouts:l,width:t.width,numOfCols:a,setting:n}},e.prototype.containerHeight=function(){if(this.props.autoSize){var t=this.state.setting,e=t.padding,n=t.space,o=t.rowHeight,r=c.bottom(this.props.layout.content||[]);return r*o+(r-1)*n+2*(e?e[1]:n)+"px"}},e.prototype.processGridItem=function(t,e){this.props.layout.content;var n=d.getLayoutItem(this.state.gridLayouts,t.id);return n?i.createElement(p.LayoutItem,{key:e,layout:n,pos:t.pos}):null},e.prototype.render=function(){var t=this,e=this.props,n=e.className,o=e.style,s=this.state,u=s.pixelLayouts,c=(s.numOfCols,a("react-grid-layout",n)),d=r({height:this.containerHeight()},o);return i.createElement("div",{className:c,style:d},u.map(function(e,n){return t.processGridItem(e,n)}))},e.displayName="GridLayout",e.defaultProps={autoSize:!0,className:"",style:{},layout:null},e}(i.Component);e.GridLayoutViewer=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(7),s=n(26),u=n(8),c=n(5),d=n(125),p=n(124),l=n(72),f=n(70),g=n(51),y=n(9),h=n(49),I=n(19),m=n(12),v=n(25),_=n(3),b=n(20);g.registerLayoutViewer(c.LayoutType.FIXED_LAYOUT,p.FixedLayoutViewer),g.registerLayoutViewer(c.LayoutType.GRID_LAYOUT,d.GridLayoutViewer),g.registerLayoutViewer(c.LayoutType.SIDEBAR_LAYOUT,l.SidebarLayout),g.registerLayoutViewer(c.LayoutType.SECTION_LAYOUT,f.default);var w=function(t){function e(e){var n=t.call(this,e)||this;return n.state={layout:null},I.default.getInstance().registerExtension({epName:m.ExtensionPoints.ReduxStore,extension:new h.default}),n}return o(e,t),e.getDerivedStateFromProps=function(t,e){return t.layout!==e.layout?{layout:t.layout}:null},e.prototype.render=function(){var t=this,e={updateSetting:function(e,n){t.props.dispatch(b.updateSetting(e,n))},addLayout:function(){},removeLayout:function(){},resizeLayouts:function(e,n){t.props.dispatch(b.resizeLayouts(e,n))},activate:function(){},dndLayout:function(){},removeWidget:function(){}},n=this.state.layout,o=this.props,u=o.width,c=o.height,d=o.appMode;if(!n)return null;var p=a({},s.DEFAULT_LAYOUT_SETTING,n.setting),l=_.calPixelPosition(n.pos,u,c,p),f=r({},this.props.style,{position:"relative",margin:"0 auto"});return i.createElement(v.ActionContext.Provider,{value:e},i.createElement("div",{className:"layout",style:f},i.createElement(y.LayoutItem,{style:this.props.style,layout:n,appMode:d,pos:l})))},e}(i.PureComponent);e.default=u.connect(function(t){return{appConfig:t.appConfig,appMode:t.appMode}})(w)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(6),r=n(1),i=n(5),a=n(3);function s(t){var e=null;return Object.keys(t).some(function(n){if(void 0===t[n].parentId)return e=t[n],!0}),e.type===i.LayoutType.SIDEBAR_LAYOUT?function t(e,n){var o=null;Object.keys(n).some(function(t){var r=n[t];if(!(r.parentId!==e||r.setting&&"attach"in r.setting))return o=n[t],!0});if(o&&o.type===i.LayoutType.SIDEBAR_LAYOUT)return t(o.id,n);return o}(e.id,t):e}function u(t,e,n,r){var i=t.layoutId,a=t.layoutItemId;if(!r[i]||!r[i][a])return r;var s=o.isImmutable(r)?r:o(r);if(n){var u=o(r[i][a].setting||{}).merge(n);s=s.setIn([i,a,"setting"],u)}if(e){var c=o(r[i][a].pos).merge(e);s=s.setIn([i,a,"pos"],c)}return s}function c(t,e){var n=[],o=function(t){n.push(t),Object.keys(e).forEach(function(n){e[n].parentId===t&&o(e[n].id)})};return o(t),n}e.findRootLayout=s,e.addWidget=function(t,e,n){var u=e.layoutId,c=e.layoutItemId;r(n[u],"layoutId "+u+" missing");var d=n;if(o.isImmutable(n)||(d=o(n)),e.layoutItemId)return r(n[u][c],"layoutId "+u+"."+c+" missing"),d.setIn([u,c,"widgetId"],t);var p=s(n[u]),l=a.getMaximumId(n[u])+1,f={id:""+l,layoutId:u,parentId:p.id,type:i.LayoutType.WIDGET,widgetId:t,pos:{x:0,y:0,w:300,h:200}};return p.type===i.LayoutType.GRID_LAYOUT&&(f.pos={x:0,y:1/0,w:4,h:3}),d.setIn([u,""+l],f)},e.addSection=function(t,e,n){var u=e.layoutId,c=e.layoutItemId;r(n[u],"layoutId "+u+" missing");var d=n;if(o.isImmutable(n)||(d=o(n)),e.layoutItemId)return r(n[u][c],"layoutId "+u+"."+c+" missing"),d.setIn([u,c,"sectionId"],t);var p=s(n[u]),l=a.getMaximumId(n[u])+1,f={id:""+l,layoutId:u,parentId:p.id,type:i.LayoutType.SECTION_LAYOUT,sectionId:t,pos:{x:0,y:0,w:300,h:200}};return p.type===i.LayoutType.GRID_LAYOUT&&(f.pos={x:0,y:1/0,w:4,h:3}),d.setIn([u,""+l],f)},e.addLayout=function(t,e,n,i,s){r(s[t],"layoutId "+t+" missing");var u=o.isImmutable(s)?s:o(s),c=a.getMaximumId(s[t])+1,d={id:""+c,layoutId:t,parentId:e,type:i,pos:n};return u.setIn([t,""+c],d)},e.removeWidget=function(t,e){var n=o.isImmutable(e)?e:o(e);return Object.keys(e).forEach(function(o){Object.keys(e[o]).forEach(function(r){e[o][r].type===i.LayoutType.WIDGET&&e[o][r].widgetId===t&&(n=n.setIn([o,r,"widgetId"],null))})}),n},e.removeLayout=function(t,e){var n=t.layoutId,r=t.layoutItemId;if(!e[n]||!e[n][r])return e;var i=e,a=e[n];o.isImmutable(e)||(i=o(e)),o.isImmutable(a)||(a=o(a));var s=function(t,e){var n=e.without(t);return Object.keys(e).forEach(function(o){e[o].parentId===t&&(n=s(o,n))}),n};return a=s(r,a),i.set(n,a)},e.updateSetting=function(t,e,n){return u(t,null,e,n)},e.updateLayout=u,e.resizeLayouts=function(t,e,n){var r=o.isImmutable(n)?n:o(n);return t.forEach(function(t){var n=t.layoutId,o=t.id;r[n]&&r[n][o]&&(r=e?r.setIn([n,o,"pos",e],t.pos):r.setIn([n,o,"pos"],t.pos))}),r},e.activeLayout=function(t,e){var n=e;return Object.keys(e).forEach(function(r){var i=o.isImmutable(e[r])?e[r]:o(e[r]);Object.keys(i).forEach(function(e){if(r===t.layoutId&&e===t.layoutItemId)i=i.setIn([e,"setting","active"],!0);else{var n=o(i[e].setting||{}).without("active");i=i.setIn([e,"setting"],n)}}),n=n.set(r,i)}),n},e.findDescendantIdArray=c,e.dndLayout=function(t,e,n,i){var s=t.layoutId,u=t.layoutItemId;if(!i[s]||!i[s][u])return i;if(!i[e.layoutId]||!i[e.layoutId][e.layoutItemId])return i;var d=i[s][u],p=i[e.layoutId][e.layoutItemId];if(s===e.layoutId&&d.parentId===p.id)return i;if(s!==e.layoutId){var l=a.getMaximumId(i[e.layoutId]),f=o.isImmutable(i[s])?i[s]:o(i[s]),g=o.isImmutable(i[e.layoutId])?i[e.layoutId]:o(i[e.layoutId]);return c(d.id,f).forEach(function(t){var i=o.isImmutable(f[t])?f[t]:o(f[t]),a=i.id;i=t===u?i.set("id",""+(+i.id+l+1)).set("parentId",""+ +p.id).set("pos",n):i.set("id",""+(+i.id+l+1)).set("parentId",""+(+i.parentId+l+1)),r(!g[i.id],"layout with id "+i.id+" should not in "+e.layoutId+" before dropping"),g=g.set(i.id,i),f=f.without(a)}),i.set(s,f).set(e.layoutId,g)}return i.setIn([s,u,"parentId"],p.id).setIn([s,u,"pos"],n)},e.removeSection=function(t,e){var n=o.isImmutable(e)?e:o(e);return Object.keys(e).forEach(function(r){var a=o.isImmutable(e[r])?e[r]:o(e[r]);Object.keys(e[r]).forEach(function(n){e[r][n].type===i.LayoutType.SECTION_LAYOUT&&e[r][n].sectionId===t&&(a=a.without(n))}),n=n.set(r,a)}),n},e.changeLayoutOrder=function(t,e,n){var r=t.layoutId,a=t.layoutItemId;if(!n[r]||!n[r][a])return n;var s=n[r][a].parentId;if(!s||!n[r][s]||n[r][s].type!==i.LayoutType.FIXED_LAYOUT)return n;var u=[];Object.keys(n[r]).forEach(function(t){var e=n[r][t],o=e.setting;e.parentId===s&&u.push({id:t,order:e.setting&&!isNaN(+o.order)?+o.order:0})});var c=-1;(u=u.sort(function(t,e){return t.order-e.order})).some(function(t,e){if(t.id===a)return c=e,!0});var d=u[c];switch(e){case i.OrderAdjustType.BRING_FORWARD:c<u.length-1&&(u[c]=u[c+1],u[c+1]=d);break;case i.OrderAdjustType.SEND_BACKWARD:c>0&&(u[c]=u[c-1],u[c-1]=d);break;case i.OrderAdjustType.BRING_TO_FRONT:if(c<u.length-1){for(var p=c;p<u.length-1;p++)u[p]=u[p+1];u[u.length-1]=d}break;case i.OrderAdjustType.SEND_TO_BACK:if(c>0){for(p=c;p>0;p--)u[p]=u[p-1];u[0]=d}}var l=o.isImmutable(n)?n:o(n);return u.forEach(function(t,e){l=l.setIn([r,t.id,"setting","order"],e)}),l}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(6),r=n(127),i=n(20),a=o({default:{0:{id:"0",pos:{x:0,y:0,w:0,h:0},type:n(5).LayoutType.FIXED_LAYOUT}}});e.globalLayoutReducer=function(t,e){switch(void 0===t&&(t=a),e.type){case i.GlobalLayoutActions.ADD_WIDGET:return r.addWidget(e.widgetId,e.layoutInfo,t);case i.GlobalLayoutActions.ADD_SECTION:return r.addSection(e.sectionId,e.layoutInfo,t);case i.GlobalLayoutActions.REMOVE_LAYOUT:return r.removeLayout(e.layoutInfo,t);case i.GlobalLayoutActions.RESIZE_LAYOUTS:return r.resizeLayouts(e.layouts,e.breakpoint,t);case i.GlobalLayoutActions.UPDATE_SETTING:return r.updateSetting(e.layoutInfo,e.newSetting,t);case i.GlobalLayoutActions.REMOVE_WIDGET:return r.removeWidget(e.widgetId,t);case i.GlobalLayoutActions.ADD_LAYOUT:return r.addLayout(e.layoutId,e.parentId,e.initPosition,e.layoutType,t);case i.GlobalLayoutActions.DRAG_DROP_LAYOUT:var n=e.layoutInfo,o=e.parentLayoutInfo,s=e.newPosition;return r.dndLayout(n,o,s,t);case i.GlobalLayoutActions.ACTIVATE:return r.activeLayout(e.layoutInfo,t);case i.GlobalLayoutActions.REMOVE_SECTION:return r.removeSection(e.sectionId,t);case i.GlobalLayoutActions.UPDATE_LAYOUT:return r.updateLayout(e.layoutInfo,e.pos,e.newSetting,t);case i.GlobalLayoutActions.CHANGE_ORDER:return r.changeLayoutOrder(e.layoutInfo,e.orderType,t);default:return t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),r=n(6),i=n(5),a=n(71);function s(t){return!t.overlay}e.calculatePosition=function(t,e,n,o,r){var a={},u=t.header,c=t.footer,d=t.left,p=t.right;if(u){if(!0===u.setting.toggleOn&&null===u.pos.h)return a.header={x:0,y:0,w:e,h:n},a;var l={x:0,y:0,w:e,h:u.pos.h};!1===u.setting.toggleOn&&(l.h=u.setting.min||0),a.header=l}if(c){if(!0===c.setting.toggleOn&&null===c.pos.h)return a.footer={x:0,y:0,w:e,h:n},a;l={x:0,y:0,w:e,h:c.pos.h},!1===c.setting.toggleOn&&(l.h=c.setting.min||0),l.y=n-l.h,a.footer=l}if(d){if(!0===d.setting.toggleOn&&null===d.pos.w)return a.left={x:0,y:0,w:e,h:n},a;(l={x:0,y:u&&s(u.setting)?a.header.h:0,w:d.pos.w,h:0}).h=n-l.y-(c&&s(c.setting)?a.footer.h:0),!1===d.setting.toggleOn&&(l.w=d.setting.min||0),a.left=l}if(p){if(!0===p.setting.toggleOn&&null===p.pos.w)return a.right={x:0,y:0,w:e,h:n},a;(l={x:0,y:u&&s(u.setting)?a.header.h:0,w:p.pos.w,h:0}).h=n-l.y-(c&&s(c.setting)?a.footer.h:0),!1===p.setting.toggleOn&&(l.w=p.setting.min||0),l.x=e-l.w,a.right=l}return a.main={x:d&&s(d.setting)?a.left.w:0,y:u&&s(u.setting)?a.header.h:0,w:e-(d&&s(d.setting)?a.left.w:0)-(p&&s(p.setting)?a.right.w:0),h:n-(u&&s(u.setting)?a.header.h:0)-(c&&s(c.setting)?a.footer.h:0)},o===i.AttachType.TOP&&u&&s(u.setting)&&r&&(a.main.h-=r.h,a.main.y+=r.h),o===i.AttachType.BOTTOM&&c&&s(c.setting)&&r&&(a.main.h-=r.h),o===i.AttachType.LEFT&&d&&s(d.setting)&&r&&(a.main.w-=r.w,a.main.x+=r.w),o===i.AttachType.RIGHT&&p&&s(p.setting)&&r&&(a.main.w-=r.w),a},e.collectSidebars=function(t,e){var n={};return t.forEach(function(t){var s=o({},a.DEFAULT_SIDEBAR_SETTING,t.setting),u=r(t).set("setting",s),c=s.attach;switch(e&&e.split(",").forEach(function(e){var n=e.split(":");4===n.length&&t.layoutId===n[0]&&t.id===n[1]&&(u="true"===n[3]?u.setIn(["setting",n[2]],!0):"false"===n[3]?u.setIn(["setting",n[2]],!1):isNaN(+n[3])?u.setIn(["setting",n[2]],n[3]):u.setIn(["setting",n[2]],+n[3]))}),c){case i.AttachType.TOP:n.header=u;break;case i.AttachType.BOTTOM:n.footer=u;break;case i.AttachType.LEFT:n.left=u;break;case i.AttachType.RIGHT:n.right=u;break;default:n.main=u}}),n},e.occupySpace=s,e.visible=function(t){return!t.togglable||t.toggleOn}},function(t,e,n){(t.exports=n(16)(!1)).push([t.i,"@supports (position: -webkit-sticky) or (position: sticky) {\n  .header {\n    position: -webkit-sticky;\n    position: sticky;\n    top: 0;\n    z-index: 1050; }\n  .sidebar {\n    position: -webkit-sticky;\n    position: sticky;\n    z-index: 1000; } }\n\n.sidebar-layout {\n  width: 100%;\n  height: 100%; }\n",""])},function(t,e,n){var o=n(130);"string"==typeof o&&(o=[[t.i,o,""]]);var r={transform:void 0};n(15)(o,r);o.locals&&(t.exports=o.locals)},function(t,e,n){(t.exports=n(16)(!1)).push([t.i,".sidebar-layout .sidebar_handler_top,\n.sidebar-layout .sidebar_handler_left,\n.sidebar-layout .sidebar_handler_bottom,\n.sidebar-layout .sidebar_handler_right {\n  position: absolute;\n  cursor: pointer;\n  background-color: #fff;\n  border: 1px solid #ced4da; }\n  .sidebar-layout .sidebar_handler_top::before,\n  .sidebar-layout .sidebar_handler_left::before,\n  .sidebar-layout .sidebar_handler_bottom::before,\n  .sidebar-layout .sidebar_handler_right::before {\n    content: '';\n    display: block;\n    width: 0;\n    height: 0;\n    border: 5px solid transparent; }\n\n.sidebar-layout .sidebar_handler_top,\n.sidebar-layout .sidebar_handler_bottom {\n  left: 50%;\n  padding: 5px 18px;\n  transform: translate(-50%, 0); }\n\n.sidebar-layout .sidebar_handler_left,\n.sidebar-layout .sidebar_handler_right {\n  top: 50%;\n  padding: 18px 5px;\n  transform: translate(0, -50%); }\n\n.sidebar-layout .sidebar_handler_top {\n  bottom: -15px;\n  border-top: 0; }\n  .sidebar-layout .sidebar_handler_top::before {\n    border-bottom: 0;\n    border-top-color: #343a40; }\n\n.sidebar-layout .sidebar_handler_left {\n  right: -15px;\n  border-left: 0; }\n  .sidebar-layout .sidebar_handler_left::before {\n    border-left: 0;\n    border-right-color: #343a40; }\n\n.sidebar-layout .sidebar_handler_bottom {\n  top: -15px;\n  border-bottom: 0; }\n  .sidebar-layout .sidebar_handler_bottom::before {\n    border-top: 0;\n    border-bottom-color: #343a40; }\n\n.sidebar-layout .sidebar_handler_right {\n  left: -15px;\n  border-right: 0; }\n  .sidebar-layout .sidebar_handler_right::before {\n    border-right: 0;\n    border-left-color: #343a40; }\n\n.sidebar-layout .toggle-off .sidebar_handler_left::before,\n.sidebar-layout .toggle-off .sidebar_handler_right::before {\n  transform: scaleX(-1); }\n\n.sidebar-layout .toggle-off .sidebar_handler_top::before,\n.sidebar-layout .toggle-off .sidebar_handler_bottom::before {\n  transform: scaleY(-1); }\n",""])},function(t,e,n){var o=n(132);"string"==typeof o&&(o=[[t.i,o,""]]);var r={transform:void 0};n(15)(o,r);o.locals&&(t.exports=o.locals)},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(7),s=n(14),u=n(3),c=n(71);n(133);var d=n(9),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype._getLayoutId=function(){return this.props.layout?this.props.layout.id:""},e.prototype.toggleItem=function(){var t=a({},c.DEFAULT_SIDEBAR_SETTING,this.props.layout.setting);this.props.onToggleChange(this.props.layout.id,!t.toggleOn)},e.prototype.render=function(){var t=this.props,e=t.pos,n=t.style,o=t.layout,a=t.className,c=e.w,p=e.h,l=o.setting,f=l.attach,g=l.togglable,y=l.toggleOn,h=null;(!g||g&&y||l.min>0)&&(h=i.createElement(d.LayoutItem,{pos:{x:0,y:0,w:c,h:p},layout:o,appMode:this.props.appMode}));var I=r({},u.setTransform(e),n),m=s(a,{"toggle-on":g&&y,"toggle-off":g&&!y});return i.createElement("div",{className:m,style:I},h,g&&i.createElement("div",{className:"sidebar_handler_"+f,onClick:this.toggleItem.bind(this)}))},e.defaultProps={onToggleChange:function(){}},e}(i.PureComponent);e.Sidebar=p},function(t,e,n){(t.exports=n(16)(!1)).push([t.i,".fixed-layout {\n  width: 100%;\n  height: 100%; }\n\n.restricted-fixed-layout {\n  width: 100%;\n  height: 100%;\n  overflow: auto; }\n\n.layout-container {\n  width: 100%;\n  height: 100%; }\n",""])},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(6);e.sortLayoutItems=function(t){var e=[];return t.forEach(function(t){var n=o(t);t.setting&&!isNaN(+t.setting.order)||(n=n.setIn(["setting","order"],0)),e.push(n)}),e.sort(function(t,e){return t.setting.order-e.setting.order})}},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(14),a=n(7),s=n(43),u=n(78),c=n(33),d=n(3),p=n(136),l=n(74);n(73);var f=n(13),g=n(9),y=n(52),h=c.default()(u.default(null)(g.LayoutItem)),I=function(t){function e(e){var n=t.call(this,e)||this;return d.autoBindHandlers(n,["_onItemResizeEnd"]),n}return o(e,t),e.prototype.componentDidMount=function(){var t=this.ref;this.clientRect=t.getBoundingClientRect()},e.prototype.componentDidUpdate=function(){var t=this.ref;this.clientRect=t.getBoundingClientRect()},e.prototype._getFixedPosOfLayoutItem=function(t){var e=d.getLayoutItem(this.props.layout.content,t),n=a({},l.DEFAULT_FIX_LAYOUT_SETTING,e.setting);return d.calPixelPosition(e.pos,this.props.width,this.props.height,n)},e.prototype._onItemResizeEnd=function(t,e,n,o,r){var i=this.props.actionContext,s=d.getLayoutItem(this.props.layout.content,t),u=a({},l.DEFAULT_FIX_LAYOUT_SETTING,s.setting),c=this._getFixedPosOfLayoutItem(t);this.setState({movingLayout:null,deltaPos:null});var p={x:e,y:n,w:c.w+o,h:c.h+r},f=d.calLayoutPosition(p,this.props.width,this.props.height,u);i.resizeLayouts([{id:t,layoutId:s.layoutId,pos:f}])},e.prototype._processLayoutItem=function(t,e,n){if(t){var o=this.props.appMode,i=this._getFixedPosOfLayoutItem(t.id);return r.createElement(h,{key:e,pos:i,layout:t,appMode:o,disableInteract:o!==f.AppMode.Design,resizeGrid:[n.gridSize,n.gridSize],onResizeEnd:this._onItemResizeEnd})}},e.prototype.render=function(){var t=this,e=this.props,n=e.layout,o=e.connectDropTarget,s=e.isOver,u=e.draggingItem,c=n.content||[],d=p.sortLayoutItems(c),f=a({},l.DEFAULT_FIX_LAYOUT_SETTING,n.setting),g=!0===s&&u&&(u.layout.layoutId!==n.layoutId||u.layout.parentId!==n.id),y=i("fixed-layout",{"drop-target":!0===g});return o&&o(r.createElement("div",{ref:function(e){return t.ref=e},className:y,"data-layoutid":n.layoutId,"data-layoutitemid":n.id},d.map(function(e,n){return t._processLayoutItem(e,n,f)})))},e.displayName="FixedLayout",e.defaultProps={actionContext:{updateSetting:d.emptyFunc,addLayout:d.emptyFunc,removeLayout:d.emptyFunc,resizeLayouts:d.emptyFunc,dndLayout:d.emptyFunc,activate:d.emptyFunc,removeWidget:d.emptyFunc}},e}(r.PureComponent),m={drop:function(t,e,n){if(n&&!e.didDrop()){var o=e.getItem(),r=t.actionContext;if(o.layout.layoutId===t.layout.layoutId&&o.layout.parentId===t.layout.id){var i=e.getDifferenceFromInitialOffset(),s=a({},l.DEFAULT_FIX_LAYOUT_SETTING,t.layout.setting).gridSize,u=n._getFixedPosOfLayoutItem(o.layout.id),c={x:Math.round((u.x+i.x)/s)*s,y:Math.round((u.y+i.y)/s)*s,w:Math.round(u.w/s)*s,h:Math.round(u.h/s)*s},p=d.getLayoutItem(t.layout.content,o.layout.id),f=a({},l.DEFAULT_FIX_LAYOUT_SETTING,p.setting),g=d.calLayoutPosition(c,t.width,t.height,f);r.resizeLayouts([{id:o.layout.id,layoutId:o.layout.layoutId,pos:g}])}else{var y=e.getSourceClientOffset(),h=o.width,I=o.height;r.dndLayout({layoutItemId:o.layout.id,layoutId:o.layout.layoutId},{layoutItemId:t.layout.id,layoutId:t.layout.layoutId},{x:y.x-n.clientRect.left,y:y.y-n.clientRect.top,w:h,h:I})}}}};e.FixedLayout=s.DropTarget([y.DND_TYPES.LAYOUT],m,function(t,e){return{connectDropTarget:t.dropTarget(),isOver:e.isOver({shallow:!0}),draggingItem:e.getItem()}})(I)},function(t,e,n){(t.exports=n(16)(!1)).push([t.i,".grid-layout {\n  width: 100%;\n  height: 100%; }\n\n.layout-grid-item {\n  box-sizing: border-box;\n  transition: all 200ms ease; }\n  .layout-grid-item__content {\n    width: 100%;\n    height: 100%;\n    overflow: auto; }\n  .layout-grid-item:not(.react-grid-placeholder) {\n    background: #ccc;\n    border: 1px solid black; }\n  .layout-grid-item.cssTransforms {\n    transition-property: transform; }\n  .layout-grid-item .text {\n    font-size: 16px;\n    text-align: center;\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    margin: auto;\n    height: 24px; }\n  .layout-grid-item .remove {\n    position: absolute;\n    right: 2px;\n    top: 0px;\n    cursor: pointer; }\n  .layout-grid-item.grid-item-placeholder {\n    background: red;\n    opacity: 0.2;\n    transition-duration: 100ms;\n    z-index: 2;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    -o-user-select: none;\n    user-select: none; }\n  .layout-grid-item.layout-grid-item--resizing {\n    z-index: 1;\n    will-change: width, height; }\n  .layout-grid-item.layout-grid-item--dragging {\n    transition: none;\n    z-index: 3;\n    will-change: transform; }\n  .layout-grid-item.layout-grid-item--draggable {\n    cursor: move; }\n\n/*\n.grid-item-placeholder {\n  background: red;\n  opacity: 0.2;\n  transition-duration: 100ms;\n  z-index: 2;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  -o-user-select: none;\n  user-select: none;\n}\n*/\n",""])},function(t,e,n){(t.exports=n(16)(!1)).push([t.i,".layout-item {\n  background: #FFFFFF;\n  box-sizing: border-box; }\n  .layout-item__content {\n    width: 100%;\n    height: 100%; }\n  .layout-item.has-focus {\n    outline: 1px solid #E5E5E5; }\n\n.drop-target {\n  background: #D9F0FF;\n  outline: 1px solid #55BCFF;\n  box-shadow: inset 0 0 8px 0 rgba(0, 0, 0, 0.15); }\n\n.section-layout {\n  outline: 1px solid #E5E5E5; }\n",""])},function(t,e,n){var o=n(139);"string"==typeof o&&(o=[[t.i,o,""]]);var r={transform:void 0};n(15)(o,r);o.locals&&(t.exports=o.locals)},function(t,e){t.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUwLjIgKDU1MDQ3KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5zZXR0aW5nczwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJidWlsZGVyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iZGVzaWduLW1vZGVfc2VjdGlvbl9lZGl0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtOTg2LjAwMDAwMCwgLTQ5NC4wMDAwMDApIiBmaWxsPSIjRkZGRkZGIj4KICAgICAgICAgICAgPGcgaWQ9InNldGluZ19pY29uLWdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5NDUuMDAwMDAwLCA0ODcuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8ZyBpZD0ic2V0dGluZ3MiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQxLjAwMDAwMCwgNy4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTMuMjU3MTQyOSw4LjM4MDk1MjM4IEMxMy4yNTcxNDI5LDguMTUyMzgwOTUgMTMuMzMzMzMzMyw3LjkyMzgwOTUyIDEzLjMzMzMzMzMsNy42MTkwNDc2MiBDMTMuMzMzMzMzMyw3LjMxNDI4NTcxIDEzLjMzMzMzMzMsNy4wODU3MTQyOSAxMy4yNTcxNDI5LDYuODU3MTQyODYgTDE0Ljg1NzE0MjksNS41NjE5MDQ3NiBDMTUuMDA5NTIzOCw1LjQwOTUyMzgxIDE1LjAwOTUyMzgsNS4yNTcxNDI4NiAxNC45MzMzMzMzLDUuMTA0NzYxOSBMMTMuNDA5NTIzOCwyLjQzODA5NTI0IEMxMy4zMzMzMzMzLDIuMzYxOTA0NzYgMTMuMTgwOTUyNCwyLjI4NTcxNDI5IDEyLjk1MjM4MSwyLjM2MTkwNDc2IEwxMS4wNDc2MTksMy4xMjM4MDk1MiBDMTAuNjY2NjY2NywyLjgxOTA0NzYyIDEwLjIwOTUyMzgsMi41OTA0NzYxOSA5Ljc1MjM4MDk1LDIuMzYxOTA0NzYgTDkuNDQ3NjE5MDUsMC4zODA5NTIzODEgQzkuNTIzODA5NTIsMC4xNTIzODA5NTIgOS4yOTUyMzgxLDAgOS4xNDI4NTcxNCwwIEw2LjA5NTIzODEsMCBDNS45NDI4NTcxNCwwIDUuNzE0Mjg1NzEsMC4xNTIzODA5NTIgNS43MTQyODU3MSwwLjMwNDc2MTkwNSBMNS40MDk1MjM4MSwyLjM2MTkwNDc2IEM0Ljk1MjM4MDk1LDIuNTE0Mjg1NzEgNC41NzE0Mjg1NywyLjgxOTA0NzYyIDQuMTE0Mjg1NzEsMy4xMjM4MDk1MiBMMi4yODU3MTQyOSwyLjM2MTkwNDc2IEMyLjA1NzE0Mjg2LDIuMjg1NzE0MjkgMS45MDQ3NjE5LDIuMzYxOTA0NzYgMS43NTIzODA5NSwyLjUxNDI4NTcxIEwwLjIyODU3MTQyOSw1LjE4MDk1MjM4IEMwLjE1MjM4MDk1Miw1LjI1NzE0Mjg2IDAuMjI4NTcxNDI5LDUuNDg1NzE0MjkgMC4zODA5NTIzODEsNS42MzgwOTUyNCBMMS45ODA5NTIzOCw2Ljg1NzE0Mjg2IEMxLjk4MDk1MjM4LDcuMDg1NzE0MjkgMS45MDQ3NjE5LDcuMzE0Mjg1NzEgMS45MDQ3NjE5LDcuNjE5MDQ3NjIgQzEuOTA0NzYxOSw3LjkyMzgwOTUyIDEuOTA0NzYxOSw4LjE1MjM4MDk1IDEuOTgwOTUyMzgsOC4zODA5NTIzOCBMMC4zODA5NTIzODEsOS42NzYxOTA0OCBDMC4yMjg1NzE0MjksOS44Mjg1NzE0MyAwLjIyODU3MTQyOSw5Ljk4MDk1MjM4IDAuMzA0NzYxOTA1LDEwLjEzMzMzMzMgTDEuODI4NTcxNDMsMTIuOCBDMS45MDQ3NjE5LDEyLjg3NjE5MDUgMi4wNTcxNDI4NiwxMi45NTIzODEgMi4yODU3MTQyOSwxMi44NzYxOTA1IEw0LjE5MDQ3NjE5LDEyLjExNDI4NTcgQzQuNTcxNDI4NTcsMTIuNDE5MDQ3NiA1LjAyODU3MTQzLDEyLjY0NzYxOSA1LjQ4NTcxNDI5LDEyLjg3NjE5MDUgTDUuNzkwNDc2MTksMTQuODU3MTQyOSBDNS43OTA0NzYxOSwxNS4wMDk1MjM4IDUuOTQyODU3MTQsMTUuMTYxOTA0OCA2LjE3MTQyODU3LDE1LjE2MTkwNDggTDkuMjE5MDQ3NjIsMTUuMTYxOTA0OCBDOS4zNzE0Mjg1NywxNS4xNjE5MDQ4IDkuNiwxNS4wMDk1MjM4IDkuNiwxNC44NTcxNDI5IEw5LjkwNDc2MTksMTIuODc2MTkwNSBDMTAuMzYxOTA0OCwxMi42NDc2MTkgMTAuODE5MDQ3NiwxMi40MTkwNDc2IDExLjIsMTIuMTE0Mjg1NyBMMTMuMTA0NzYxOSwxMi44NzYxOTA1IEMxMy4yNTcxNDI5LDEyLjk1MjM4MSAxMy40ODU3MTQzLDEyLjg3NjE5MDUgMTMuNTYxOTA0OCwxMi43MjM4MDk1IEwxNS4wODU3MTQzLDEwLjA1NzE0MjkgQzE1LjE2MTkwNDgsOS45MDQ3NjE5IDE1LjE2MTkwNDgsOS42NzYxOTA0OCAxNS4wMDk1MjM4LDkuNiBMMTMuMjU3MTQyOSw4LjM4MDk1MjM4IEwxMy4yNTcxNDI5LDguMzgwOTUyMzggWiBNNy42MTkwNDc2MiwxMC4yODU3MTQzIEM2LjE3MTQyODU3LDEwLjI4NTcxNDMgNC45NTIzODA5NSw5LjA2NjY2NjY3IDQuOTUyMzgwOTUsNy42MTkwNDc2MiBDNC45NTIzODA5NSw2LjE3MTQyODU3IDYuMTcxNDI4NTcsNC45NTIzODA5NSA3LjYxOTA0NzYyLDQuOTUyMzgwOTUgQzkuMDY2NjY2NjcsNC45NTIzODA5NSAxMC4yODU3MTQzLDYuMTcxNDI4NTcgMTAuMjg1NzE0Myw3LjYxOTA0NzYyIEMxMC4yODU3MTQzLDkuMDY2NjY2NjcgOS4wNjY2NjY2NywxMC4yODU3MTQzIDcuNjE5MDQ3NjIsMTAuMjg1NzE0MyBMNy42MTkwNDc2MiwxMC4yODU3MTQzIFoiIGlkPSJTaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="},function(t,e){t.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTNweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTMgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUwLjIgKDU1MDQ3KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5kZWxldGU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz48L2RlZnM+CiAgICA8ZyBpZD0iYnVpbGRlciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9ImRlc2lnbi1tb2RlX3NlY3Rpb25fZWRpdCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk1NS4wMDAwMDAsIC00OTQuMDAwMDAwKSIgZmlsbD0iI0ZGRkZGRiI+CiAgICAgICAgICAgIDxnIGlkPSJzZXRpbmdfaWNvbi1ncm91cCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTQ1LjAwMDAwMCwgNDg3LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPGcgaWQ9ImRlbGV0ZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuMDAwMDAwLCA3LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLjg4ODg4ODg4OSwxNC4yMjIyMjIyIEMwLjg4ODg4ODg4OSwxNS4yIDEuNjg4ODg4ODksMTYgMi42NjY2NjY2NywxNiBMOS43Nzc3Nzc3OCwxNiBDMTAuNzU1NTU1NiwxNiAxMS41NTU1NTU2LDE1LjIgMTEuNTU1NTU1NiwxNC4yMjIyMjIyIEwxMS41NTU1NTU2LDMuNTU1NTU1NTYgTDAuODg4ODg4ODg5LDMuNTU1NTU1NTYgTDAuODg4ODg4ODg5LDE0LjIyMjIyMjIgTDAuODg4ODg4ODg5LDE0LjIyMjIyMjIgWiBNMTIuNDQ0NDQ0NCwwLjg4ODg4ODg4OSBMOS4zMzMzMzMzMywwLjg4ODg4ODg4OSBMOC40NDQ0NDQ0NCwwIEw0LDAgTDMuMTExMTExMTEsMC44ODg4ODg4ODkgTDAsMC44ODg4ODg4ODkgTDAsMi42NjY2NjY2NyBMMTIuNDQ0NDQ0NCwyLjY2NjY2NjY3IEwxMi40NDQ0NDQ0LDAuODg4ODg4ODg5IEwxMi40NDQ0NDQ0LDAuODg4ODg4ODg5IFoiIGlkPSJTaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="},,function(t,e,n){var o=n(143);(t.exports=n(16)(!1)).push([t.i,".layout-widget {\n  width: 100%;\n  height: 100%; }\n  .layout-widget .settings {\n    position: absolute;\n    height: 32px;\n    width: 60px;\n    display: flex;\n    justify-content: space-evenly;\n    left: 0;\n    top: -32px;\n    background: #0189F3;\n    border: 0; }\n    .layout-widget .settings .settings-item {\n      width: 32px;\n      height: 32px;\n      background-position: center;\n      background-repeat: no-repeat;\n      cursor: pointer;\n      opacity: 0.8; }\n      .layout-widget .settings .settings-item:hover {\n        opacity: 1; }\n      .layout-widget .settings .settings-item + .settings-item {\n        position: relative; }\n        .layout-widget .settings .settings-item + .settings-item::before {\n          content: ' ';\n          display: block;\n          position: absolute;\n          border-left: 1px solid #fff;\n          left: -1px;\n          top: 4px;\n          bottom: 4px;\n          opacity: 0.2; }\n    .layout-widget .settings .delete {\n      background-image: url("+o(n(142))+");\n      background-size: 13px 16px; }\n    .layout-widget .settings .config {\n      background-image: url("+o(n(141))+");\n      background-size: 16px; }\n  .layout-widget .highlight {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(232, 75, 75, 0.4); }\n  .layout-widget.placeholder {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    outline: 1px solid #E5E5E5; }\n    .layout-widget.placeholder .handler {\n      cursor: pointer;\n      font-size: 24px; }\n",""])},function(t,e,n){var o=n(144);"string"==typeof o&&(o=[[t.i,o,""]]);var r={transform:void 0};n(15)(o,r);o.locals&&(t.exports=o.locals)},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(8),a=n(47),s=n(13),u=n(3),c=n(25);n(145);var d=n(50),p=function(t){function e(e){var n=t.call(this,e)||this;return n.state={showSettings:!1},u.autoBindHandlers(n,["showSetting","hideSetting"]),n}return o(e,t),e.prototype.componentDidMount=function(){this.props.widgetId&&a.default.getInstance().loadWidgetClass(this.props.widgetId)},e.prototype.componentDidUpdate=function(){this.props.widgetId&&(!this.props.runtimeInfo||!this.props.runtimeInfo.isClassLoaded)&&a.default.getInstance().loadWidgetClass(this.props.widgetId)},e.prototype.showSetting=function(){var t=this.props,e=t.appMode,n=t.widgetId;e===s.AppMode.Config&&n&&this.setState({showSettings:!0})},e.prototype.hideSetting=function(){this.setState({showSettings:!1})},e.prototype.render=function(){var t=this,e=this.props,n=e.appMode,o=e.layout,i=this.state.showSettings;if(this.props.widgetId){var u=a.default.getInstance().getWidgetClass(this.props.widgetId);return u?r.createElement(c.ActionContext.Consumer,null,function(e){return r.createElement("div",{className:"layout-widget","data-widgetid":t.props.widgetId,onMouseEnter:t.showSetting,onMouseLeave:t.hideSetting},r.createElement(u,null),n===s.AppMode.Design&&r.createElement("div",{className:"widget-mask",style:{position:"absolute",left:0,top:0,width:"100%",height:"100%"}}),n===s.AppMode.Config&&i&&r.createElement("div",{className:"settings"},r.createElement("div",{onClick:function(){e.removeWidget(t.props.widgetId),d.publishRemoveWidgetToBuilder(t.props.widgetId)},className:"settings-item delete"}),r.createElement("div",{onClick:function(){return d.publishCurrentEditWidgetChangeToBuilder(t.props.widgetId)},className:"settings-item config"})),n===s.AppMode.Config&&t.props.runtimeInfo.isHighlight&&r.createElement("div",{className:"highlight"}," "))}):r.createElement("div",{className:"jimu-small-loading"})}return n!==s.AppMode.Run?r.createElement(c.ActionContext.Consumer,null,function(t){return r.createElement("div",{className:"layout-widget placeholder",style:{width:"100%",height:"100%"}},r.createElement("div",{className:"handler",onClick:function(){return d.letBuilderPopupChooseWidget(o.layoutId,o.id)}},"+"))}):null},e}(r.PureComponent);e.default=i.connect(function(t,e){return{runtimeInfo:t.widgetsRuntimeInfo[e.widgetId],appMode:t.appMode}})(p)},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(7),a=n(6),s=n(14),u=n(43),c=n(78),d=n(33),p=n(52),l=n(77),f=n(76),g=n(3),y=n(9);n(75);var h=n(13),I=d.default()(c.default(null)(y.LayoutItem)),m=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.state={breakpoint:"",width:0,numOfCols:-1,colWidth:0,pixelLayouts:{},gridLayouts:{},setting:l.DEFAULT_GRID_LAYOUT_SETTING,layout:null},g.autoBindHandlers(o,["_onItemResize"]),o}return o(e,t),e.prototype.componentDidMount=function(){var t=this.ref;this.clientRect=t.getBoundingClientRect()},e.prototype.componentDidUpdate=function(){var t=this.ref;this.clientRect=t.getBoundingClientRect()},e.getDerivedStateFromProps=function(t,e){if(t.layout!==e.layout){var n=i({},l.DEFAULT_GRID_LAYOUT_SETTING,t.layout.setting),o=n.space,r=n.padding,s=f.getBreakpointFromWidth(n.breakpoints,t.width),u=f.getColsFromBreakpoint(s,n.cols),c=(t.width-o*(u-1)-2*r[0])/u,d=f.collectLayoutsAtBreakpoint(t.layout.content,s,n),p={},g={};return f.generateResponsiveLayout(d,u,n.compactType).forEach(function(t){g[t.id]=a(t.pos),p[t.id]=a(f.toPixelPosition(t.pos,n,c))}),{breakpoint:s,pixelLayouts:p,gridLayouts:g,width:t.width,numOfCols:u,colWidth:c,setting:n,layout:t.layout}}return null},e.prototype._onItemResize=function(t,e,n,o,r){var i=this,s=this.state,u=s.numOfCols,c=s.gridLayouts,d=s.pixelLayouts,p=s.setting,l=s.colWidth,g=s.breakpoint,y=(c[t],d[t]),h={x:e,y:n,w:y.w+o,h:y.h+r},I=f.toGridPosition(h,p,u,l),m=Object.keys(c).map(function(e){return e!==t?{id:e,pos:c[e]}:{id:e,pos:I}}),v=f.moveElement(m,t,p.compactType,u,I.x,I.y,!0,!1),_={},b={};(v=f.compact(v,p.compactType,u)).forEach(function(e){var n=e.id===t?h:null;b[e.id]=a(e.pos),_[e.id]=a(f.toPixelPosition(e.pos,p,l,n,n))});var w=this.props.actionContext,O=Object.keys(b).map(function(t){return{id:t,layoutId:i.props.layout.layoutId,pos:b[t]}});w.resizeLayouts(O,g)},e.prototype.processGridItem=function(t,e){var n=this.state.pixelLayouts,o=this.props.appMode,i=n[t.id],a={x:i.x,y:i.y,w:i.w,h:i.h};return r.createElement(I,{key:e,pos:a,layout:t,appMode:o,disableInteract:o!==h.AppMode.Design,onResizeEnd:this._onItemResize})},e.prototype.render=function(){var t=this,e=this.props,n=e.className,o=e.style,i=e.layout,a=e.connectDropTarget,u=e.isOver,c=e.draggingItem,d=i.content||[],p=!0===u&&c&&(c.layout.layoutId!==i.layoutId||c.layout.parentId!==i.id),l=s("grid-layout",n,{"drop-target":!0===p});return a&&a(r.createElement("div",{ref:function(e){return t.ref=e},className:l,style:o,"data-layoutitemid":i.id,"data-layoutid":i.layoutId},d.map(function(e,n){return t.processGridItem(e,n)})))},e.displayName="GridLayout",e.defaultProps={autoSize:!0,className:"",style:{},layout:null,actionContext:{updateSetting:g.emptyFunc,addLayout:g.emptyFunc,removeLayout:g.emptyFunc,resizeLayouts:g.emptyFunc,dndLayout:g.emptyFunc,activate:g.emptyFunc,removeWidget:g.emptyFunc}},e}(r.Component),v={drop:function(t,e,n){if(n&&!e.didDrop()){var o=e.getItem(),r=t.actionContext;if(o.layout.layoutId===t.layout.layoutId&&o.layout.parentId===t.layout.id){var i=e.getDifferenceFromInitialOffset(),a=n.state.pixelLayouts[o.layout.id];n._onItemResize(o.layout.id,a.x+i.x,a.y+i.y,0,0)}else{var s=o.width,u=o.height,c=e.getSourceClientOffset(),d=n.state,p=d.colWidth,l=d.setting;r.dndLayout({layoutItemId:o.layout.id,layoutId:o.layout.layoutId},{layoutItemId:t.layout.id,layoutId:t.layout.layoutId},{x:Math.round((c.x-n.clientRect.left)/p),y:Math.round((c.y-n.clientRect.top)/l.rowHeight),w:Math.round(s/p),h:Math.round(u/l.rowHeight)})}}}};e.GridLayout=u.DropTarget([p.DND_TYPES.LAYOUT],v,function(t,e){return{connectDropTarget:t.dropTarget(),isOver:e.isOver({shallow:!0}),draggingItem:e.getItem()}})(m)},,function(t,e,n){(t.exports=n(16)(!1)).push([t.i,'/*\n.action-handler {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  border: 1px solid $edit-box-default-color;\n  */\n.handle {\n  position: absolute; }\n  .handle.handle-resize-corner {\n    width: 8px;\n    height: 8px;\n    background-color: #fff;\n    border: 1px solid #3899ec;\n    border-radius: 50%;\n    z-index: 1; }\n    .handle.handle-resize-corner.top.left {\n      top: -4px;\n      left: -4px; }\n    .handle.handle-resize-corner.top.right {\n      top: -4px;\n      right: -4px; }\n    .handle.handle-resize-corner.bottom.right {\n      bottom: -4px;\n      right: -4px; }\n    .handle.handle-resize-corner.bottom.left {\n      bottom: -4px;\n      left: -4px; }\n  .handle.handle-resize-side.top {\n    height: 4px;\n    left: 4px;\n    right: 4px;\n    top: -2px; }\n    .handle.handle-resize-side.top:after {\n      content: "";\n      width: 8px;\n      height: 8px;\n      background-color: #fff;\n      border: 1px solid #3899ec;\n      border-radius: 50%;\n      position: absolute;\n      left: 50%;\n      top: 50%;\n      margin-left: -4px;\n      margin-top: -4px; }\n  .handle.handle-resize-side.right {\n    width: 4px;\n    top: 4px;\n    bottom: 4px;\n    right: -2px; }\n    .handle.handle-resize-side.right:after {\n      content: "";\n      width: 8px;\n      height: 8px;\n      background-color: #fff;\n      border: 1px solid #3899ec;\n      border-radius: 50%;\n      position: absolute;\n      top: 50%;\n      right: 50%;\n      margin-top: -4px;\n      margin-right: -4px; }\n  .handle.handle-resize-side.bottom {\n    height: 4px;\n    left: 4px;\n    right: 4px;\n    bottom: -2px; }\n    .handle.handle-resize-side.bottom:after {\n      content: "";\n      width: 8px;\n      height: 8px;\n      background-color: #fff;\n      border: 1px solid #3899ec;\n      border-radius: 50%;\n      position: absolute;\n      left: 50%;\n      bottom: 50%;\n      margin-left: -4px;\n      margin-bottom: -4px; }\n  .handle.handle-resize-side.left {\n    width: 4px;\n    top: 4px;\n    bottom: 4px;\n    left: -2px; }\n    .handle.handle-resize-side.left:after {\n      content: "";\n      width: 8px;\n      height: 8px;\n      background-color: #fff;\n      border: 1px solid #3899ec;\n      border-radius: 50%;\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      margin-top: -4px;\n      margin-left: -4px; }\n\n/* }*/\n',""])},function(t,e,n){var o=n(149);"string"==typeof o&&(o=[[t.i,o,""]]);var r={transform:void 0};n(15)(o,r);o.locals&&(t.exports=o.locals)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(7),a=n(43),s=n(173),u=n(26),c=n(8),d=n(33),p=n(5),l=n(3),f=n(147),g=n(137),y=n(72),h=n(70),I=n(51),m=n(9),v=n(25),_=n(49),b=n(49),w=n(19),O=n(12),A=n(20),M=n(13);I.registerLayout(p.LayoutType.FIXED_LAYOUT,g.FixedLayout),I.registerLayout(p.LayoutType.GRID_LAYOUT,f.GridLayout),I.registerLayout(p.LayoutType.SIDEBAR_LAYOUT,y.SidebarLayout),I.registerLayout(p.LayoutType.SECTION_LAYOUT,h.default);var T=d.default()(m.LayoutItem),x=function(t){function e(e){var n=t.call(this,e)||this;return n.state={layout:null},w.default.getInstance().registerExtension({epName:O.ExtensionPoints.ReduxStore,extension:new _.default}),w.default.getInstance().registerExtension({epName:O.ExtensionPoints.ReduxStore,extension:new b.default}),l.autoBindHandlers(n,["_onItemResizeEnd"]),n.layoutActions={updateSetting:function(t,e){n.props.dispatch(A.updateSetting(t,e))},addLayout:function(t,e,o,r){n.props.dispatch(A.addLayout(t,e,o,r))},removeLayout:function(t){n.props.dispatch(A.removeLayout(t))},resizeLayouts:function(t,e){n.props.dispatch(A.resizeLayouts(t,e))},activate:function(t){n.props.dispatch(A.activate(t))},dndLayout:function(t,e,o){n.props.dispatch(A.dndLayout(t,e,o))},removeWidget:function(t){n.props.dispatch(A.removeWidget(t))},removeSection:function(t){n.props.dispatch(A.removeSection(t))}},n}return o(e,t),e.getDerivedStateFromProps=function(t,e){if(t.layout!==e.layout){var n=t.layout,o=t.width,r=t.height,a=i({},u.DEFAULT_LAYOUT_SETTING,n.setting),s=l.calPixelPosition(n.pos,o,r,a);return{layout:t.layout,width:t.width,height:t.height,layoutPos:s}}return null},e.prototype._onItemResizeEnd=function(t,e,n,o,r){if(this._isInDesignMode()){var a=this.props.layout.pos,s=this.state,c=s.width,d=s.height,p=i({},u.DEFAULT_LAYOUT_SETTING,this.props.layout.setting),f=l.calPixelPosition(a,c,d,p);f.w+=o,f.h+=r;var g=l.calLayoutPosition(f,c,d,p);this.props.dispatch(A.resizeLayouts([{id:t,layoutId:this.props.layout.layoutId,pos:g}]))}},e.prototype._isInDesignMode=function(){return this.props.appMode===M.AppMode.Design},e.prototype.render=function(){var t=this.state,e=t.width,n=t.height,o=t.layout;if(!o)return null;var a=this.props.appMode,s=i({},u.DEFAULT_LAYOUT_SETTING,o.setting),c=l.calPixelPosition(o.pos,e,n,s);return r.createElement(v.ActionContext.Provider,{value:this.layoutActions},r.createElement("div",{className:"layout",style:{width:"100%",height:"100%"}},r.createElement(T,{layout:o,pos:c,appMode:a,left:!1,top:!1,disableInteract:a!==M.AppMode.Design,onResizeEnd:this._onItemResizeEnd,style:{position:"relative",margin:"0 auto"}})))},e}(r.PureComponent),E=c.connect(function(t){return{appConfig:t.appConfig,appMode:t.appMode}})(x);e.default=a.DragDropContext(s.default)(E)},,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(6),r=n(11),i=n(21),a=n(47),s=n(102),u=n(19),c=n(44),d=n(12),p=n(259),l=n(13),f=function(){function t(){}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.loadAppConfig=function(){var t=this;return this.loadRawAppConfig().then(function(e){return t.processAppConfigAfterLoad(e),t.loadAllWidgetsManifest(e)}).then(function(e){return t.addDefaultLabelAndIcon(e),t.loadAndUpgradeAllWidgetsConfig(e)}).then(function(e){return t.registerAllWidgetExtensions(e)}).then(function(e){return t.applyAppConfigProcessorExtension(e)}).then(function(e){return t.createAllWidgetMessageActions(e)}).then(function(e){return t.setDocumentTitle(e.attributes.title),o(e)})},t.prototype.setDocumentTitle=function(t){t&&(r.store.getState().appContext.isBuilder||r.store.getState().appMode!==l.AppMode.Preview&&r.store.getState().appMode!==l.AppMode.Run||(document.title=t))},t.prototype.registerAllWidgetExtensions=function(t){return u.default.getInstance().registerAllWidgetExtensions(t).then(function(){return t})},t.prototype.createAllWidgetMessageActions=function(t){return s.default.getInstance().createMessageActions(t).then(function(){return t})},t.prototype.loadRawAppConfig=function(){var t=u.default.getInstance().getExtensions(d.ExtensionPoints.AppConfigService)[0];return t?t.loadAppConfig():this.loadAppConfigWithDefault()},t.prototype.loadAppConfigWithDefault=function(){if(!r.store.getState().appContext.isBuilder&&r.store.getState().queryObject.id)return this.loadAppConfigFromPortal(r.store.getState().queryObject.id);var t=r.store.getState().queryObject.config;return t||(t="config.json"),fetch(t).then(function(t){return t.json()}).then(function(t){return t})},t.prototype.loadAppConfigFromPortal=function(t){var e=c.default.getInstance();return e.initFromLocalStorage(),p.getItemData(t,{authentication:e.getSession()}).catch(e.handleAuthError.bind(e))},t.prototype.applyAppConfigProcessorExtension=function(t){var e=u.default.getInstance().getExtensions(d.ExtensionPoints.AppConfigProcessor)[0];return e?e.process(t):Promise.resolve(t)},t.prototype.loadAllWidgetsManifest=function(t){var e=[];return i.getAllWidgets(t).forEach(function(t,n){t.uri&&e.push(a.default.getInstance().loadWidgetManifest(t).then(function(e){return t.manifest=e,t}))}),Promise.all(e).then(function(e){return t})},t.prototype.loadAndUpgradeAllWidgetsConfig=function(t){var e=[];return i.getAllWidgets(t).forEach(function(t,n){t.uri&&e.push(a.default.getInstance().loadWidgetConfig(t))}),Promise.all(e).then(function(e){return t})},t.prototype.processAppConfigAfterLoad=function(t){this.addWidgetContext(t),this.addDefaultValues(t)},t.prototype.addWidgetContext=function(t){i.getAllWidgets(t).forEach(function(t){var e=i.getWidgetContext(t.uri);t.context=e})},t.prototype.addDefaultValues=function(t){t.attributes||(t.attributes={}),t.sharedArea||(t.sharedArea={header:{},footer:{},leftArea:{},rightArea:{},layout:"__app_layout"});var e={__app_layout:{0:{id:"0",pos:{x:0,y:0,w:100,h:100},type:"sidebar",setting:{widthInPixel:!1,alignCenter:!0,heightInPixel:!1}},1:{id:"1",parentId:"0",pos:{x:0,y:0,h:50},type:"fixed",setting:{attach:"top",togglable:!1}},2:{id:"2",parentId:"0",pos:{x:0,y:0,h:50},type:"fixed",setting:{attach:"bottom",togglable:!1}},3:{id:"3",parentId:"0",pos:{x:0,y:0,w:50},type:"fixed",setting:{attach:"left",togglable:!1}},4:{id:"4",parentId:"0",pos:{x:0,y:0,w:50},type:"fixed",setting:{attach:"right",togglable:!1}}}};return t.layouts?t.layouts.__app_layout||(t.layouts=Object.assign(t.layouts,e)):t.layouts=e,t},t.prototype.addDefaultLabelAndIcon=function(t){i.getAllWidgets(t).forEach(function(t){i.addWidgetDefaultLabelAndIcon(t)})},t}();e.default=f},,function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(66),a=n(1),s=n(265),u=n(8),c=n(264),d=n(10),p=n(258),l=n(126),f=n(3),g=n(5),y=n(31),h=function(t){function e(e){var n=t.call(this,e)||this;return n.rootRef=r.createRef(),n.mounted=!1,n}return o(e,t),e.prototype.componentDidMount=function(){var t=this;c.default.getInstance().loadAppConfig().then(function(e){t.props.dispatch(d.appConfigLoaded(e)),t.props.dispatch(d.initStoreExtensionState())}),this._debouncedResize=s(this.updateDimensions.bind(this),100),window.addEventListener("resize",this._debouncedResize),this.mounted=!0;var e=this.rootRef.current.getBoundingClientRect();this.setState({width:e.width,height:e.height})},e.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this._debouncedResize)},e.prototype.updateDimensions=function(){var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this.setState({width:t,height:e});var n=y.isMobileSize({width:t,height:e});this.props.isMobile!==n&&this.props.dispatch(d.isMobileChanged(n))},e.prototype._prepareLayout=function(){},e.prototype.render=function(){if(!this.mounted)return r.createElement("div",{style:{height:"100vh",width:"100vw"},ref:this.rootRef});if(!this.props.appConfig)return r.createElement("div",{style:{height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center"}},"Loading...");var t=this.props.queryObject.page?this.props.queryObject.page:"default",e=this.props.appConfig.pages[t],n=(this.props.isMobile&&e.mobileLayout?e.mobileLayout:e.layout,function(t,e,n){var o=n&&t.mobileLayout?t.mobileLayout:t.layout,r=e.layouts[o];a(r,"Unknown layout id. "+o);var i=f.generateLayoutStructure(o,e.layouts),s=e.sharedArea;if(s){var u=n&&s.mobileLayout?s.mobileLayout:s.layout,c=e.layouts[u];a(r,"Unknown sharedArea layout id. "+u);var d=function(t,e,n){var o={};return Object.keys(e).forEach(function(r){switch((e[r].setting||{}).attach){case g.AttachType.TOP:t.header&&n.sharedArea&&n.sharedArea.header&&(o[r]=e[r]);break;case g.AttachType.BOTTOM:t.footer&&n.sharedArea&&n.sharedArea.footer&&(o[r]=e[r]);break;case g.AttachType.LEFT:t.leftArea&&n.sharedArea&&n.sharedArea.leftArea&&(o[r]=e[r]);break;case g.AttachType.RIGHT:t.rightArea&&n.sharedArea&&n.sharedArea.rightArea&&(o[r]=e[r]);break;default:o[r]=e[r]}}),o}(s,c,t),p=e.layouts.set(u,d),l=f.generateLayoutStructure(u,p);return l=l.update("content",function(t){return[].concat(l.content||[],i)})}return i}(e,this.props.appConfig,this.props.isMobile)),o=this.props.appConfig.skin,s=window.amdRequire.toUrl("skins"),u=this.state,c=u.width,d=u.height;return r.createElement("div",{ref:this.rootRef,style:{width:"100%",height:"100%"}},o?i.createPortal(r.createElement("link",{type:"text/css",rel:"stylesheet",href:s+"/"+o+"/index.css"}),document.head):null,function(t,e,n,o){if(window.jimuConfig.isInBuilder)return r.createElement("div",{className:"page"},r.createElement(p.default,{layout:e,width:n,height:o}));return r.createElement("div",{className:"page"},r.createElement(l.default,{layout:e,width:n,height:o}))}(0,n,c,d))},e}(r.PureComponent);e.default=u.connect(function(t){return{appConfig:t.appConfig,queryObject:t.queryObject,isMobile:t.appContext.isMobile}})(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(6),r=n(10),i=n(13),a=n(19),s=n(12);e.default=function(t,e){if(!t)return function(){var t={appConfig:null,portalUrl:"https://www.arcgis.com/sharing/rest",widgetsRuntimeInfo:o({}),appContext:null,appMode:i.AppMode.Run,jimuCoreNls:null,queryObject:null,dataSourcesInfo:o({}),widgetState:{},token:null,user:null};return o(t)}();switch(e.type){case r.ActionKeys.InitStoreExtensionState:return function(t){for(var e=a.default.getInstance().getExtensions(s.ExtensionPoints.ReduxStore),n=0;n<e.length;n++){var o=e[n],r=o.getStoreKey().split(".");t.getIn(r)||(t=t.setIn(r,o.getInitLocalState()))}return t}(t);case r.ActionKeys.AppConfigLoaded:var n=t.set("appConfig",e.appConfig);return e.appConfig.attributes.portalUrl&&(n=n.set("portalUrl",e.appConfig.attributes.portalUrl)),n;case r.ActionKeys.InitPortalUrl:return t.set("portalUrl",e.portalUrl);case r.ActionKeys.AppConfigChanged:return function(t,e){return t=(t=t.set("appConfig",e.appConfig)).set("widgetsRuntimeInfo",t.widgetsRuntimeInfo.without.apply(t.widgetsRuntimeInfo,e.appConfigDiff.removedWidgets))}(t,e);case r.ActionKeys.AppModeChanged:return t.set("appMode",e.mode);case r.ActionKeys.AppContextInit:return t.set("appContext",e.appContext);case r.ActionKeys.JimuCoreNlsLoaded:return t.set("jimuCoreNls",e.nls);case r.ActionKeys.QueryObjectChanged:return function(t,e){return t=t.set("queryObject",o(e.query))}(t,e);case r.ActionKeys.SetAppInBuilder:return t.set("appContext",t.appContext.merge({isInBuilder:!0}));case r.ActionKeys.WidgetClassLoaded:return function(t,e){return t.widgetsRuntimeInfo[e]?t.widgetsRuntimeInfo[e].isClassLoaded?t:t.setIn(["widgetsRuntimeInfo",e,"isClassLoaded"],!0):t.setIn(["widgetsRuntimeInfo",e],{isClassLoaded:!0,state:"closed",windowState:"normal"})}(t,e.widgetId);case r.ActionKeys.OpenWidget:return function(t,e){return"closed"!==t.widgetsRuntimeInfo[e].state?t:t.setIn(["widgetsRuntimeInfo",e,"state"],"opened")}(t,e.widgetId);case r.ActionKeys.CloseWidget:return function(t,e){return"closed"===t.widgetsRuntimeInfo[e].state?t:t.setIn(["widgetsRuntimeInfo",e,"state"],"closed")}(t,e.widgetId);case r.ActionKeys.ToggleWidgetHighLight:return function(t,e,n){return!1===n?t.setIn(["widgetsRuntimeInfo",e,"isHighlight"],!1):(Object.keys(t.widgetsRuntimeInfo).forEach(function(e){t.widgetsRuntimeInfo[e].isHighlight&&(t=t.setIn(["widgetsRuntimeInfo",e,"isHighlight"],!1))}),t.setIn(["widgetsRuntimeInfo",e,"isHighlight"],!0))}(t,e.widgetId,e.isHighlight);case r.ActionKeys.SetWidgetIsSettingState:return!1===e.isSetting?t.setIn(["widgetsRuntimeInfo",e.widgetId,"isSetting"],!1):(Object.keys(t.widgetsRuntimeInfo).forEach(function(e){t.widgetsRuntimeInfo[e].isSetting&&(t=t.setIn(["widgetsRuntimeInfo",e,"isSetting"],!1))}),t.setIn(["widgetsRuntimeInfo",e.widgetId,"isSetting"],!0));case r.ActionKeys.LayoutClassLoaded:return t.setIn(["isLayoutClassLoaded",e.layoutName],!0);case r.ActionKeys.DataSourceStatusChanged:return t.setIn(["dataSourcesInfo",e.dataSourceId,"status"],e.status);case r.ActionKeys.WidgetStatePropChange:return function(t,e){var n=e.propKey.split(".");return t.setIn(["widgetState",e.widgetId].concat(n),e.value)}(t,e);case r.ActionKeys.DataSourceCurrentIndexesChanged:return t.setIn(["dataSourcesInfo",e.dataSourceId,"currentIndexes"],e.currentIndexes);case r.ActionKeys.SessionStart:return t.set("token",e.token);case r.ActionKeys.UserSignIn:return t.set("user",o(e.user));case r.ActionKeys.UserSignOut:return t.merge({token:null,user:null});case r.ActionKeys.IsMobileChanged:return t.setIn(["appContext","isMobile"],e.isMobile);default:return function(t,e){for(var n=a.default.getInstance().getExtensions(s.ExtensionPoints.ReduxStore),o=0;o<n.length;o++){var r=n[o];if(r.getActions().indexOf(e.type)>-1){var i=r.getStoreKey().split("."),u=t.getIn(i);return t.setIn(i,r.getReducer()(u,e,t))}}return t}(t,e)}}},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(8),a=n(11),s=n(266),u=n(46),c=function(t){function e(e){var n=t.call(this,e)||this;return n.state={error:null},n}return o(e,t),e.prototype.componentDidCatch=function(t,e){this.setState({error:t})},e.prototype.render=function(){return this.state.error?r.createElement("h1",null,"this.state.error"):this.props.children},e}(r.Component),d=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.render=function(){return r.createElement(i.Provider,{store:a.store},r.createElement(c,null,r.createElement(u.HistoryProvider,null,r.createElement(s.default,null))))},e}(r.PureComponent);e.default=d},,,,,,,,,,,,,,function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.React=r;var i=n(66);e.ReactDOM=i;var a=n(8);e.ReactRedux=a;var s=n(109),u=n(6);e.SeamlessImmutable=u;var c=n(14);e.classNames=c;var d=n(6);e.ImmutableObject=d.ImmutableObject,e.ImmutableArray=d.ImmutableArray;var p=n(108);e.I18NManager=p.default;var l=n(19);e.ExtensionManager=l.default;var f=n(12);e.ExtensionPoints=f.ExtensionPoints;var g=n(268);e.AppRoot=g.default;var y=n(31),h=n(50),I=n(11);e.store=I.store;var m=n(10),v=n(5);e.LayoutInfo=v.LayoutInfo;var _=n(20);e.layoutActions=_;var b=n(106);e.BaseWidget=b.default;var w=n(47);e.WidgetManager=w.default;var O=n(105);e.DataSourceManager=O.default;var A=n(102);e.MessageManager=A.default;var M=n(44);e.SessionManager=M.default;var T=n(10);e.appActions=T;var x=n(50);e.appBuilderSync=x;var E=n(12);e.extensionSpec=E;var S=n(31);e.utils=S;var L=n(103);e.urlUtils=L;var D=n(21);function C(t,e){return t.split("-")[0]===e.split("-")[0]}function N(t){for(var e=!1,n=["ar","he"],o=0;o<n.length;o++)C(n[o],t)&&(e=!0);return e}e.appConfigUtils=D,o(n(123)),o(n(69)),o(n(107)),o(n(122)),o(n(121)),o(n(69)),o(n(120)),o(n(119)),o(n(104)),o(n(32)),o(n(118)),o(n(13)),o(n(46)),e.init=function(){var t=y.isMobileSize({width:window.innerWidth,height:window.innerHeight}),e=s.parse(location.search),n={isInBuilder:window.jimuConfig.isInBuilder,isBuilder:window.jimuConfig.isBuilder,locale:window.jimuConfig.locale,appPath:window.jimuConfig.appPath,isRTL:N(window.jimuConfig.locale),isMobile:t};!function(t){var e=document.getElementsByTagName("html")[0];N(t)?(e.setAttribute("dir","rtl"),e.className+=" esriRtl jimu-rtl",e.className+=" "+t+" "+(-1!==t.indexOf("-")?t.split("-")[0]:"")):(e.setAttribute("dir","ltr"),e.className+=" esriLtr jimu-ltr",e.className+=" "+t+" "+(-1!==t.indexOf("-")?t.split("-")[0]:""))}(n.locale),I.store.dispatch(m.initAppContext(n)),I.store.dispatch(m.queryObjectChanged(e)),window.jimuConfig.isBuilder||h.listenBuilderEvents();var o=I.store.getState();return I.store.subscribe(function(){window.jimuConfig.isBuilder||o!==I.store.getState()&&(o=I.store.getState(),h.publishAppStateChangeToBuilder()),window._appState=I.store.getState()}),p.default.getInstance().loadNls("jimu-core/lib/nls/strings").then(function(t){I.store.dispatch(m.jimuCoreNlsLoaded(t))})}}])});
//# sourceMappingURL=index.js.map