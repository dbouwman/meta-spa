{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./jimu-core/lib/layouts/utils.ts","webpack:///./jimu-core/lib/layouts/types.ts","webpack:///./jimu-core/lib/layouts/layout-item.tsx","webpack:///./jimu-core/lib/app-actions.ts","webpack:///./jimu-core/lib/store.ts","webpack:///./jimu-core/lib/extension-spec/extension-spec.ts","webpack:///./jimu-core/lib/types/constants.ts","webpack:///./jimu-core/lib/extension-manager.tsx","webpack:///./jimu-core/lib/layouts/actions/global-layout-actions.ts","webpack:///./jimu-core/lib/utils/app-config.ts","webpack:///./jimu-core/lib/layouts/action-context.ts","webpack:///./jimu-core/lib/layouts/default-common-setting.ts","webpack:///./jimu-core/lib/utils/utils.ts","webpack:///./jimu-core/lib/amd-loader.ts","webpack:///./jimu-core/lib/layouts/react-dnd-resizable.tsx","webpack:///./jimu-core/lib/session-manager.tsx","webpack:///./jimu-core/lib/browser-history.tsx","webpack:///./jimu-core/lib/widget-manager.tsx","webpack:///./jimu-core/lib/layouts/global-layout-redux-store-extension.ts","webpack:///./jimu-core/lib/app-builder-sync.ts","webpack:///./jimu-core/lib/layouts/layout-factory.tsx","webpack:///./jimu-core/lib/layouts/react-dnd-types.ts","webpack:///./jimu-core/lib/layouts/section-layout/layout.tsx","webpack:///./jimu-core/lib/layouts/sidebar-layout/default-sidebar-setting.ts","webpack:///./jimu-core/lib/layouts/sidebar-layout/layout.tsx","webpack:///./jimu-core/lib/layouts/fixed-layout/style/layout.scss?c43f","webpack:///./jimu-core/lib/layouts/fixed-layout/default-setting.ts","webpack:///./jimu-core/lib/layouts/grid-layout/style/grid.scss?acc5","webpack:///./jimu-core/lib/layouts/grid-layout/grid-utils.ts","webpack:///./jimu-core/lib/layouts/grid-layout/default-setting.ts","webpack:///./jimu-core/lib/layouts/react-dnd-draggable.tsx","webpack:///./jimu-core/lib/message-manager.tsx","webpack:///./jimu-core/lib/utils/url-utils.ts","webpack:///./jimu-core/lib/data-source/base-types.ts","webpack:///./jimu-core/lib/data-source-manager.tsx","webpack:///./jimu-core/lib/base-widget.tsx","webpack:///./jimu-core/lib/types/app-config.ts","webpack:///./jimu-core/lib/i18n-manager.ts","webpack:///./jimu-core/lib/message/base-types.ts","webpack:///./jimu-core/lib/layouts/fixed-layout/layout-viewer.tsx","webpack:///./jimu-core/lib/layouts/grid-layout/layout-viewer.tsx","webpack:///./jimu-core/lib/layouts/layout-viewer-entry.tsx","webpack:///./jimu-core/lib/layouts/global-action-utils.ts","webpack:///./jimu-core/lib/layouts/reducers/global-reducers.ts","webpack:///./jimu-core/lib/layouts/sidebar-layout/sidebar-layout-util.ts","webpack:///./jimu-core/lib/layouts/sidebar-layout/style/sidebar-layout.scss","webpack:///./jimu-core/lib/layouts/sidebar-layout/style/sidebar-layout.scss?9d67","webpack:///./jimu-core/lib/layouts/sidebar-layout/style/sidebar.scss","webpack:///./jimu-core/lib/layouts/sidebar-layout/style/sidebar.scss?189a","webpack:///./jimu-core/lib/layouts/sidebar-layout/sidebar.tsx","webpack:///./jimu-core/lib/layouts/fixed-layout/style/layout.scss","webpack:///./jimu-core/lib/layouts/fixed-layout/fixed-layout-util.ts","webpack:///./jimu-core/lib/layouts/fixed-layout/layout.tsx","webpack:///./jimu-core/lib/layouts/grid-layout/style/grid.scss","webpack:///./jimu-core/lib/layouts/style/layout-item.scss","webpack:///./jimu-core/lib/layouts/style/layout-item.scss?48cb","webpack:///./jimu-core/lib/layouts/style/images/settings.svg","webpack:///./jimu-core/lib/layouts/style/images/delete.svg","webpack:///./jimu-core/lib/layouts/style/widget.scss","webpack:///./jimu-core/lib/layouts/style/widget.scss?8a6c","webpack:///./jimu-core/lib/layouts/widget-renderer.tsx","webpack:///./jimu-core/lib/layouts/grid-layout/layout.tsx","webpack:///./jimu-core/lib/layouts/style/handle.scss","webpack:///./jimu-core/lib/layouts/style/handle.scss?b201","webpack:///./jimu-core/lib/layouts/layout-entry.tsx","webpack:///./jimu-core/lib/config-manager.tsx","webpack:///./jimu-core/lib/app-root-component.tsx","webpack:///./jimu-core/lib/app-reducer.ts","webpack:///./jimu-core/lib/app-root.tsx","webpack:///./jimu-core/index.tsx"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Immutable","invariant","types_1","generateLayoutStructure","layoutId","layouts","layoutMap","isImmutable","rootLayoutId","simpleLayoutMap","keys","forEach","isNaN","parseInt","node","parentId","updatedLayoutMap","visit","rootId","set","content","id","update","concat","toRatio","total","Math","round","fromRatio","ratio","adjustHorizontal","pos","width","alignCenter","hPriority","x","y","w","h","max","adjustVertical","height","vPriority","emptyFunc","perc","num","clamp","min","autoBindHandlers","el","fns","setTransform","translate","transform","WebkitTransform","MozTransform","msTransform","OTransform","position","isStaticLayout","layout","setting","static","isActiveLayout","active","getSectionLayout","appConfig","info","layoutItemId","widthInPixel","heightInPixel","getMaximumId","setNextNodeId","nextId","randomColor","floor","random","getLayoutItem","len","validateLayoutType","type","LayoutType","SIDEBAR_LAYOUT","FIXED_LAYOUT","GRID_LAYOUT","WIDGET","SECTION_LAYOUT","UNKNOWN","useInteract","jimuConfig","isInBuilder","calPixelPosition","xyInPixel","gridSize","calLayoutPosition","restrict","Infinity","AttachType","OrderAdjustType","CompactType","React","classNames","layout_factory_1","utils_1","widget_renderer_1","action_context_1","constants_1","LayoutItem","_super","_this","this","arguments","state","hasFocus","__extends","_onMouseEnter","setState","_onMouseLeave","render","layoutNode","_a","props","style","className","appMode","createElement","default","widgetId","isRegistered","LayoutFactory","createLayout","isViewerRegistered","createLayoutViewer","isActive","AppMode","Run","mergedStyle","__assign","mergedClassNames","has-focus","ActionContext","Consumer","actions","data-layoutitemid","data-layoutid","onClick","e","Design","preventDefault","stopPropagation","activate","onMouseEnter","onMouseLeave","PureComponent","ActionKeys","appConfigLoaded","AppConfigLoaded","appConfigChanged","appConfigDiff","AppConfigChanged","widgetClassLoaded","WidgetClassLoaded","openWidget","OpenWidget","closeWidget","CloseWidget","initAppContext","appContext","AppContextInit","jimuCoreNlsLoaded","nls","JimuCoreNlsLoaded","queryObjectChanged","query","QueryObjectChanged","setAppInBuilder","SetAppInBuilder","appModeChanged","AppModeChanged","toggleWidgetHighlight","isHighlight","ToggleWidgetHighLight","layoutClassLoaded","layoutName","LayoutClassLoaded","dataSourceStatusChanged","dataSourceId","status","DataSourceStatusChanged","initStoreExtensionState","InitStoreExtensionState","widgetStatePropChange","propKey","WidgetStatePropChange","initPortalUrl","portalUrl","InitPortalUrl","dataSourceCurrentIndexesChanged","indexes","DataSourceCurrentIndexesChanged","currentIndexes","sessionStart","token","SessionStart","userSignIn","user","UserSignIn","userSignOut","UserSignOut","isMobileChanged","isMobile","IsMobileChanged","setWidgetIsSettingState","isSetting","SetWidgetIsSettingState","app_reducer_1","redux_1","store","createStore","__REDUX_DEVTOOLS_EXTENSION__","ExtensionPoints","EP_SUPPORT_MULTIPLE_EXTENTIONS","ReduxStore","DataSourceFactory","DummyExtension","AjaxState","app_config_1","amd_loader_1","extension_spec_1","ExtensionManager","extensions","extensionClasses","getInstance","instance","_extensionManager","getExtensions","epName","onStoreChange","registerExtension","extInfo","getExtensionById","extension","console","log","indexOf","sort","a","b","index","registerAllWidgetExtensions","extPromises","getAllWidgets","registerWidgetExtensions","Promise","all","clean","widgetJson","manifest","extentions","ext","registerWidgetExtension","extensionProps","point","resolve","filter","loadWidgetExtensionClass","then","ExtClass","extName","uri","context","amdFolder","amdRequire","ExtensionClass","extId","GlobalLayoutActions","updateLayout","layoutInfo","newSetting","UPDATE_LAYOUT","updateSetting","UPDATE_SETTING","addLayout","initPosition","layoutType","ADD_LAYOUT","removeLayout","REMOVE_LAYOUT","resizeLayouts","breakpoint","RESIZE_LAYOUTS","dndLayout","parentLayoutInfo","newPosition","DRAG_DROP_LAYOUT","ACTIVATE","removeWidget","REMOVE_WIDGET","addWidget","ADD_WIDGET","addSection","sectionId","ADD_SECTION","removeSection","REMOVE_SECTION","changeOrder","orderType","CHANGE_ORDER","getWidgetContext","test","folderUrl","toUrl","isRemote","addThemeManifestProperies","panels","panel","styles","icon","RTLIcon","addWidgetManifestProperties","properties","addWidgetDefaultLabelAndIcon","label","widgets","wId","getWidgetsByName","widgetName","getCleanAppConfig","config","asMutable","deep","wid","getContainerInfoByLayoutId","ContainerType","some","cType","cId","containerType","containerId","getWidgetContainerInfo","ctn","getWidgetContainerIdByContainerType","getSectionContainerInfo","sections","getSectionContainerIdByContainerType","getUniqueId","k","substring","getUniqueLabel","getAppConfigDiff","oldConfig","newConfig","diff","removedWidgets","oldWId","createContext","DEFAULT_LAYOUT_SETTING","draggable","resizable","droppable","isDeepEqual","getCallbackNames","prevState","logShallowDiff","obj","preObj","hasDiff","group","groupEnd","pre","cur","isEqual","getWidgetCallbackNamesFromWidgetState","widgetState","prevWidgetState","getPanelCallbackNamesFromPanelState","panelState","prevPanelState","isMobileBrowser","isMobileSize","size","loadstyle","url","beforeId","containerNode","document","getElementById","getElementsByTagName","cssNode","setAttribute","onload","appendChild","applyMixins","derivedCtor","baseCtors","baseCtor","getOwnPropertyNames","getDataSourceInfosFromQueryObject","queryObject","dsInfo","split","ds","dsId","moduleObj","hoistNonReactStatic","react_rnd_1","injectProps","WrapperComponent","ResizableComponent","deltaSize","deltaPos","isResizing","_enableResizing","left","right","top","bottom","disableInteract","topRight","bottomRight","bottomLeft","topLeft","_onResizeStop","dir","refToElement","delta","onResizeEnd","_onResize","onResizing","_onResizeStart","onResizeStart","minHeight","minWidth","maxHeight","maxWidth","resizeGrid","passThroughProps","__rest","_b","displayPos","enableResizing","_actionHandlers","mergedClass","disableDragging","onResize","onResizeStop","_getLayoutId","handlers","displayName","WrappedComponent","getDisplayName","arcgis_rest_auth_1","arcgis_rest_request_1","app_actions_1","store_1","SessionManager","_setSession","session","localStorageKey","_session","dispatch","localStorage","setItem","serialize","getUser","_clearSession","removeItem","getPortalUrl","getState","getSession","initFromLocalStorage","serializedSession","getItem","UserSession","deserialize","initFromCredential","credential","fromCredential","signIn","oauth2Options","portal","clientId","redirectUri","location","origin","popup","beginOAuth2","newSession","handleAuthError","error","originalRequestOptions","options","ArcGISAuthError","authentication","_retryPromise","retry","signOut","history_1","History","queryString","url_utils_1","Location","browserHistory","createBrowserHistory","listen","action","storeQo","search","locationQo","parse","HistoryContext","changeQueryObject","replace","qo","merge","loc","createLocation","stringify","href","createHref","currentLocation","to","toLocation","parsePath","isAbsoluteUrl","pathname","charAt","substr","HistoryProvider","Provider","children","withHistory","Component","history","changePage","pageId","page","changeView","viewId","views","vId","join","react_redux_1","i18n_manager_1","extension_manager_1","base_widget_1","data_source_manager_1","session_manager_1","WidgetManager","widgetRawClasses","widgetClasses","dependencyResources","_widgetManager","getWidgetClass","deleteWidgetClass","loadWidgetClass","loadRawClass","classInfo","_WidgetClass","WidgetClass","isDojoWidget","appWidgetClassWrapperExtension","WidgetContextClass","injectWidgetProps","wrapWidgetClass","clazz","widgetClass","loadWidgetDependency","hasLocale","loadWidgetNls","WidgetClassWrapper","Error","wrap","handleNewWidgetJson","loadWidgetManifest","loadWidgetConfig","widgetConfig","fetch","res","json","code","reject","widgetNls","i18nLabels","locale","_widgetLabel","tryLoadWidgetConfig","upgradeWidgetConfig","widgetVersion","version","configVersion","hasVersionManager","VersionManager","versionManager","getVersionIndex","upgrade","err","stack","hasConfig","loadNls","dependency","DependencyDefine","resources","getDependencyKey","getResources","newResources","cssResources","jsResources","map","nlsStrings","WidgetWrapper","dsManager","dataSources","onSignIn","onSignOut","componentDidMount","useDataSources","getDataSource","createDataSource","connect","runtimeInfo","widgetsRuntimeInfo","dataSourcesInfo","isBuilder","appState","allOwnProps","assign","mapExtraStateProps","global_reducers_1","global_layout_actions_1","GlobalLayoutReduxStoreExtension","getActions","getInitLocalState","0","getReducer","globalLayoutReducer","getStoreKey","browser_history_1","widget_manager_1","pubsub","_builderPubsub","publishEventToBuilder","publish","listenBuilderEvents","subscribe","evt","layoutContent","publishAppStateChangeToBuilder","publishCurrentEditWidgetChangeToBuilder","publishRemoveWidgetToBuilder","letBuilderPopupChooseWidget","publishWidgetConfigChangeToBuilder","components","viewComponents","registerLayout","itemClass","registerLayoutViewer","LayoutElement","actionContext","DND_TYPES","layout_item_1","SectionLayout","_getCurrentLayoutId","section","viewId_1","view","mobileTheresholdSize","mobileLayoutCompact","mobileLayout","desktopThresholdSize","desktopLayoutCompact","sectionLayout","data-sectionid","defaultProps","default_common_setting_1","DEFAULT_SIDEBAR_SETTING","overlay","togglable","toggleOn","react_dnd_resizable_1","sidebar_1","utils","SidebarLayoutPrototype","resizingSide","interactComponent","onToggleChange","_onItemToggleChange","Sidebar","sideLayouts","collectSidebars","getDerivedStateFromProps","nextProps","targetLayout","layoutItem","attach","_onResizing","dw","dh","_onResizeEnd","positionMap","calculatePosition","LEFT","RIGHT","TOP","BOTTOM","results","toggle","_createSidebar","direction","horizontal","ResizableSidebar","main","header","footer","SidebarLayout","locals","DEFAULT_FIX_LAYOUT_SETTING","order","bottomY","collides","l1","l2","p1","p2","compact","compactType","cols","compareWith","getStatics","sorted","sortLayoutItems","out","Array","idx","compactItem","heightWidth","resolveCompactionCollision","item","moveToCoord","axis","sizeProp","setIn","itemIndex","otherItem","fullLayout","VERTICAL","getFirstCollision","HORIZONTAL","correctBounds","collidesWith","getAllCollisions","moveElement","isUserAction","preventCollision","oldX","oldY","reverse","collisions","collision","moved","moveElementAwayFromCollision","itemToMove","compactH","compactV","fakeItem","undefined","sortLayoutItemsByColRow","sortLayoutItemsByRowCol","sortBreakpoints","breakpoints","synchronizeLayoutWithChildren","initialLayouts","getBreakpointFromWidth","matching","breakpointName","getColsFromBreakpoint","generateResponsiveLayout","collectLayoutsAtBreakpoint","breakpointsSorted","breakpointsAbove","imLayout","toGridPosition","numOfCols","colWidth","space","rowHeight","toPixelPosition","resizingPos","draggingPos","padding","DEFAULT_GRID_LAYOUT_SETTING","lg","md","sm","xs","xxs","react_dnd_1","react_dnd_types_1","DraggableComponent","isDragging","connectDragSource","placeholderStyle","backgroundColor","outline","boxShadow","DragSource","LAYOUT","beginDrag","onMoveStart","endDrag","monitor","onMoveEnd","offset","getDifferenceFromInitialOffset","canDrag","dragSource","MessageManager","messageActions","messageActionClasses","_messageManager","createMessageActions","actionPromises","createMessageAction","actionProp","loadMessageActionClass","ActionClass","publishMessage","message","messagesConfig","messages","matchMessageCfg","messageType","actionJson","actionName","filterMessage","onExecute","path","hash","hashIndex","searchIndex","DataSourceStatus","AbstractDataSource","isDataSourceSet","records","updateStatus","dataSourceManager","onDataSourceStatusChanged","getRecords","getCurrentRecord","getCurrentRecords","getCurrentRecordIndexes","nextRecord","warn","prevRecord","findRecord","clearData","destroy","DataSourceTypes","base_types_1","arcgis_rest_feature_service_1","supportDataSourceTypes","HubAnnotations","HubAnnotationDataRecord","feature","getData","attributes","HubAnnotationsDataSource","dsConfig","init","Unloaded","sessionManager","LoadedLoading","UnloadedLoading","queryFeatures","response","features","Loaded","catch","selectRecord","onDataSourceCurrentIndexesChanged","addRecord","record","adds","addFeatures","objectId","addResults","OBJECTID","addAnnotation","description","target","feature_id","author","username","source","toString","created_at","Date","getTime","getDataSchema","DataSourceManager","_dataSourceManager","destroyDataSource","createAllDataSources","dsJson","dsObj","createHubAnnotationsDataSource","dsFactory","f","getSupportDataSourceTypes","urlDs","oldDs","newDs","added","od","oId","BaseWidget","showDiffLog","onOpen","onClose","onActive","onDeActive","componentDidUpdate","prevProps","fn","isArray","I18NManager","nlsModle","rootNls","root","segs","folder","file","localeNls","MessageType","StringSelectionChangeMessage","str","StringSelectionChange","FeatureSelectionChangeMessage","FeatureSelectionChange","MessageAction","DummyMessageAction","filterMessageType","actionConfig","default_setting_1","FixedLayoutViewer","_processLayoutItem","gridUtils","GridLayoutViewer","activeDrag","pixelLayouts","gridLayouts","layoutSetting","colNo","containerHeight","autoSize","nbRow","processGridItem","mergedClassName","ReactRedux","layout_viewer_1","layout_viewer_2","layout_1","layout_2","global_layout_redux_store_extension_1","JimuLayoutViewer","layoutPos","margin","findRootLayout","filterMainAreaFromSidebar","updatedLayouts","mergedSetting","mergedPos","findDescendantIdArray","childrenIdArray","findDescendants","rootLayout","newLayout","removeDescendants","itemId","without","newLayouts","activeLayout","updatedLayout","parentLayout","nextId_1","fromLayoutMap_1","toLayoutMap_1","idBeforeMove","changeLayoutOrder","siblings","targetIndex","temp","BRING_FORWARD","SEND_BACKWARD","BRING_TO_FRONT","SEND_TO_BACK","defaultState","default_sidebar_setting_1","occupySpace","layoutsQueryObject","param","items","visible","toggleItem","toggle-on","toggle-off","layoutArray","imLayoutItem","react_dnd_draggable_1","fixedUtils","InteractItem","FixedLayoutPrototype","domNode","ref","clientRect","getBoundingClientRect","_getFixedPosOfLayoutItem","itemSetting","_onItemResizeEnd","movingLayout","newPos","relativePos","connectDropTarget","isOver","draggingItem","sortedLayouts","isDropTaget","mergedClasses","drop-target","spec","drop","component","didDrop","clientOffset","getSourceClientOffset","FixedLayout","DropTarget","dropTarget","shallow","escape","app_builder_sync_1","WidgetRendererComponent","showSettings","isClassLoaded","showSetting","Config","hideSetting","WidgetClass_1","data-widgetid","ownProps","GridLayoutPrototype","layoutSetting_1","colWidth_1","breakpointLayouts","pixelLayouts_1","gridLayouts_1","_onItemResize","pixelLayout","moveToPosition","newPixelLayouts","newGridLayouts","dPos","imPos","GridLayout","react_dnd_html5_backend_1","layout_3","layout_4","global_layout_redux_store_extension_2","ResizableLayoutItem","JimuLayout","layoutActions","_isInDesignMode","connectedLayoutEntry","DragDropContext","SeamlessImmutable","message_manager_1","arcgis_rest_items_1","ConfigManager","loadAppConfig","loadRawAppConfig","processAppConfigAfterLoad","loadAllWidgetsManifest","addDefaultLabelAndIcon","loadAndUpgradeAllWidgetsConfig","applyAppConfigProcessorExtension","createAllWidgetMessageActions","setDocumentTitle","title","Preview","AppConfigService","loadAppConfigWithDefault","loadAppConfigFromPortal","configUrl","appId","getItemData","AppConfigProcessor","process","promises","manifests","addWidgetContext","addDefaultValues","uriInfo","sharedArea","leftArea","rightArea","defaultAppLayout","__app_layout","2","3","4","ReactDOM","debounce","config_manager_1","layout_entry_1","layout_viewer_entry_1","utils_2","AppRootComponent","rootRef","createRef","mounted","_debouncedResize","updateDimensions","addEventListener","rect","current","componentWillUnmount","removeEventListener","windowWidth","innerWidth","documentElement","clientWidth","body","windowHeight","innerHeight","clientHeight","_prepareLayout","display","justifyContent","alignItems","pages","pageBodyLayout","sa","saLayoutId","saLayout","filterSaLayout","handleSharedArea","filterLayouts","pageLayout_1","preparePageLayout","skin","skinsFolder","createPortal","rel","head","pageJson","renderPageLayout","INIT_STATE","jimuCoreNls","initState","storeExt","storeKeySegs","getIn","handleAppConfigChange","handleQueryObjectChange","windowState","handleWidgetClassLoaded","handleOpenWidet","handleCloseWidet","handleWidgetPropChange","localState","dispatchActionToExtension","app_root_component_1","ErrorBoundary","componentDidCatch","AppRoot","seamless_immutable_1","ImmutableObject","ImmutableArray","app_root_1","LayoutInfo","appActions","appBuilderSync","extensionSpec","urlUtils","appConfigUtils","localeIsSame","locale1","locale2","isRTL","isRTLLocale","rtlLocales","__export","appPath","dirNode","setRTL","currentState","_appState","jimuNls"],"mappings":"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","file":"jimu-core/index.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([282,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import * as Immutable from 'seamless-immutable';\nimport * as invariant from 'invariant';\nimport { Position, Layout, LayoutMap, GlobalLayouts, LayoutType, FixedLayoutSetting } from './types';\nimport { IMAppConfig } from '../types/app-config';\n\nlet unique_node_id = 1;\n\nexport const emptyFunc = () => {};\n\n/**\n * Helper to convert a number to a percentage string.\n *\n * @param  {Number} num Any number\n * @return {String}     That number as a percentage.\n */\nexport function perc(num: number): string {\n  return num * 100 + \"%\";\n}\n\n/**\n * constrain n to the given range via min + max\n *\n * @param n value\n * @param min the minimum value to be returned\n * @param max the maximum value to be returned\n * @returns the clamped value\n * @private\n */\nexport function clamp(n: number, min: number, max: number): number {\n  return Math.min(max, Math.max(min, n));\n};\n\nexport function autoBindHandlers(el: Object, fns: Array<string>): void {\n  fns.forEach(key => (el[key] = el[key].bind(el)));\n}\n\nexport function setTransform(pos: Position): { [key: string]: string } {\n  // Replace unitless items with px\n  const {x, y, h, w} = pos;\n  const translate = `translate(${x}px,${y}px)`;\n  const result: { [key: string]: string } = {\n    transform: translate,\n    WebkitTransform: translate,\n    MozTransform: translate,\n    msTransform: translate,\n    OTransform: translate,\n    width: `${w}px`,\n    height: `${h}px`,\n    position: \"absolute\"\n  };\n  return result;\n}\n\nexport function isStaticLayout(layout: Layout) {\n  return layout.setting && layout.setting.static === true;\n}\n\nexport function isActiveLayout(layout: Layout) {\n  return layout.setting && layout.setting.active === true;\n}\n\n// export function cloneLayoutMap(layoutMap: LayoutMap): {[key: string]: Layout} {\n//   const result = {};\n//   Object.keys(layoutMap).forEach(key => {\n//     const node = layoutMap[key];\n//     invariant(node, `node is undefined with id ${key}`);\n//     result[key] = cloneLayoutItem(node);\n//   });\n//   return result;\n// }\n\n// // flat layout without content\n// export function cloneLayoutItem(layout: Layout): Layout {\n//   return cloneDeep(layout);\n// }\n\nexport function getSectionLayout(layoutId: string, appConfig: IMAppConfig) {\n  if (layoutId) {\n    return generateLayoutStructure(layoutId, appConfig.layouts as GlobalLayouts);\n  }\n  return {\n    info: {\n      layoutId: layoutId,\n      layoutItemId: '10000'\n    },\n    pos: {x:0,y:0,w:100,h:100},\n    setting: {\n      widthInPixel: false,\n      heightInPixel: false\n    }\n  }\n}\n\nexport function getMaximumId(layoutMap: LayoutMap): number {\n  let max = -1;\n  Object.keys(layoutMap).forEach(key => {\n    const id = parseInt(key);\n    if (id > max) {\n      max = id;\n    }\n  });\n  return max;\n}\n\n/**\n * Generate tree-like Layout from LayoutMap instance.\n * @param layoutMap\n */\nexport function generateLayoutStructure(layoutId: string, layouts: GlobalLayouts): Immutable.ImmutableObject<Layout> {\n  // let rootLayout;\n  // const map = cloneLayoutMap(layoutMap);\n  // Object.keys(map).forEach(key => {\n  //   if (isNaN(parseInt(key))) {\n  //     return;\n  //   }\n  //   const node = map[key];\n  //   if (typeof node.parentId === 'undefined') {\n  //     invariant(!rootLayout, `Only one root layout is allowed`);\n  //     rootLayout = node;\n  //   } else {\n  //     const parentNode = map[node.parentId];\n  //     invariant(parentNode, `parent node is undefined with id ${node.parentId}`);\n  //     parentNode.content = parentNode.content || [];\n  //     parentNode.content.push(node);\n  //   }\n  // });\n  // return rootLayout;\n  invariant(layouts[layoutId], `no layout in appConfig with id ${layoutId}`);\n  let layoutMap: LayoutMap = Immutable.isImmutable(layouts[layoutId]) ? layouts[layoutId] as LayoutMap : Immutable(layouts[layoutId]);\n  let rootLayoutId = null, simpleLayoutMap = {};\n  Object.keys(layoutMap).forEach(key => {\n    if (isNaN(parseInt(key))) {\n      return;\n    }\n    const node = layoutMap[key];\n    if (!simpleLayoutMap[key]) {\n      simpleLayoutMap[key] = [];\n    }\n\n    if (typeof node.parentId === 'undefined') {\n      invariant(rootLayoutId === null, `Only one root layout is allowed`);\n      rootLayoutId = key;\n      return;\n    }\n    let parentId = node.parentId;\n    if (layoutMap[parentId]) {\n      // sharedArea may ignore some layout in configuration\n      if (!simpleLayoutMap[parentId]) {\n        simpleLayoutMap[parentId] = [];\n      }\n      simpleLayoutMap[parentId].push(key);\n    }\n  });\n  invariant(rootLayoutId !== null, 'Root layout id missing');\n\n  const updatedLayoutMap = {};\n  const visit = (rootId: string) => {\n    if (simpleLayoutMap[rootId].length === 0) {\n      updatedLayoutMap[rootId] = Immutable(layoutMap[rootId]).set('layoutId', layoutId);\n      return updatedLayoutMap[rootId];\n    }\n    const content = [];\n    simpleLayoutMap[rootId].forEach(id => {\n      content.push(visit(id));\n    });\n    updatedLayoutMap[rootId] = Immutable(layoutMap[rootId])\n      .update('content', value => [].concat(value || [], content))\n      .set('layoutId', layoutId);\n    return updatedLayoutMap[rootId];\n  };\n  visit(rootLayoutId);\n\n  return updatedLayoutMap[rootLayoutId];\n}\n\n\nexport function setNextNodeId(nextId: number) {\n  unique_node_id = nextId;\n}\n\nfunction _getNextNodeId(): string {\n  return `${unique_node_id++}`;\n}\n\n// for testing\nexport function randomColor(): string {\n  const r = Math.floor(Math.random() * 255),\n    g = Math.floor(Math.random() * 255),\n    b  = Math.floor(Math.random() * 255);\n  return `rgba(${r}, ${g}, ${b}, 0.5)`;\n}\n\n/**\n * Get a layout item by ID. Used so we can override later on if necessary.\n *\n * @param  {Array}  layout Layout array.\n * @param  {String} id     ID\n * @return {LayoutItem}    Item at ID.\n */\nexport function getLayoutItem(layout: Array<Layout>, id: string): Layout {\n  layout = layout || [];\n  for (let i = 0, len = layout.length; i < len; i++) {\n    if (layout[i].id === id) {\n      return layout[i];\n    }\n  }\n}\n\nexport function validateLayoutType(type): LayoutType {\n  if (type === LayoutType.SIDEBAR_LAYOUT ||\n    type === LayoutType.FIXED_LAYOUT ||\n    type === LayoutType.GRID_LAYOUT ||\n    type === LayoutType.WIDGET ||\n    type === LayoutType.SECTION_LAYOUT) {\n    return type;\n  }\n  return LayoutType.UNKNOWN;\n}\n\nexport function useInteract() {\n  if (window && window.jimuConfig) {\n    return window.jimuConfig.isInBuilder;\n  }\n  return false;\n}\n\n/* Calculate the position of root layout (entry point of page) and fixed layout */\nfunction toRatio(value: number, total: number) {\n  return Math.round(value * 100 / total);\n}\n\nfunction fromRatio(ratio: number, total: number) {\n  return ratio * total / 100;\n}\n\n/**\n *\n * @param pos in pixel unit\n * @param width\n * @param alignCenter\n * @param hPriority\n */\nexport function adjustHorizontal(pos: Position, width: number,\n  alignCenter?: boolean, hPriority?: 'left' | 'right'): Position {\n  if (alignCenter == null && hPriority == null) {\n    return pos;\n  }\n  let {x, y, w, h} = pos;\n\n  if (alignCenter) {\n    // keep w, adjust x\n    x = (width - w) / 2;\n  } else if (hPriority === 'right') {\n    // pos.x is the distance to the right edge, convert to left\n    x = Math.max(0, width - x - w);\n  }\n  return {x, y, w, h};\n}\n\n/**\n *\n * @param pos in pixel unit\n * @param height\n * @param vPriority\n */\nexport function adjustVertical(pos: Position, height: number, vPriority?: 'top' | 'bottom') {\n  let {x, y, w, h} = pos;\n\n  if (vPriority === 'bottom') {\n    // pos.y is the distance to the bottom edge, convert to top\n    y = Math.max(0, height - y - h);\n  }\n  return {x, y, w, h};\n}\n\nexport function calPixelPosition(pos: Position, width: number, height: number, setting: FixedLayoutSetting) {\n  const { xyInPixel, alignCenter, hPriority, vPriority, widthInPixel, heightInPixel } = setting;\n  const gridSize = setting.gridSize || 1;\n  let {x, y, w, h} = pos;\n  if (!xyInPixel) { // fixed position is in pixel\n    x = Math.round(fromRatio(x, width)/gridSize) * gridSize;\n    y = Math.round(fromRatio(y, height)/gridSize) * gridSize;\n  } else {\n    x = Math.round(x / gridSize) * gridSize;\n    y = Math.round(y / gridSize) * gridSize;\n  }\n\n  if (isNaN(parseInt(`${w}`))) { // w is missing, touches the right edge\n    w = width - x;\n  } else {\n    if (!widthInPixel) {\n      w = Math.round(fromRatio(w, width)/gridSize) * gridSize;\n    } else {\n      w = Math.round(w / gridSize) * gridSize;\n    }\n  }\n  if (isNaN(parseInt(`${h}`))) { // h is missing, touches the bottom edge\n    h = height - y;\n  } else {\n    if (!heightInPixel) {\n      h = Math.round(fromRatio(h, height)/gridSize) * gridSize;\n    } else {\n      h = Math.round(h / gridSize) * gridSize;\n    }\n  }\n\n  return adjustVertical(adjustHorizontal({x, y, w, h}, width, alignCenter, hPriority),\n    height, vPriority);\n}\n\nexport function calLayoutPosition(pos: Position, width: number, height: number, setting: FixedLayoutSetting) {\n  let {x, y, w, h} = pos;\n  const { xyInPixel, widthInPixel, heightInPixel, restrict } = setting;\n\n  if (restrict) {\n    x = Math.max(0, x), y = Math.max(0, y);\n    if (x + w >= width) {\n      x = width - w;\n      w = Infinity;\n    }\n    if (y + h >= height) {\n      y = height - h;\n      h = Infinity;\n    }\n  }\n\n  if (!xyInPixel) {\n    x = toRatio(x, width);\n    y = toRatio(y, height);\n  }\n  if (!widthInPixel && w !== Infinity) {\n    w = toRatio(w, width);\n  }\n  if (!heightInPixel && h !== Infinity) {\n    h = toRatio(h, height);\n  }\n\n  return { x, y, w, h};\n}","import * as Immutable from 'seamless-immutable';\nimport { AppMode } from '../types/constants';\nexport interface Position {\n  x: number;\n  y: number;\n  w: number;\n  h: number;\n}\n\nexport interface DragResizeEvent {\n  e: Event,\n  node: HTMLElement,\n  posInPixel: Position,\n  posInRatio: Position\n}\n\nexport type DragResizeCallback = (\n  id: string,\n  data: DragResizeEvent\n) => void;\n\nexport const enum LayoutType {\n  UNKNOWN = 'unknown',\n  FIXED_LAYOUT = 'fixed',\n  GRID_LAYOUT = 'grid',\n  WIDGET = 'widget',\n  SIDEBAR_LAYOUT = 'sidebar',\n  SECTION_LAYOUT = 'section',\n  VERTICAL_LAYOUT = 'vertical'\n}\n\nexport interface CommonLayoutSetting {\n  active?: boolean,\n  restrict?: boolean,\n  static?: boolean,\n  draggable?: boolean,\n  resizable?: boolean,\n  droppable?: boolean,\n  xyInPixel?: boolean, // fixed position\n  widthInPixel?: boolean,\n  heightInPixel?: boolean,\n  className?: string,\n  style?: Object\n}\n\nexport interface GridLayoutSetting extends CommonLayoutSetting {\n  compactType?: CompactType,\n  breakpoints?: {[key: string]: number},\n  cols?: {[key: string]: number},\n  padding?: [number, number],\n  space?: number,\n  rowHeight?: number\n}\n\nexport interface FixedLayoutSetting extends CommonLayoutSetting {\n  gridSize?: number,\n  alignCenter?: boolean,\n  order?: number,\n  hPriority?: 'left' | 'right',\n  vPriority?: 'top' | 'bottom'\n}\n\nexport const enum AttachType {\n  TOP = 'top',\n  LEFT = 'left',\n  BOTTOM = 'bottom',\n  RIGHT = 'right'\n}\n\nexport const enum OrderAdjustType {\n  BRING_FORWARD = 0,\n  SEND_BACKWARD = 1,\n  BRING_TO_FRONT = 2,\n  SEND_TO_BACK = 3\n}\n\nexport interface SidebarItemSetting extends CommonLayoutSetting {\n  min?: number;\n  max?: number;\n  overlay?: boolean;\n  togglable?: boolean;\n  toggleOn?: boolean;\n  attach?: AttachType;\n}\n\nexport interface Layout {\n  id: string;\n  parentId?: string;\n  layoutId?: string; // generated dynamically\n  pos: Position;\n  type?: LayoutType;\n  widgetId?: string;\n  sectionId?: string;\n  setting?: GridLayoutSetting | FixedLayoutSetting | SidebarItemSetting;\n  moved?: boolean // flag for grid layout\n  content?: Array<Layout>;\n}\n\nexport interface LayoutProps {\n  pos?: Position;\n  layout?: Layout;\n  displayPosition?: Position;\n  className?: string;\n  style?: Object;\n  appMode?: AppMode;\n}\n\nexport type LayoutMap = Immutable.ImmutableObject<{\n  [key: string]: Layout\n}>; // layout without content\n\nexport type GlobalLayouts = Immutable.ImmutableObject<{[key: string]: {[key: string]: Layout}}>;\n\nexport type ReactDraggableCallbackData = {\n  node: HTMLElement,\n  x: number,\n  y: number,\n  deltaX: number,\n  deltaY: number,\n  lastX: number,\n  lastY: number\n};\n\nexport type EventCallback = (\n  Layout,\n  oldItem?: Layout,\n  newItem?: Layout,\n  placeholder?: Layout,\n  Event?,\n  HTMLElement?\n) => void;\n\nexport const enum CompactType {\n  HORIZONTAL = 'horizontal',\n  VERTICAL = 'vertical',\n  NONE = 'none'\n};\n\nexport interface LayoutActionContext {\n  updateSetting?: (layoutInfo: LayoutInfo, newSetting: Object) => void;\n  addLayout?: (layoutId: string, parentItemId: string, initPosition: Position, layoutType?: LayoutType) => void;\n  removeLayout?: (layoutInfo: LayoutInfo) => void;\n  resizeLayouts?: (layouts: Array<Layout>, breakpoint?: string) => void;\n  dndLayout?: (layoutInfo: LayoutInfo, parentInfo: LayoutInfo, newPosition: Position) => void;\n  activate?: (layoutInfo: LayoutInfo) => void;\n  removeWidget?: (widgetId: string) => void;\n  removeSection?: (sectionId: string) => void;\n}\n\nexport interface LayoutInfo{\n  layoutId: string;\n  layoutItemId?: string;\n}","import * as React from 'react';\nimport classNames = require(\"classnames\");\nimport { Layout, LayoutType, Position} from './types';\nimport { LayoutFactory, isRegistered, isViewerRegistered } from './layout-factory';\nimport { useInteract, setTransform, isActiveLayout } from './utils';\nimport WidgetRenderer from './widget-renderer';\nimport { ActionContext } from './action-context';\nimport './style/layout-item.scss';\nimport { AppMode } from '../types/constants';\n\ninterface Props {\n  layout: Layout;\n  appMode: AppMode;\n  pos: Position;\n  className?: string;\n  style?: Object;\n}\n\ninterface State {\n  hasFocus: boolean;\n}\n\nexport class LayoutItem extends React.PureComponent<Props, State> {\n  state = {\n    hasFocus: false\n  }\n\n  _onMouseEnter() {\n    this.setState({\n      hasFocus: true\n    });\n  }\n\n  _onMouseLeave() {\n    this.setState({\n      hasFocus: false\n    });\n  }\n\n  render() {\n    const { pos, layout, style, className, appMode } = this.props;\n    let { x, y, w, h } = pos;\n    let layoutNode;\n    if (layout.type === LayoutType.WIDGET) {\n      layoutNode = <WidgetRenderer layout={layout} widgetId={layout.widgetId}/>;\n    } else {\n      if (useInteract() && isRegistered(layout.type)) {\n        layoutNode = LayoutFactory.createLayout(layout.type, layout, {\n          width: pos.w,\n          height: pos.h,\n          appMode: appMode\n        });\n      } else if (!useInteract() && isViewerRegistered(layout.type)) {\n        layoutNode = LayoutFactory.createLayoutViewer(layout, {\n          width: pos.w,\n          height: pos.h,\n          appMode: appMode\n        });\n      }\n    }\n    const isActive = appMode !== AppMode.Run && (isActiveLayout(layout) ||\n      (this.state.hasFocus && layout.type === LayoutType.WIDGET));\n    const mergedStyle = {\n      ...setTransform({x, y, w, h}),\n      ...style,\n      ...(layout.setting && layout.setting.style) || {}\n    };\n    const mergedClassNames = classNames('layout-item',\n      className,\n      layout.setting && layout.setting.className,\n      {'has-focus': isActive}\n    );\n    return (\n      <ActionContext.Consumer>\n        {actions => <div data-layoutitemid={layout.id} data-layoutid={layout.layoutId}\n          className={mergedClassNames} style={mergedStyle as any} onClick={(e) => {\n            if (appMode === AppMode.Design) {\n              e.preventDefault();\n              e.stopPropagation();\n              actions.activate({\n                layoutId: layout.layoutId,\n                layoutItemId: layout.id\n              });\n            }\n          }} onMouseEnter={() => {\n            this._onMouseEnter();\n          }} onMouseLeave={() => {\n            this._onMouseLeave();\n          }}\n          >\n            <div className=\"layout-item__content\">\n              {layoutNode}\n            </div>\n          </div>}\n      </ActionContext.Consumer>\n    );\n  }\n}\n","\nimport {AppConfig, WidgetJson, IMAppConfig, AppConfigDiff} from './types/app-config';\nimport {IMState, AppContext} from './types/state';\nimport {AppMode} from './types/constants';\nimport {UrlParameters} from './types/url-parameters';\nimport {DataSourceStatus} from './data-source/base-types';\nimport { IUser } from '@esri/arcgis-rest-common-types';\n\nexport enum ActionKeys{\n  InitStoreExtensionState = 'INIT_STORE_EXTENSION_STATE',\n\n  AppConfigLoaded = 'APPCONFIG_LOADED',\n  AppConfigChanged = 'APPCONFIG_CHANGED',\n\n  InitPortalUrl = 'INIT_PORTAL_URL',\n  \n  WidgetClassLoaded = 'WIDGET_CLASS_LOADED',\n  OpenWidget = 'OPEN_WIDGET',\n  CloseWidget = 'CLOSE_WIDGET',\n  SetWidgetIsSettingState = 'SET_WIDGET_IS_SETTING_STATE',\n\n  SetAppInBuilder = 'SET_APP_IN_BUILDER',\n\n  LayoutClassLoaded = 'LAYOUT_CLASS_LOADED',\n\n  AppContextInit = 'APP_CONTEXT_INIT',\n  JimuCoreNlsLoaded = 'JIMU_CORE_NLS_LOADED',\n\n  //the query string has been changed in history object, so we don't update history on this action\n  QueryObjectChanged = 'QUERY_OBJECT_CHANGED',\n\n  AppModeChanged = 'APP_MODE_CHANGED',\n\n  DataSourceStatusChanged = 'DATA_SOURCE_STATUS_CHANGE',\n  DataSourceCurrentIndexesChanged = 'DATA_SOURCE_CURRENT_INDEXES_CHANGE',\n\n  ToggleWidgetHighLight = 'TOGGLE_WIDGET_HIGH_LIGHT',\n\n  //this event is for widget, widget can use this event to store something in app store\n  WidgetStatePropChange = 'WIDGET_STATE_PROP_CHANGE',\n\n  // events for when a user signs in/out\n  SessionStart = 'SESSION_START',\n  UserSignIn = 'USER_SIGN_IN',\n  UserSignOut = 'USER_SIGN_OUT',\n\n  IsMobileChanged = 'IS_MOBILE_CHANGED',\n}\n\n///////////actions type\n\nexport type ActionTypes = AppConfigLoadedAction | AppConfigChangedAction |\n  WidgetClassLoadedAction | OpenWidgetAction | CloseWidgetAction | ToggleWidgetHighlightAction |\n  AppContextInitAction | JimuCoreNlsLoadedAction | QueryObjectChangedAction | SetAppInBuilderAction |\n  AppModeChangedAction | InitAction | LayoutClassLoadedAction | DataSourceStatusChangeAction |\n  InitStoreExtensionState | WidgetStatePropChangeAction | InitPortalUrlAction | DataSourceCurrentIndexChangeAction |\n  SessionStartAction | UserSignInAction | UserSignOutAction | IsMobileChangedAction | SetWidgetIsSettingStateAction;\n\ninterface InitAction{\n  type: '@@INIT';\n}\ninterface InitStoreExtensionState{\n  type: ActionKeys.InitStoreExtensionState;\n}\nexport interface AppConfigLoadedAction{\n  type: ActionKeys.AppConfigLoaded;\n  appConfig: AppConfig\n}\nexport interface AppConfigChangedAction{\n  type: ActionKeys.AppConfigChanged;\n  appConfig: AppConfig;\n  appConfigDiff: AppConfigDiff;\n}\n\nexport interface WidgetClassLoadedAction{\n  type: ActionKeys.WidgetClassLoaded;\n  widgetId: string\n}\nexport interface OpenWidgetAction{\n  type: ActionKeys.OpenWidget;\n  widgetId: string\n}\nexport interface CloseWidgetAction{\n  type: ActionKeys.CloseWidget;\n  widgetId: string\n}\nexport interface AppContextInitAction{\n  type: ActionKeys.AppContextInit;\n  appContext: AppContext\n}\nexport interface JimuCoreNlsLoadedAction{\n  type: ActionKeys.JimuCoreNlsLoaded;\n  nls: any\n}\nexport interface QueryObjectChangedAction{\n  type: ActionKeys.QueryObjectChanged;\n  query: UrlParameters;\n}\nexport interface SetAppInBuilderAction{\n  type: ActionKeys.SetAppInBuilder;\n}\nexport interface AppModeChangedAction{\n  type: ActionKeys.AppModeChanged;\n  mode: AppMode;\n}\nexport interface ToggleWidgetHighlightAction{\n  type: ActionKeys.ToggleWidgetHighLight;\n  widgetId: string;\n  isHighlight: boolean;\n}\nexport interface LayoutClassLoadedAction{\n  type: ActionKeys.LayoutClassLoaded;\n  layoutName: string;\n}\nexport interface DataSourceStatusChangeAction{\n  type: ActionKeys.DataSourceStatusChanged;\n  dataSourceId: string;\n  status: DataSourceStatus;\n}\nexport interface DataSourceCurrentIndexChangeAction{\n  type: ActionKeys.DataSourceCurrentIndexesChanged;\n  dataSourceId: string;\n  currentIndexes: number[];\n}\nexport interface WidgetStatePropChangeAction{\n  type: ActionKeys.WidgetStatePropChange,\n  widgetId: string;\n  propKey: string; //support this format: a.b.c\n  value: any;\n}\nexport interface InitPortalUrlAction{\n  type: ActionKeys.InitPortalUrl,\n  portalUrl: string;\n}\nexport interface DataSourceCurrentIndexesChangeAction{\n  type: ActionKeys.DataSourceCurrentIndexesChanged;\n  dataSourceId: string;\n  currentIndexes: number[];\n}\nexport interface SessionStartAction {\n  type: ActionKeys.SessionStart,\n  token: string\n}\nexport interface UserSignInAction {\n  type: ActionKeys.UserSignIn;\n  user: IUser;\n}\nexport interface UserSignOutAction {\n  type: ActionKeys.UserSignOut;\n}\nexport interface IsMobileChangedAction {\n  type: ActionKeys.IsMobileChanged;\n  isMobile: boolean;\n}\nexport interface SetWidgetIsSettingStateAction {\n  type: ActionKeys.SetWidgetIsSettingState;\n  widgetId: string;\n  isSetting: boolean;\n}\n\n////////////action creators\nexport function appConfigLoaded(appConfig): AppConfigLoadedAction{\n  return {\n    type: ActionKeys.AppConfigLoaded, \n    appConfig: appConfig\n  };\n}\n\nexport function appConfigChanged(appConfig: IMAppConfig, appConfigDiff: AppConfigDiff): AppConfigChangedAction{\n  return {\n    type: ActionKeys.AppConfigChanged, \n    appConfig: appConfig,\n    appConfigDiff: appConfigDiff\n  };\n}\n\nexport function widgetClassLoaded(widgetId): WidgetClassLoadedAction{\n  return {\n    type: ActionKeys.WidgetClassLoaded,\n    widgetId: widgetId\n  };\n}\n\nexport function openWidget(widgetId): OpenWidgetAction{\n  return {\n    type: ActionKeys.OpenWidget,\n    widgetId: widgetId\n  };\n}\n\nexport function closeWidget(widgetId): CloseWidgetAction{\n  return {\n    type: ActionKeys.CloseWidget,\n    widgetId: widgetId\n  };\n}\n\nexport function initAppContext(appContext: AppContext): AppContextInitAction{\n  return {\n    type: ActionKeys.AppContextInit,\n    appContext: appContext\n  }\n}\n\nexport function jimuCoreNlsLoaded(nls: any): JimuCoreNlsLoadedAction{\n  return {\n    type: ActionKeys.JimuCoreNlsLoaded,\n    nls: nls\n  }\n}\n\nexport function queryObjectChanged(query: UrlParameters): QueryObjectChangedAction{\n  return {\n    type: ActionKeys.QueryObjectChanged,\n    query: query\n  }\n}\n\nexport function setAppInBuilder(): SetAppInBuilderAction{\n  return {\n    type: ActionKeys.SetAppInBuilder,\n  }\n}  \n\nexport function appModeChanged(mode: AppMode): AppModeChangedAction{\n  return {\n    type: ActionKeys.AppModeChanged,\n    mode: mode\n  }\n}\n\nexport function toggleWidgetHighlight(widgetId: string, isHighlight: boolean): ToggleWidgetHighlightAction{\n  return {\n    type: ActionKeys.ToggleWidgetHighLight,\n    widgetId: widgetId,\n    isHighlight: isHighlight\n  }\n}\n\nexport function layoutClassLoaded(layoutName): LayoutClassLoadedAction{\n  return {\n    type: ActionKeys.LayoutClassLoaded,\n    layoutName: layoutName\n  };\n}\n\nexport function dataSourceStatusChanged(dataSourceId: string, status: DataSourceStatus): DataSourceStatusChangeAction{\n  return {\n    type: ActionKeys.DataSourceStatusChanged,\n    dataSourceId: dataSourceId,\n    status: status\n  };\n}\n\nexport function initStoreExtensionState(): InitStoreExtensionState{\n  return {\n    type: ActionKeys.InitStoreExtensionState\n  };\n}\n\nexport function widgetStatePropChange(widgetId: string, propKey: string, value: any): WidgetStatePropChangeAction{\n  return {\n    type: ActionKeys.WidgetStatePropChange,\n    widgetId: widgetId,\n    propKey: propKey,\n    value: value\n  };\n}\nexport function initPortalUrl(portalUrl: string): InitPortalUrlAction{\n  return {\n    type: ActionKeys.InitPortalUrl,\n    portalUrl: portalUrl\n  };\n}\n\nexport function dataSourceCurrentIndexesChanged(dataSourceId: string, indexes: number[]): DataSourceCurrentIndexesChangeAction{\n  return {\n    type: ActionKeys.DataSourceCurrentIndexesChanged,\n    dataSourceId: dataSourceId,\n    currentIndexes: indexes\n  };\n}\n\nexport function sessionStart(token: string): SessionStartAction{\n  return {\n    type: ActionKeys.SessionStart,\n    token\n  };\n}\n\nexport function userSignIn(user: IUser): UserSignInAction{\n  return {\n    type: ActionKeys.UserSignIn,\n    user\n  };\n}\n\nexport function userSignOut(): UserSignOutAction{\n  return {\n    type: ActionKeys.UserSignOut\n  };\n}\n\nexport function isMobileChanged(isMobile: boolean): IsMobileChangedAction{\n  return {\n    type: ActionKeys.IsMobileChanged,\n    isMobile: isMobile\n  };\n}\n\nexport function setWidgetIsSettingState(widgetId: string, isSetting: boolean): SetWidgetIsSettingStateAction{\n  return {\n    type: ActionKeys.SetWidgetIsSettingState,\n    widgetId: widgetId,\n    isSetting: isSetting\n  };\n}","import rootReducer from './app-reducer';\nimport { createStore, Store, applyMiddleware } from 'redux';\nimport {IMState} from './types/state';\n\nexport const store: Store<IMState> = createStore(\n  rootReducer, \n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__(),\n  // applyMiddleware(logger)\n);\n","import {AppConfig} from '../types/app-config';\nimport {WidgetProps} from '../types/props';\nimport {IMWidgetJson, IMDataSourceJson} from '../types/app-config';\nimport {IMState} from '../types/state';\nimport {DataSource} from '../data-source/base-types';\n\nexport enum ExtensionPoints{\n  /**\n   * The extension for this EP will be invoked after app config is loaded.\n   * Pass in the loaded app config into this extension and this extension should return the processed app config\n   * \n   * Extension for this EP should implement IAppConfigProcessorExtension interface.\n   */\n  AppConfigProcessor = 'APP_CONFIG_PROCESSOR',\n\n  /**\n   * The extension for this EP will be invoked after widget class is loaded and core props have been injected.\n   * \n   * Extension for this EP should implement IWidgetClassWrapperExtension interface.\n   */\n  WidgetClassWrapper = 'WIDGET_CLASS_WRAPPER',\n\n  /**\n   * The extension for this EP is used to get the config service, which is used to save/load app config.\n   * \n   * Extension for this EP should implement IAppConfigServiceExtension interface.\n   */\n  AppConfigService = 'APP_CONFIG_SERVICE',\n\n  /**\n   * The extension for this EP is used to extent the redux store.\n   * \n   * Extension for this EP should implement IReduxStoreExtension interface.\n   */\n  ReduxStore = 'REDUX_STORE',\n\n  /**\n   * The extension for this EP is used to define dependency.\n   * \n   * Extension for this EP should implement IDependencyDefine interface.\n   */\n  DependencyDefine = 'DEPENDENCY_DEFINE',\n\n\n  DataSourceFactory = 'DATA_SOURCE_FACTORY',\n}\n\nexport const EP_SUPPORT_MULTIPLE_EXTENTIONS = [ExtensionPoints.ReduxStore, ExtensionPoints.DataSourceFactory];\n\nexport interface BaseExtension{\n  //if extension point supports multiple extension, the index is used to determine\n  //the extension order.\n  index?: number;\n\n  //unique\n  id: string;\n\n  name?: string;\n\n  widgetId?: string;\n}\n\n//for type\nexport class DummyExtension implements BaseExtension{\n  index?: number;\n  id: string;\n  name?: string;\n  widgetId?: string;\n}\n\nexport interface AppConfigProcessorExtension extends BaseExtension{\n  process: (appConfig: AppConfig) => Promise<AppConfig>;\n}\n\n\nexport interface WidgetClassWrapperExtension extends BaseExtension{\n  wrap: (WidgetClass: React.ComponentClass<WidgetProps>, widgetJson: IMWidgetJson, nls: any) => React.ComponentClass<WidgetProps>;\n}\n\nexport interface AppConfigServiceExtension extends BaseExtension{\n  loadAppConfig: () => Promise<AppConfig>;\n}\n\nexport interface ReduxStoreExtension extends BaseExtension{\n\n  getActions: () => string[];\n\n  //the key supports this format: a.b.c\n  getStoreKey: () => string;\n\n  getInitLocalState: () => any;\n\n  getReducer: () => (localState, action, state: IMState) => any;\n}\n\nexport interface DependencyDefine extends BaseExtension{\n  getDependencyKey: () => string;\n\n  getResources: () => string[];\n}\n\nexport interface DataSourceFactory extends BaseExtension{\n  getSupportDataSourceTypes: () => string[];\n\n  createDataSource: (dsConfig: IMDataSourceJson) => DataSource;\n}","export enum AjaxState{\n  Fetching = 'FETCHING',\n  Success = 'SUCCESS',\n  Error = 'ERROR',\n}\n\nexport enum AppMode{\n  //these 3 are modes in builder\n  Config = 'CONFIG',\n  Design = 'DESIGN',\n  Preview = 'PREVIEW',\n\n  //this is normal run mode\n  Run = 'RUN'\n}","import * as React from 'react';\nimport {connect} from 'react-redux';\nimport isDeepEqual = require('fast-deep-equal');\n\nimport {logShallowDiff} from './utils/utils';\nimport {getAllWidgets} from './utils/app-config';\nimport {AppConfig, IMWidgetJson, IMAppConfig} from './types/app-config';\nimport {ExtensionProperties} from './types/manifest';\nimport {IMState} from './types/state';\n// import {store} from './store';\nimport * as actions from './app-actions';\nimport {amdRequire} from './amd-loader';\nimport {BaseExtension, EP_SUPPORT_MULTIPLE_EXTENTIONS, ExtensionPoints, DummyExtension} from './extension-spec/extension-spec'\nimport { extname } from 'path';\n\ninterface ExtensionInfo{\n  epName: ExtensionPoints;\n  extension: BaseExtension;\n}\n\nexport default class ExtensionManager{\n\n  static instance: ExtensionManager;\n\n  static getInstance(){\n    if(!ExtensionManager.instance){\n      ExtensionManager.instance = new ExtensionManager();\n      window._extensionManager = ExtensionManager.instance;\n    }\n    \n    return ExtensionManager.instance;\n  }\n\n  constructor(){\n    // store.subscribe(this.onStoreChange.bind(this));\n  }\n\n  private appConfig: AppConfig;\n  \n  private extensions: {\n    [epName: string]: BaseExtension[]\n  } = {};\n  private extensionClasses: {[extName: string]: typeof DummyExtension} = {};\n\n  getExtensions(epName: string): BaseExtension[]{\n    return this.extensions[epName] || [];\n  }\n\n  onStoreChange(){\n    // if(this.appConfig === store.getState().appConfig){\n    //   return;\n    // }\n\n    // this.appConfig = store.getState().appConfig;\n    // this.clean();\n    // this.loadExtensions(this.appConfig);\n  }\n\n  registerExtension(extInfo: ExtensionInfo){\n    if(this.getExtensionById(extInfo.extension.id)){\n      console.log(`Extension ${extInfo.extension.id} has been registered.`);\n      return;\n    }\n    if(this.extensions[extInfo.epName]){\n      if(EP_SUPPORT_MULTIPLE_EXTENTIONS.indexOf(extInfo.epName) > -1){\n        this.extensions[extInfo.epName].push(extInfo.extension);\n\n        this.extensions[extInfo.epName] = this.extensions[extInfo.epName].sort((a, b) => {\n          return a.index - b.index;\n        });\n      }\n      return;\n    }\n\n    this.extensions[extInfo.epName] = [extInfo.extension];\n  }\n\n  registerAllWidgetExtensions(appConfig: AppConfig): Promise<void[]>{\n    let extPromises = [];\n    getAllWidgets(appConfig as IMAppConfig).forEach(w => {\n      extPromises.push(this.registerWidgetExtensions(w));\n    });\n\n    return Promise.all(extPromises);\n  }\n\n  clean(){\n    this.extensions = {};\n  }\n\n  registerWidgetExtensions(widgetJson: IMWidgetJson): Promise<void[]>{\n    let extPromises = [];\n    if(widgetJson.manifest.extentions){\n      widgetJson.manifest.extentions.forEach(ext => {\n        extPromises.push(this.registerWidgetExtension(widgetJson, ext));\n      });\n    }\n    return Promise.all(extPromises);\n  }\n\n  registerWidgetExtension(widgetJson: IMWidgetJson, extensionProps: ExtensionProperties): Promise<void>{\n    if(this.extensions[extensionProps.point]){\n      if(EP_SUPPORT_MULTIPLE_EXTENTIONS[extensionProps.point]){\n        if(this.extensions[extensionProps.point].filter(ext => ext.name === extensionProps.name && ext.widgetId === widgetJson.id).length > 0){\n          return Promise.resolve();\n        }\n      }else{\n        return Promise.resolve();\n      }\n    }\n    \n    return this.loadWidgetExtensionClass(widgetJson, extensionProps).then((ExtClass: typeof DummyExtension) => {\n      let ext: BaseExtension = new ExtClass();\n\n      this.registerExtension({\n        epName: extensionProps.point as ExtensionPoints,\n        extension: ext\n      });\n\n      return;\n    });    \n  }\n\n  loadWidgetExtensionClass(widgetJson: IMWidgetJson, extensionProps: ExtensionProperties): Promise<typeof DummyExtension>{\n    //to avoid ext name conflict in widget\n    let extName = `${widgetJson.manifest.name}-${extensionProps.name}`;\n    if(this.extensionClasses[extName]){\n      return Promise.resolve(this.extensionClasses[extName])\n    }\n    var uri = widgetJson.context.amdFolder + 'dist/' + extensionProps.uri;\n    return amdRequire(uri).then(ExtensionClass => {\n      return ExtensionClass.default;\n    });\n  }\n\n  getExtensionById(extId: string): BaseExtension{\n    for(let i in this.extensions){\n      let ext = this.extensions[i].filter(ext => ext.id === extId)[0];\n      return ext;\n    }\n  }\n}\n\n","import { LayoutInfo, OrderAdjustType } from \"../types\";\n\nexport enum GlobalLayoutActions {\n  ADD_LAYOUT = 'GLOBAL_ADD_LAYOUT',\n  REMOVE_LAYOUT = 'GLOBAL_REMOVE_LAYOUT',\n  UPDATE_LAYOUT = 'GLOBAL_UPDATE_LAYOUT',\n  RESIZE_LAYOUTS = 'GLOBAL_RESIZE_LAYOUTS',\n  DRAG_DROP_LAYOUT = 'GLOBAL_DRAG_DROP_LAYOUT',\n  ADD_WIDGET = 'GLOBAL_ADD_WIDGET',\n  REMOVE_WIDGET = 'GLOBAL_REMOVE_WIDGET',\n  ACTIVATE = 'GLOBAL_ACTIVATE',\n  UPDATE_SETTING = 'GLOBAL_UPDATE_SETTING',\n  ADD_SECTION = 'GLOBAL_ADD_SECTION',\n  REMOVE_SECTION = 'GLOBAL_REMOVE_SECTION',\n  CHANGE_ORDER = 'GLOBAL_CHANGE_ORDER'\n};\n\nexport function updateLayout(layoutInfo, pos?, newSetting?) {\n  return {\n    type: GlobalLayoutActions.UPDATE_LAYOUT,\n    layoutInfo,\n    pos,\n    newSetting\n  }\n}\n\nexport function updateSetting(layoutInfo, newSetting) {\n  return {\n    type: GlobalLayoutActions.UPDATE_SETTING,\n    layoutInfo,\n    newSetting\n  }\n}\n\nexport function addLayout(layoutId, parentId, initPosition, layoutType?) {\n  return {\n    type: GlobalLayoutActions.ADD_LAYOUT,\n    layoutId,\n    parentId,\n    initPosition,\n    layoutType\n  };\n}\n\nexport function removeLayout(layoutInfo) {\n  return {\n    type: GlobalLayoutActions.REMOVE_LAYOUT,\n    layoutInfo\n  };\n}\n\nexport function resizeLayouts(layouts, breakpoint?) {\n  return {\n    type: GlobalLayoutActions.RESIZE_LAYOUTS,\n    layouts,\n    breakpoint\n  };\n}\n\nexport function dndLayout(layoutInfo, parentLayoutInfo, newPosition) {\n  return {\n    type: GlobalLayoutActions.DRAG_DROP_LAYOUT,\n    layoutInfo,\n    parentLayoutInfo,\n    newPosition\n  };\n}\n\nexport function activate(layoutInfo) {\n  return {\n    type: GlobalLayoutActions.ACTIVATE,\n    layoutInfo\n  };\n}\n\nexport function removeWidget(widgetId: string) {\n  return {\n    type: GlobalLayoutActions.REMOVE_WIDGET,\n    widgetId\n  };\n}\n\nexport function addWidget(widgetId, layoutInfo?: LayoutInfo) {\n  return {\n    type: GlobalLayoutActions.ADD_WIDGET,\n    widgetId,\n    layoutInfo\n  };\n}\n\nexport function addSection(sectionId, layoutInfo?: LayoutInfo) {\n  return {\n    type: GlobalLayoutActions.ADD_SECTION,\n    sectionId,\n    layoutInfo\n  };\n}\n\nexport function removeSection(sectionId: string) {\n  return {\n    type: GlobalLayoutActions.REMOVE_SECTION,\n    sectionId\n  };\n}\n\nexport function changeOrder(layoutInfo: LayoutInfo, orderType: OrderAdjustType) {\n  return {\n    type: GlobalLayoutActions.CHANGE_ORDER,\n    layoutInfo,\n    orderType\n  };\n}\n","import {WidgetContext, IMAppConfig, IMPageJson, IMWidgetJson, IMViewJson, IMSectionJson, ContainerType, AppConfigDiff, WidgetJson} from '../types/app-config';\nimport { LOADIPHLPAPI } from 'dns';\n\nexport function getWidgetContext(uri: string): WidgetContext {\n  let info = {} as WidgetContext;\n  info.amdFolder = uri;\n  if(!/\\/$/.test(info.amdFolder)){\n    info.amdFolder += '/';\n  }\n  info.folderUrl = window.amdRequire.toUrl(info.amdFolder);\n\n  if(/^http(s)?:\\/\\//.test(uri) || /^\\/\\//.test(uri)){\n    info.isRemote = true;\n  }else{\n    info.isRemote = false;\n  }\n\n  return info;\n}\n\n\nexport function addThemeManifestProperies(manifest) {\n  manifest.panels.forEach(function(panel) {\n    panel.uri = 'panels/' + panel.name + '/Panel.js';\n  });\n\n  manifest.styles.forEach(function(style) {\n    style.uri = 'styles/' + style.name + '/style.css';\n  });\n\n  manifest.layouts.forEach(function(layout) {\n    layout.uri = 'layouts/' + layout.name + '/config.json';\n    layout.icon = 'layouts/' + layout.name + '/icon.png';\n    layout.RTLIcon = 'layouts/' + layout.name + '/icon_rtl.png';\n  });\n}\n\nexport function addWidgetManifestProperties(manifest) {\n  if (typeof manifest.properties === 'undefined') {\n    manifest.properties = {};\n  }\n\n  var defaultFalseProperties = ['isController', 'hasVersionManager', 'isDojoWidget'];\n  defaultFalseProperties.forEach(function(p) {\n    if (typeof manifest.properties[p] === 'undefined') {\n      manifest.properties[p] = false;\n    }\n  });\n\n  var defaultTrueProperties = ['inPanel', 'hasMainClass', 'hasLocale', 'hasConfig', 'hasSettingPage',\n  'hasSettingLocale', 'keepConfigAfterMapSwitched', 'isController', 'hasVersionManager',\n  'supportMultiInstance'];\n\n  defaultTrueProperties.forEach(function(p) {\n    if (typeof manifest.properties[p] === 'undefined') {\n      manifest.properties[p] = true;\n    }\n  });\n}\n\nexport function addWidgetDefaultLabelAndIcon(widgetJson: WidgetJson){\n  widgetJson.icon = widgetJson.icon? widgetJson.icon:\n    widgetJson.context.folderUrl + 'dist/runtime/assets/icon.svg';\n        \n  widgetJson.label = widgetJson.label? widgetJson.label: widgetJson.manifest.name;\n}\n\nexport function getAllWidgets(appConfig: IMAppConfig): IMWidgetJson[]{\n  let widgets = [];\n\n  Object.keys(appConfig.widgets).forEach(wId => {\n    widgets.push(appConfig.widgets[wId]);\n  });\n\n  return widgets;\n}\n\nexport function getWidgetsByName(appConfig: IMAppConfig, widgetName: string): IMWidgetJson[]{\n  let widgets = [];\n\n  Object.keys(appConfig.widgets).forEach(wId => {\n    if(appConfig.widgets[wId].manifest.name === widgetName){\n      widgets.push(appConfig.widgets[wId]);\n    }\n  });\n\n  return widgets;\n}\n\nexport function getCleanAppConfig(appConfig: IMAppConfig): any{\n  let config = appConfig.asMutable({deep: true});\n  Object.keys(config.widgets).forEach(wid => {\n    let w = config.widgets[wid];\n    delete w.context;\n    delete w.manifest;\n  });\n  return config;\n}\n\ninterface ContainerInfo{\n  containerType: ContainerType,\n  containerId: string;\n}\n\nexport function getContainerInfoByLayoutId(appConfig: IMAppConfig, layoutId: string): ContainerInfo{\n  let info: ContainerInfo;\n  Object.keys(ContainerType).some(cType => {\n    Object.keys(appConfig[ContainerType[cType]]).some(cId => {\n      if(appConfig[ContainerType[cType]][cId].layout === layoutId){\n        info = {\n          containerType: ContainerType[cType],\n          containerId: cId\n        };\n        return true;\n      }\n    })\n    if(info) return true;\n  });\n\n  return info;\n}\n\nexport function getWidgetContainerInfo(appConfig: IMAppConfig, widgetId: string): ContainerInfo{\n  if(!appConfig.widgets || !appConfig.widgets[widgetId]){\n    return;\n  }\n\n  let info: ContainerInfo;\n  Object.keys(ContainerType).some(cType => {\n    let containerId = getWidgetContainerIdByContainerType(appConfig, widgetId, ContainerType[cType]);\n    if(containerId){\n      info = {\n        containerType: ContainerType[cType],\n        containerId: containerId\n      };\n      return true;\n    }\n  });\n\n  return info;\n}\n\nfunction getWidgetContainerIdByContainerType(appConfig: IMAppConfig, widgetId: string, containerType: ContainerType): string{\n  let containerId;\n  if(!appConfig[containerType]){\n    return;\n  }\n  Object.keys(appConfig[containerType]).some(cId => {\n    let ctn = appConfig[containerType][cId];\n    if(ctn.widgets && ctn.widgets.indexOf(widgetId) > -1){\n      containerId = cId;\n      return containerId;\n    }\n  });\n  if(containerId){\n    return containerId;\n  }\n}\n\nexport function getSectionContainerInfo(appConfig: IMAppConfig, sectionId: string): ContainerInfo{\n  if(!appConfig.sections || !appConfig.sections[sectionId]){\n    return;\n  }\n\n  let info: ContainerInfo;\n  Object.keys(ContainerType).some(cType => {\n    let containerId = getSectionContainerIdByContainerType(appConfig, sectionId, ContainerType[cType]);\n    if(containerId){\n      info = {\n        containerType: ContainerType[cType],\n        containerId: containerId\n      };\n      return true;\n    }\n  });\n\n  return info;\n}\n\nfunction getSectionContainerIdByContainerType(appConfig: IMAppConfig, sectionId: string, containerType: ContainerType): string{\n  let containerId;\n  if(!appConfig[containerType]){\n    return;\n  }\n  Object.keys(appConfig[containerType]).some(cId => {\n    let ctn = appConfig[containerType][cId];\n    if(ctn.sections && ctn.sections.indexOf(sectionId) > -1){\n      containerId = cId;\n      return containerId;\n    }\n  });\n  if(containerId){\n    return containerId;\n  }\n}\n\n/**\n * we use <type_number> format to generate key.\n * @param type: \n */\nexport function getUniqueId(appConfig: IMAppConfig, type: 'page' | 'view' | 'section' | 'widget' | 'layout'): string{\n  let max = 0;\n  if(!appConfig[`${type}s`]){\n    return `${type}_${max + 1}`;\n  }\n  Object.keys(appConfig[`${type}s`]).forEach(k => {\n    let i = k.substring(`${type}_`.length, k.length);\n    if(/^\\d+$/.test(i)){\n      max = Math.max(max, parseInt(i));\n    }\n  });\n\n  let newId = `${type}_${max + 1}`;\n  \n  return newId;\n}\n\n/**\n * we use <type number> format to generate key.\n * @param type: \n */\nexport function getUniqueLabel(appConfig: IMAppConfig, type: 'page' | 'view' | 'section' | 'widget'): string{\n  let max = 0;\n  if(!appConfig[`${type}s`]){\n    return `${type} ${max + 1}`;\n  }\n  Object.keys(appConfig[`${type}s`]).forEach(k => {\n    let label = appConfig[`${type}s`][k].label;\n    let i = label.substring(`${type} `.length, label.length);\n    if(/^\\d+$/.test(i)){\n      max = Math.max(max, parseInt(i));\n    }\n  });\n\n  let newLabel = `${type} ${max + 1}`;\n  \n  return newLabel;\n}\n\n\n\n/**\n * App config is updated in builder, jimu will render the app depends on app config.\n * However, there are some caches need to be cleaned if something(widget, data source) is removed/updated, so we need to diff \n * the app config to get what are removed/updated. I think we don't need care the new add thing.\n * \n * Why we don't pass the app config change action into app? Because to support undo/redo, it's hard to to this, so we use diff, but we'll diff the changes we care only.\n * \n * @param oldConfig \n * @param newConfig \n */\nexport function getAppConfigDiff(oldConfig: IMAppConfig, newConfig: IMAppConfig): AppConfigDiff{\n  let diff: AppConfigDiff = {\n    removedWidgets: []\n  };\n\n  if(oldConfig.widgets === newConfig.widgets){\n    return diff;\n  }\n\n  Object.keys(oldConfig.widgets).forEach(oldWId => {\n    if(!newConfig.widgets[oldWId]){\n      diff.removedWidgets.push(oldWId);\n    }\n  });\n\n  return diff;\n}\n","import * as React from 'react';\nimport {LayoutActionContext} from './types';\n\nconst emptyFunc = () => {};\n\nexport const ActionContext: React.Context<LayoutActionContext> = React.createContext({\n  updateSetting: emptyFunc,\n  addLayout: emptyFunc,\n  removeLayout: emptyFunc,\n  resizeLayouts: emptyFunc,\n  dndLayout: emptyFunc,\n  activate: emptyFunc,\n  removeWidget: emptyFunc\n});","import { CommonLayoutSetting } from './types';\n\nexport const DEFAULT_LAYOUT_SETTING: CommonLayoutSetting = {\n  active: false,\n  static: false,\n  restrict: false,\n  draggable: true,\n  resizable: true,\n  droppable: true,\n  xyInPixel: true, // fixed position\n  widthInPixel: true,\n  heightInPixel: true,\n  className: ''\n};","import isDeepEqual = require('fast-deep-equal');\nimport { UrlParameters } from '../types/url-parameters';\nimport { DataSourceInfo } from '../types/state';\nimport { Size } from '../types/common';\n\nexport function logShallowDiff(name, obj, preObj){\n  let hasDiff = false;\n  for(let p in obj){\n    if(obj[p] !== preObj[p]){\n      hasDiff = true;\n    }\n  }\n\n  if(!hasDiff){\n    console.group(name, 'no diff.');\n    console.groupEnd();\n    return;\n  }\n  console.group(name);\n  for(let p in obj){\n    if(obj[p] !== preObj[p]){\n      console.log(p, {\n        pre: preObj[p],\n        cur: obj[p],\n        isEqual: isDeepEqual(obj[p], preObj[p])\n      });\n    }\n  }\n  console.groupEnd();\n}\n\n\ntype WidgetPanelCallBack = 'onOpen' | 'onClose' | 'onActive' | 'onDeActive';\n\nexport function getWidgetCallbackNamesFromWidgetState(widgetState, prevWidgetState): WidgetPanelCallBack[] | WidgetPanelCallBack {\n  return getCallbackNames(widgetState, prevWidgetState);\n}\n\nexport function getPanelCallbackNamesFromPanelState(panelState, prevPanelState): WidgetPanelCallBack[] | WidgetPanelCallBack {\n  return getCallbackNames(panelState, prevPanelState);\n}\n\nexport function isMobileBrowser(){\n  return false;\n}\n\nexport function isMobileSize(size: Size){\n  if(size.width < 600){\n    return true;\n  }\n\n  return false;\n}\n\nfunction getCallbackNames(state, prevState): WidgetPanelCallBack[] | WidgetPanelCallBack {\n  switch(state){\n    case 'opened':\n      switch(prevState){\n        case 'opened':\n          return null;\n        case 'closed':\n          return 'onOpen';\n        case 'active':\n          return 'onDeActive';\n      }\n    case 'closed':\n      switch(prevState){\n        case 'opened':\n          return 'onClose';\n        case 'closed':\n          return null;\n        case 'active':\n          return ['onDeActive', 'onClose'];\n      }\n    case 'active':\n      switch(prevState){\n        case 'opened':\n          return 'onDeActive';\n        case 'closed':\n          return ['onOpen', 'onActive'];\n        case 'active':\n          return null;\n      }\n  }\n}\n\nexport function loadstyle(url: string, beforeId?: string) {\n  return new Promise(resolve => {\n    let containerNode: HTMLElement;\n    if (beforeId) {\n      containerNode = document.getElementById(beforeId);\n    } else {\n      containerNode = document.getElementsByTagName(\"head\")[0];\n    }\n\n    let onLoad = () => {\n      resolve()\n    };\n\n    var cssNode: HTMLStyleElement = document.createElement(\"link\");\n    cssNode.setAttribute(\"rel\", \"stylesheet\");\n    cssNode.setAttribute(\"type\", \"text/css\");\n    cssNode.setAttribute(\"href\", url);\n    cssNode.onload = onLoad;\n\n    containerNode.appendChild(cssNode);\n  });\n  \n}\n\nexport function applyMixins(derivedCtor: any, baseCtors: any[]) {\n  baseCtors.forEach(baseCtor => {\n      Object.getOwnPropertyNames(baseCtor.prototype).forEach(name => {\n          derivedCtor.prototype[name] = baseCtor.prototype[name];\n      });\n  });\n}\n\nexport function getDataSourceInfosFromQueryObject(queryObject: UrlParameters): {[dsId: string]: number}{\n  let dsInfo = {};\n  if(queryObject.data){\n    let dss = queryObject.data.split(',');\n    dss.forEach(ds => {\n      let dsId = ds.split(':')[0];\n      let i = parseInt(ds.split(':')[1]);\n      dsInfo[dsId] = i;\n    });\n  }\n  return dsInfo;\n}","\nexport function amdRequire(moduleId: string|string[]): Promise<any>{\n  return new Promise(resolve => {\n    window.amdRequire(typeof moduleId === 'string'? [moduleId]: moduleId, moduleObj => {\n      resolve(moduleObj);\n    });\n  });\n}","import * as React from 'react';\nimport classNames = require(\"classnames\");\nimport hoistNonReactStatic = require('hoist-non-react-statics');\nimport Resizable, {ResizeEnable, ResizableDelta, Position} from 'react-rnd';\nimport { isActiveLayout } from './utils';\nimport { LayoutProps } from './types';\nimport './style/handle.scss';\n\nexport interface ResizeHandlers {\n  onResizeStart?: (id: string) => void;\n  onResizing?: (id: string, dx: number, dy: number, width: number, height: number) => void;\n  onResizeEnd?: (id: string, dx: number, dy: number, width: number, height: number) => void;\n  top?: boolean;\n  left?: boolean;\n  right?: boolean;\n  bottom?: boolean;\n  disableInteract?: boolean;\n  minWidth?: number;\n  maxWidth?: number;\n  minHeight?: number;\n  maxHeight?: number;\n  resizeGrid?: [number, number]\n}\n\ninterface ResizableState {\n  deltaSize: ResizableDelta,\n  deltaPos: Position,\n  isResizing: boolean\n}\n\nexport type ResizableProps = LayoutProps & ResizeHandlers;\n\nfunction getDisplayName(WrappedComponent) {\n  return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n}\n\nexport default function resizable(injectProps?) {\n  return (WrapperComponent: React.ComponentType<LayoutProps>) => {\n    class ResizableComponent extends React.PureComponent<ResizableProps, ResizableState> {\n      static displayName = `resizable(${getDisplayName(WrapperComponent)})`;\n\n      state = {\n        deltaSize: {width: 0, height: 0},\n        deltaPos: {x: 0, y: 0},\n        isResizing: false\n      }\n\n      _enableResizing(): ResizeEnable {\n        const {left, right, top, bottom, disableInteract} = this.props;\n        return {\n          top: disableInteract !== true && top !== false,\n          right: disableInteract !== true && right !== false,\n          bottom: disableInteract !== true && bottom !== false,\n          left: disableInteract !== true && left !== false,\n          topRight: disableInteract !== true && top !== false && right !== false,\n          bottomRight: disableInteract !== true && bottom !== false && right !== false,\n          bottomLeft: disableInteract !== true && bottom !== false && left !== false,\n          topLeft: disableInteract !== true && top !== false && left !== false\n        };\n      }\n\n      _onResizeStop(e: MouseEvent | TouchEvent,\n      dir,\n      refToElement,\n      delta: ResizableDelta,\n      position: Position) {\n        e.preventDefault();\n        e.stopPropagation();\n        const { layout, onResizeEnd } = this.props;\n        if (onResizeEnd) {\n          onResizeEnd(layout.id, position.x,\n          position.y, delta.width, delta.height);\n        }\n        this.setState({\n          deltaSize: {width: 0, height: 0},\n          deltaPos: {x: 0, y: 0},\n          isResizing: false\n        });\n      }\n\n      _onResize(e: MouseEvent | TouchEvent,\n        dir,\n        refToElement,\n        delta: ResizableDelta,\n        position: Position) {\n        e.preventDefault();\n        e.stopPropagation();\n        const { layout, onResizing } = this.props;\n        if (onResizing) {\n          onResizing(layout.id, position.x,\n            position.y, delta.width, delta.height);\n        }\n        this.setState({\n          isResizing: true,\n          deltaSize: delta,\n          deltaPos: position\n        });\n      }\n\n      _onResizeStart(e: React.SyntheticEvent<HTMLDivElement>) {\n        e.preventDefault();\n        e.stopPropagation();\n        const { layout, onResizeStart } = this.props;\n        if (onResizeStart) {\n          onResizeStart(layout.id);\n        }\n      }\n\n      render() {\n        const { pos, className, minHeight, minWidth, maxHeight, maxWidth, resizeGrid, appMode,\n          disableInteract, ...passThroughProps } = this.props;\n        const { deltaSize, deltaPos, isResizing } = this.state;\n\n        const displayPos = {\n          x: 0,\n          y: 0,\n          w: pos.w + deltaSize.width,\n          h: pos.h + deltaSize.height\n        };\n\n        const enableResizing = this._enableResizing();\n        const actions = this._actionHandlers(enableResizing);\n        const isActive = isActiveLayout(this.props.layout) && disableInteract !== true;\n        const mergedClass = classNames('exb-resizable', className, {\n          active: isActive\n        });\n\n        return (\n          <Resizable disableDragging={true}\n          className={mergedClass}\n          enableResizing={enableResizing}\n          minHeight={minHeight || 10}\n          minWidth={minWidth || 10}\n          maxHeight={maxHeight}\n          maxWidth={maxWidth}\n          resizeGrid={resizeGrid || [1, 1]}\n          position={{x: isResizing ? deltaPos.x : pos.x, y: isResizing ? deltaPos.y : pos.y}}\n          size={{width: displayPos.w, height: displayPos.h}}\n          onResizeStart={this._onResizeStart.bind(this)}\n          onResize={this._onResize.bind(this)}\n          onResizeStop={this._onResizeStop.bind(this)}>\n            <WrapperComponent pos={displayPos} appMode={appMode} disableInteract={disableInteract} {...injectProps} {...passThroughProps}/>\n            { isActive && actions}\n          </Resizable>\n        );\n      }\n\n      _getLayoutId() {\n        return this.props.layout ? this.props.layout.id : '';\n      }\n\n      _actionHandlers(enableResizing: ResizeEnable) {\n        let handlers = [];\n\n        if (enableResizing.top) {\n          handlers.push(\n            <span key=\"2\" className=\"handle handle-resize top-resize-cursor handle-resize-side top\"></span>\n          );\n        }\n        if (enableResizing.right) {\n          handlers.push(\n            <span key=\"4\" className=\"handle handle-resize right-resize-cursor handle-resize-side right\"></span>\n          );\n        }\n        if (enableResizing.bottom) {\n          handlers.push(\n            <span key=\"6\" className=\"handle handle-resize bottom-resize-cursor handle-resize-side bottom\"></span>\n          );\n        }\n        if (enableResizing.left) {\n          handlers.push(\n            <span key=\"8\" className=\"handle handle-resize left-resize-cursor handle-resize-side left\"></span>\n          );\n        }\n        if (enableResizing.topLeft) {\n          handlers.push(\n            <span key=\"1\" className=\"handle handle-resize top-left-resize-cursor handle-resize-corner top left\"></span>\n          );\n        }\n        if (enableResizing.topRight) {\n          handlers.push(\n            <span key=\"3\" className=\"handle handle-resize top-right-resize-cursor handle-resize-corner top right\"></span>\n          );\n        }\n        if (enableResizing.bottomRight) {\n          handlers.push(\n            <span key=\"5\" className=\"handle handle-resize bottom-right-resize-cursor handle-resize-corner bottom right\"></span>\n          );\n        }\n        if (enableResizing.bottomLeft) {\n          handlers.push(\n            <span key=\"7\" className=\"handle handle-resize bottom-left-resize-cursor handle-resize-corner bottom left\"></span>\n          );\n        }\n        return handlers;\n      }\n    }\n\n    hoistNonReactStatic(ResizableComponent, WrapperComponent);\n    return ResizableComponent;\n  };\n}","import { UserSession, ICredential } from '@esri/arcgis-rest-auth';\nimport { ArcGISAuthError } from '@esri/arcgis-rest-request';\nimport { sessionStart, userSignIn, userSignOut } from './app-actions';\nimport { store } from './store';\n\nexport default class SessionManager{\n\n  static instance: SessionManager;\n\n  private _session: UserSession;\n\n  private _retryPromise: Promise<{}>;\n\n  private _setSession(session: UserSession, localStorageKey = 'exb_session'){\n    // persist a reference to the fully hydrated session in this singleton\n    this._session = session;\n    // notify the rest of the app via the store that we are authenticated\n    store.dispatch(sessionStart(session.token));\n    // share the session w/ the builder through a local storage item\n    localStorage.setItem(localStorageKey, session.serialize());\n    // query the user's info\n    return this._session.getUser()\n    .then(user => {\n      // notify the rest of the app via the store that the user has signed in\n      store.dispatch(userSignIn(user));\n      return user;\n    });\n  }\n\n  private _clearSession(localStorageKey = 'exb_session') {\n    // clear the reference to the fully hydrated session in this singleton\n    delete this._session;\n    // notify the rest of the app via the store that the user has signed out\n    store.dispatch(userSignOut());\n    // remove local storage item\n    localStorage.removeItem(localStorageKey);\n  }\n\n  // singleton\n  static getInstance(){\n    if(!SessionManager.instance){\n      SessionManager.instance = new SessionManager();\n    }\n    \n    return SessionManager.instance;\n  }\n\n  constructor(){\n  }\n\n  // convenience function to expose the app's portal URL\n  getPortalUrl() {\n    return store.getState().portalUrl;\n  }\n\n  // get the currently logged in user's session - if any\n  getSession() {\n    // TODO: get this from redux store instead?\n    return this._session;\n  }\n\n  // rehydrate session from a serialized session saved in local storage\n  initFromLocalStorage(key = 'exb_session'){\n    const serializedSession = localStorage.getItem(key);\n    if(serializedSession){\n      // NOTE: fire and forget for now\n      this._setSession(UserSession.deserialize(serializedSession));\n    }\n  }\n\n  // rehydrate session from a cached credential\n  initFromCredential(credential: ICredential) {\n      // NOTE: fire and forget for now\n      this._setSession(UserSession.fromCredential(credential));\n  }\n\n  // start OAuth sign in flow and return the user session\n  signIn (/*url, originalRequestOptions */) {\n    // NOTE: we could use url and/or originalRequestOptions to set the portal, clientId, etc.\n    const oauth2Options = {\n      portal: this.getPortalUrl(),\n      // TODO: how to get client id from environment config\n      // NOTE: this was the clientId that was hard coded in config-manager\n      clientId: 'QQ6D3PZqPSV6y4SM',\n      redirectUri: window.location.origin + window.amdRequire.toUrl('jimu-core') + '/oauth-callback.html',\n      popup: true\n    };\n    return UserSession.beginOAuth2(oauth2Options)\n    .then(newSession => {\n      // hold on to the session for future requests\n      return this._setSession(newSession)\n    });\n  }\n\n  handleAuthError(error) {\n    const originalRequestOptions = error.options;\n    // if we got an auth error for an unauthenticated request, \n    // retry after getting a new session for this user\n    if(error instanceof ArcGISAuthError && !originalRequestOptions.authentication) {\n      if (!this._retryPromise) {\n        this._retryPromise = error.retry(this.signIn.bind(this));\n      }\n      return this._retryPromise;\n    }\n    // otherwise re-throw the error\n    throw error;\n  }\n\n signOut() {\n   this._clearSession();\n }\n}\n\n","import * as React from 'react';\nimport {createBrowserHistory, History, Action} from 'history';\nimport {queryObjectChanged} from './app-actions';\nimport {store} from './store';\nimport * as queryString from 'query-string';\nimport isEqual = require('lodash.isequal');\nimport {Location, parsePath, isAbsoluteUrl} from './utils/url-utils';\n\nexport const browserHistory = createBrowserHistory();\n\nconst unlisten = browserHistory.listen((location: Location, action: Action) => {\n  let storeQo = store.getState().queryObject.asMutable();\n  if(location.search){\n    let locationQo = queryString.parse(location.search);\n    if(!isEqual(storeQo, locationQo)){\n      store.dispatch(queryObjectChanged(locationQo));\n    }\n  }\n});\n\nconst HistoryContext = React.createContext(browserHistory);\nexport const HistoryProvider = (props) => {\n  return <HistoryContext.Provider value={browserHistory}>{props.children}</HistoryContext.Provider>\n};\n\nexport function withHistory<T extends React.ComponentClass>(Component: T): T {\n  return function HistoryComponent(props) {\n    return (\n      <HistoryContext.Consumer>\n        {history => <Component {...props} history={history} />}\n      </HistoryContext.Consumer>\n    );\n  } as any;\n}\n\n/**\n * \n * @param queryObject can be partial of query object\n */\nexport function changeQueryObject(queryObject, replace: boolean = false){\n  let qo = store.getState().queryObject.merge(queryObject);\n  let loc = createLocation(browserHistory.location, '?' + queryString.stringify(qo));\n  let href = browserHistory.createHref(loc);\n  if(replace){\n    browserHistory.replace(href);\n  }else{\n    browserHistory.push(href)\n  }\n}\n\nexport function changePage(pageId: string){\n  if(store.getState().queryObject.page === pageId){\n    return;\n  }\n  return changeQueryObject({\n    page: pageId\n  });\n}\n\nexport function changeView(sectionId: string, viewId: string){\n  let views = store.getState().queryObject.views? store.getState().queryObject.views.split(','): [];\n  if(views.indexOf(viewId) > -1){\n    return;\n  }else{\n    //remove all views in the section\n    views = views.filter(vId => store.getState().appConfig.sections[sectionId].views.indexOf(vId) < 0);\n    views.push(viewId);\n  }\n  return changeQueryObject({\n    views: views.join(',')\n  });\n}\n\nexport function createLocation (currentLocation: Location, to: string): Location{\n  let toLocation = parsePath(to);\n  if(isAbsoluteUrl(toLocation.pathname) || toLocation.pathname.charAt(0) === '/'){\n    return toLocation;\n  }\n\n  if(toLocation.pathname === ''){\n    toLocation.pathname = currentLocation.pathname;\n    return toLocation;\n  }\n\n  if(toLocation.pathname.charAt(0) === '.'){// means \"./\"\n    toLocation.pathname = currentLocation.pathname + '/' + toLocation.pathname.substr(2);\n    return toLocation;\n  }\n\n  toLocation.pathname = currentLocation.pathname + '/' + toLocation.pathname;\n  return toLocation;\n}\n\n\nexport {History, Location};","import * as React from 'react';\nimport {connect} from 'react-redux';\nimport isDeepEqual = require('fast-deep-equal');\n\nimport {addWidgetManifestProperties, getWidgetsByName, addWidgetDefaultLabelAndIcon, getWidgetContext} from './utils/app-config';\nimport {getWidgetCallbackNamesFromWidgetState} from './utils/utils';\nimport {logShallowDiff, loadstyle} from './utils/utils';\nimport {IMWidgetJson, WidgetJson, IMWidgetContext} from './types/app-config';\nimport {WidgetManifest} from './types/manifest';\nimport {IMState} from './types/state';\nimport {WidgetProps, WidgetInjectedProps, AllWidgetProps} from './types/props';\nimport {store} from './store';\nimport * as actions from './app-actions';\nimport I18NManager from './i18n-manager';\nimport ExtensionManager from './extension-manager';\nimport {amdRequire} from './amd-loader';\nimport {WidgetClassWrapperExtension, ExtensionPoints, DependencyDefine} from './extension-spec/extension-spec';\nimport {loadResources} from './resource-loader';\nimport BaseWidget from './base-widget';\nimport DataSourceManager from './data-source-manager';\nimport { DataSource } from '..';\nimport SessionManager from './session-manager';\n\ninterface WidgetRawClassInfo{\n  clazz: any;\n  nls: any\n}\nexport default class WidgetManager{\n\n  static instance: WidgetManager;\n  static getInstance(){\n    if(!WidgetManager.instance){\n      WidgetManager.instance = new WidgetManager();\n      window._widgetManager = WidgetManager.instance;\n    }\n    return WidgetManager.instance;\n  }\n\n  widgetRawClasses: {\n    [widgetName: string]: Promise<WidgetRawClassInfo>\n  } = {};\n\n  //Class here has been wrapped\n  widgetClasses: {\n    [widgetId: string]: React.ComponentClass<WidgetProps>\n  } = {};\n  \n  private dependencyResources:{[resourceUrl: string]: 'loading' | 'loaded'} = {};\n\n  getWidgetClass(widgetId: string): React.ComponentClass<WidgetProps>{\n    return this.widgetClasses[widgetId];\n  }\n\n  deleteWidgetClass(widgetId: string){\n    delete this.widgetClasses[widgetId];\n  }\n\n  loadWidgetClass(widgetId: string): Promise<React.ComponentClass<WidgetProps>>;\n  loadWidgetClass(widgetJson: IMWidgetJson): Promise<React.ComponentClass<WidgetProps>>;\n  loadWidgetClass(w): any{\n    let widgetJson: IMWidgetJson;\n    if(typeof w === 'string'){\n      widgetJson = store.getState().appConfig.widgets[w];\n    }else{\n      widgetJson = w;\n    }\n\n    let wrapWidgetClass = (_WidgetClass, nls) => {\n      var WidgetClass = _WidgetClass.default? _WidgetClass.default: _WidgetClass;\n\n      if(widgetJson.manifest.properties.isDojoWidget){\n        return this.appWidgetClassWrapperExtension(WidgetClass, widgetJson, nls);\n      }else{\n        let WidgetContextClass = this.injectWidgetProps(WidgetClass, nls, widgetJson);\n        return this.appWidgetClassWrapperExtension(WidgetContextClass, widgetJson, nls);\n      }\n    };\n    \n    return this.loadRawClass(widgetJson).then( classInfo => {\n      return wrapWidgetClass(classInfo.clazz, classInfo.nls);\n    }).then((widgetClass: React.ComponentClass<WidgetProps>) => {\n      this.widgetClasses[widgetJson.id] = widgetClass;\n      store.dispatch(actions.widgetClassLoaded(widgetJson.id));    \n      return widgetClass;\n    });\n  }\n\n  loadRawClass(widgetJson: IMWidgetJson): Promise<WidgetRawClassInfo>{\n    let widgetName = widgetJson.manifest.name;\n    if(this.widgetRawClasses[widgetName]){\n      return this.widgetRawClasses[widgetName];\n    }\n\n    this.widgetRawClasses[widgetName] = this.loadWidgetDependency(widgetJson).then(() => {\n      let uri = `${widgetJson.uri}/dist/runtime/widget`;\n      return amdRequire(uri);\n    }).then( WidgetClass => {\n      if(widgetJson.manifest.properties.hasLocale){\n        return this.loadWidgetNls(widgetJson).then(nls => {\n          return {\n            clazz: WidgetClass,\n            nls: nls\n          }\n        });\n      }else{\n        return {\n          clazz: WidgetClass,\n          nls: {}\n        };\n      }\n    })\n\n    return this.widgetRawClasses[widgetName];\n  }\n\n  appWidgetClassWrapperExtension(WidgetClass: React.ComponentClass<WidgetProps>, widgetJson: IMWidgetJson, nls: any): React.ComponentClass<WidgetProps>{\n    let extension = ExtensionManager.getInstance().getExtensions(ExtensionPoints.WidgetClassWrapper)[0];\n    if(!extension){\n      if(widgetJson.manifest.properties.isDojoWidget){\n        throw Error('Please write a WidgetClassWrapperExtension to support Dojo widget.');\n      }\n      return WidgetClass;\n    }\n\n    return (extension as WidgetClassWrapperExtension).wrap(WidgetClass, widgetJson, nls);;\n  }\n\n  handleNewWidgetJson(widgetJson: WidgetJson): Promise<WidgetJson>{\n    widgetJson.context = getWidgetContext(widgetJson.uri) as IMWidgetContext;\n\n    return WidgetManager.getInstance().loadWidgetManifest(widgetJson).then(manifest => {\n      widgetJson.manifest = manifest;\n\n      addWidgetDefaultLabelAndIcon(widgetJson);\n      return this.loadWidgetConfig(widgetJson);\n    }).then(widgetConfig => {\n      widgetJson.config = widgetConfig;\n\n      //TODO handle extension, action\n      return widgetJson;\n    });\n  }\n\n  loadWidgetManifest(widgetJson: WidgetJson): Promise<WidgetManifest>{\n    var url;\n    if(widgetJson.context.isRemote){\n      url = widgetJson.context.folderUrl + 'manifest.json?f=json';\n    }else{\n      url = widgetJson.context.folderUrl + 'manifest.json';\n    }\n\n    //json.manifest is added in configmanager if manifest is merged.\n    if(widgetJson.manifest){\n      return Promise.resolve(widgetJson.manifest);\n    }\n\n    return fetch(url).then(res => res.json()).then((res: any) => {\n      if(res.error && res.error.code){\n        //request manifest from AGOL item, and there is an error\n        //error code may be: 400, 403\n        return Promise.reject(res.error);\n      }\n\n      let manifest: WidgetManifest = res;\n\n      addWidgetManifestProperties(manifest);\n\n      if(!widgetJson.label){\n        if(manifest.properties.hasLocale){\n          return this.loadWidgetNls(widgetJson).then(widgetNls => {\n            manifest.i18nLabels = {[store.getState().appContext.locale]: widgetNls._widgetLabel};\n            return manifest;\n          });\n        }else{\n          return manifest;\n        }        \n      }else{\n        return manifest;\n      }\n    });\n  }\n\n  loadWidgetConfig(widgetJson: WidgetJson): Promise<any> {\n    return this.tryLoadWidgetConfig(widgetJson).then(widgetConfig => {\n      return this.upgradeWidgetConfig(widgetJson, widgetConfig).then(function(widgetConfig){\n        widgetJson.config = widgetConfig;\n        return widgetConfig;\n      });\n    });\n  }\n\n  upgradeWidgetConfig(widgetJson: WidgetJson, oldConfig): Promise<any>{\n      var widgetVersion = widgetJson.manifest.version;\n      var configVersion = widgetJson.version;\n      var newConfig;\n\n      if(widgetVersion === configVersion){\n        return Promise.resolve(oldConfig);\n      }\n\n      if(widgetJson.manifest.properties.hasVersionManager === false){\n        //if widget doesn't have version manager, we assume the widget\n        //is old version compatible\n\n        //widget config loaded from builder needs update version\n        widgetJson.version = widgetVersion;\n        return Promise.resolve(oldConfig);\n      }\n\n      return new Promise((resolve, reject) => {\n        window.amdRequire([widgetJson.context.amdFolder + 'VersionManager'], (VersionManager) => {\n          var versionManager = new VersionManager();\n\n          var configVersionIndex = versionManager.getVersionIndex(configVersion);\n          var widgetVersionIndex = versionManager.getVersionIndex(widgetVersion);\n          if(configVersionIndex > widgetVersionIndex){\n            reject('Bad widget version number, ' + widgetJson.manifest.name + ',' + configVersion);\n          }else{\n            try{\n              newConfig = versionManager.upgrade(oldConfig, configVersion, widgetVersion);\n              widgetJson.version = widgetVersion;\n              resolve(newConfig);\n            }catch(err){\n              console.log('Read widget [' + widgetJson.manifest.name + '] old config error,' + err.stack);\n              resolve(oldConfig);\n            }\n          }\n        });\n      });\n    }\n\n  tryLoadWidgetConfig(widgetJson: WidgetJson): Promise<any>{\n    if (widgetJson.config){\n      if(typeof widgetJson.config === 'object'){\n        return Promise.resolve(widgetJson.config);\n      }else {\n        return fetch(widgetJson.config).then(res => res.json()).then(widgetConfig => {\n          widgetJson.config = widgetConfig;\n          return widgetConfig;\n        });\n      };\n    } else {\n      if(widgetJson.manifest.properties.hasConfig){\n        return fetch(`${widgetJson.context.folderUrl}config.json`).then(res => res.json())\n        .then(widgetConfig => {\n          widgetJson.config = widgetConfig;\n          return widgetConfig;\n        });\n      }else{\n        widgetJson.config = {};\n        return Promise.resolve({});\n      }\n    }\n  }\n\n  loadWidgetNls(widgetJson: WidgetJson): Promise<any>{\n    return I18NManager.getInstance().loadNls(`${widgetJson.context.amdFolder}dist/runtime/nls/strings`);\n  }\n\n  private loadWidgetDependency(widgetJson: IMWidgetJson): Promise<void>{\n    if(!widgetJson.manifest.dependency){\n      return Promise.resolve();\n    }\n\n    let extensions = ExtensionManager.getInstance().getExtensions(ExtensionPoints.DependencyDefine);\n    let widgetDependencies = typeof widgetJson.manifest.dependency === 'string'? [widgetJson.manifest.dependency]: widgetJson.manifest.dependency;\n\n    let resources = [];\n    widgetDependencies.forEach(dependency => {\n      let ext = extensions.filter(ext => (ext as DependencyDefine).getDependencyKey() === dependency)[0] as DependencyDefine;\n      if(ext){\n        resources = resources.concat(ext.getResources());\n      }else{\n        if(/^http/.test(dependency)){\n          resources.push(dependency);\n        }else{\n          console.error('Unknown dependency in widget.', widgetJson.manifest.name);\n        }\n      }\n    });\n\n    //TODO handle failure.\n    let newResources = resources.filter(r => !this.dependencyResources[r]);\n    newResources.forEach(r => {\n      this.dependencyResources[r] = 'loading';\n    });\n    if(newResources.length === 0){\n      return Promise.resolve();\n    }\n\n    let cssResources = newResources.filter(r => /\\.css$/.test(r));\n    let jsResources = newResources.filter(r => /\\.js$/.test(r));\n    return Promise.all([\n      Promise.all(cssResources.map(r => loadstyle(r))).then(() => {\n        cssResources.forEach(r => {\n          this.dependencyResources[r] = 'loaded';\n        });\n      }),\n      amdRequire(jsResources).then(() => {\n        jsResources.forEach(r => {\n          this.dependencyResources[r] = 'loaded';\n        });\n      })\n    ]).then(() => {\n      \n    });\n  }\n\n  injectWidgetProps(WrappedComponent, nlsStrings: any, widgetJson: IMWidgetJson): React.ComponentClass<WidgetProps> {\n    interface WidgetState{\n      dataSources: {[dsId: string]: DataSource}\n    }\n    class WidgetWrapper extends BaseWidget<AllWidgetProps<{}>, WidgetState> {\n      static displayName = `WidgetWrapper(${widgetJson.manifest.name})`;\n      private dsManager: DataSourceManager;\n\n      constructor(props) {\n        super(props);\n        this.dsManager = DataSourceManager.getInstance();\n        this.state = {\n          dataSources: {}\n        };\n      }\n\n      onSignIn() {\n        return SessionManager.getInstance().signIn();\n      }\n\n      onSignOut() {\n        return SessionManager.getInstance().signOut();\n      }\n\n      componentDidMount(){\n        let dataSources = {};\n\n        this.props.useDataSources && this.props.useDataSources.forEach(dsId => {\n          let ds = this.dsManager.getDataSource(dsId);\n          if(!ds){\n            ds = this.dsManager.createDataSource(dsId);\n          }\n\n          dataSources[dsId] = ds;\n        });\n\n        this.setState({dataSources: dataSources});\n      }\n\n      render() {\n        let injectProps:any = {\n          nls: nlsStrings,\n          onSignIn: this.onSignIn,\n          onSignOut: this.onSignOut\n        };\n        \n        injectProps.dataSources = this.state.dataSources;\n\n        return (<WrappedComponent {...this.props} {...injectProps}/>);\n      }\n    }\n  \n    //copy static properites\n    for(let p in WrappedComponent){\n      if(!WidgetWrapper[p]){\n        WidgetWrapper[p] = WrappedComponent[p];\n      }\n    }\n\n    const mapStateToProps = (state: IMState) => {\n      let runtimeInfo = state.widgetsRuntimeInfo[widgetJson.id];\n  \n      let props: any = {\n        queryObject: state.queryObject,\n        portalUrl: state.portalUrl,\n        dataSourcesInfo: {},\n        user: state.user,\n        token: state.token\n      };\n\n      widgetJson.useDataSources && widgetJson.useDataSources.forEach(dsId => {\n        if(state.dataSourcesInfo && state.dataSourcesInfo[dsId]){\n          props.dataSourcesInfo[dsId] = {\n            status: state.dataSourcesInfo[dsId].status,\n            currentIndexes: state.dataSourcesInfo[dsId].currentIndexes\n          }\n        }        \n      });\n\n      if(store.getState().appContext.isBuilder){\n        props.appState = state.appState;\n      }\n      \n      // console.log(getWidgetById(state.appConfig, widgetJson.id));\n      let allOwnProps = Object.assign(props, state.appConfig.widgets[widgetJson.id], runtimeInfo)\n      return Object.assign(\n        allOwnProps,\n        WrappedComponent.mapExtraStateProps? WrappedComponent.mapExtraStateProps(state, allOwnProps): {});\n    };\n    return connect(mapStateToProps)(WidgetWrapper) as React.ComponentClass<WidgetProps>;\n  }\n}\n","import { ReduxStoreExtension } from '../extension-spec/extension-spec';\nimport { LayoutMap } from './types';\nimport { globalLayoutReducer } from './reducers/global-reducers';\nimport { GlobalLayoutActions } from './actions/global-layout-actions';\n\ndeclare module 'jimu-core/lib/types/state'{\n  interface State{\n    layouts?: {[key: string]: LayoutMap}\n  }\n}\n\ndeclare module 'jimu-core'{\n  interface State{\n    layouts?: {[key: string]: LayoutMap}\n  }\n}\n\nexport default class GlobalLayoutReduxStoreExtension implements ReduxStoreExtension{\n  id = 'global-layout-redux-store-extension';\n\n  getActions(){\n    return [\n      GlobalLayoutActions.ADD_WIDGET,\n      GlobalLayoutActions.ADD_SECTION,\n      GlobalLayoutActions.REMOVE_LAYOUT,\n      GlobalLayoutActions.RESIZE_LAYOUTS,\n      GlobalLayoutActions.UPDATE_SETTING,\n      GlobalLayoutActions.REMOVE_WIDGET,\n      GlobalLayoutActions.ADD_LAYOUT,\n      GlobalLayoutActions.DRAG_DROP_LAYOUT,\n      GlobalLayoutActions.ACTIVATE,\n      GlobalLayoutActions.REMOVE_SECTION,\n      GlobalLayoutActions.UPDATE_LAYOUT,\n      GlobalLayoutActions.CHANGE_ORDER\n    ];\n  }\n\n  getInitLocalState(){\n    return {\n      \"default\": {\n        \"0\": {\n          \"id\": \"0\",\n          \"pos\": {\n            \"x\": 0,\n            \"y\": 0,\n            \"w\": 100,\n            \"h\": 100\n          },\n          \"type\": 0\n        }\n      }\n    };\n  }\n\n  getReducer(){\n    return globalLayoutReducer;\n  }\n\n  getStoreKey(){\n    return `appConfig.layouts`;\n  }\n}","import * as actions from './app-actions';\nimport {store} from './store';\nimport {IMAppConfig} from './types/app-config';\nimport {changePage, changeView} from './browser-history';\nimport WidgetManager from './widget-manager';\nimport {addWidget, addSection, removeSection, removeWidget, updateLayout} from './layouts/actions/global-layout-actions';\nimport {getAppConfigDiff} from './utils/app-config';\n\nvar pubsub = window.top._builderPubsub;\nexport function listenBuilderEvents(){\n  if(!pubsub){\n    return;\n  }\n\n  pubsub.subscribe('to_app', function(evt, data){\n    console.log(evt, data);\n  });\n  pubsub.subscribe('to_app.app_config_changed', function(evt, appConfig: IMAppConfig){\n    //do other things (in addition to app reducer) when app config change\n    let appConfigDiff = getAppConfigDiff(store.getState().appConfig, appConfig);\n    appConfigDiff.removedWidgets.forEach(wId => {\n      WidgetManager.getInstance().deleteWidgetClass(wId);\n    });\n\n    store.dispatch(actions.appConfigChanged(appConfig, appConfigDiff));\n  });\n\n  pubsub.subscribe('to_app.app_mode_changed', function(action, mode){\n    store.dispatch(actions.appModeChanged(mode));\n  });\n\n  pubsub.subscribe('to_app.high_light', function(action, widgetId){\n    store.dispatch(actions.toggleWidgetHighlight(widgetId, true));\n  });\n\n  pubsub.subscribe('to_app.remove_high_light', function(action, widgetId){\n    store.dispatch(actions.toggleWidgetHighlight(widgetId, false));\n  });\n\n  pubsub.subscribe('to_app.set_app_in_builder', function(action){\n    store.dispatch(actions.setAppInBuilder());\n  });\n\n  pubsub.subscribe('to_app.change_page', function(action, pageId){\n    changePage(pageId);\n  });\n\n  pubsub.subscribe('to_app.change_view', function(action, {sectionId, viewId}){\n    changeView(sectionId, viewId);\n  });\n\n  pubsub.subscribe('to_app.change_current_setting_widget', function(action, widgetId){\n    store.dispatch(actions.setWidgetIsSettingState(widgetId, true));\n  });\n\n  pubsub.subscribe('to_app.toggle_widget_highlight', function(action, {widgetId, isHighlight}){\n    store.dispatch(actions.toggleWidgetHighlight(widgetId, isHighlight));\n  });\n\n  pubsub.subscribe('to_app.add_widget', function(action, info){\n    store.dispatch(addWidget(info.widgetId, info.layoutInfo));\n    \n  });\n\n  pubsub.subscribe('to_app.add_section', function(action, info){\n    store.dispatch(addSection(info.sectionId, info.layoutInfo));\n  });\n\n  pubsub.subscribe('to_app.remove_widget', function(action, info){\n    store.dispatch(removeWidget(info.widgetId));\n  });\n\n  pubsub.subscribe('to_app.remove_section', function(action, info){\n    store.dispatch(removeSection(info.sectionId));\n  });\n\n  pubsub.subscribe('to_app.update_layout_item', function(action, info){\n    store.dispatch(updateLayout(info.layoutInfo, info.layoutContent.pos, info.layoutContent.setting));\n  });\n}\n\nexport function publishAppStateChangeToBuilder(){\n  publishEventToBuilder('to_builder.app_state_changed', store.getState());\n}\n\nexport function publishCurrentEditWidgetChangeToBuilder(widgetId: string){\n  store.dispatch(actions.setWidgetIsSettingState(widgetId, true));\n  publishEventToBuilder('to_builder.current_widget_changed', widgetId);\n}\n\nexport function publishRemoveWidgetToBuilder(widgetId: string){\n  publishEventToBuilder('to_builder.widget_removed', widgetId);\n}\n\nexport function letBuilderPopupChooseWidget(layoutId: string, layoutItemId: string){\n  publishEventToBuilder('to_builder.popup_choose_widget', {\n    layoutId: layoutId,\n    layoutItemId: layoutItemId\n  });\n}\n\nexport function publishWidgetConfigChangeToBuilder(widgetId: string, widgetConfig){\n  publishEventToBuilder('to_builder.widget_config_changed', {\n    widgetId: widgetId,\n    widgetConfig: widgetConfig\n  });\n}\n\nfunction publishEventToBuilder(action, data?){\n  if(!pubsub){\n    return;\n  }\n\n  pubsub.publish(action, data);\n}","import * as React from 'react';\nimport * as invariant from 'invariant';\nimport { Layout, LayoutType } from './types';\nimport { ActionContext } from './action-context';\n\nconst components = {};\nconst viewComponents = {};\n\nexport function registerLayout(name: string, itemClass: React.ComponentClass) {\n  components[name] = itemClass;\n}\n\nexport function registerLayoutViewer(name: string, itemClass: React.ComponentClass) {\n  viewComponents[name] = itemClass;\n}\n\nexport function isRegistered(name: any) {\n  return typeof components[name] !== 'undefined';\n}\n\nexport function isViewerRegistered(name: any) {\n  return typeof viewComponents[name] !== 'undefined';\n}\n\nexport class LayoutFactory {\n  static createLayout(type: LayoutType, layout: Layout, props?: any) {\n    invariant(components[type], `${type} not registered`);\n    const LayoutElement = components[type];\n    return (\n      <ActionContext.Consumer>\n        {actions => <LayoutElement layout={layout} {...props}\n          actionContext={actions}\n          >\n        </LayoutElement>}\n      </ActionContext.Consumer>\n    );\n  }\n\n  static createLayoutViewer(layout: Layout, props?: any) {\n    const type = layout.type;\n    invariant(viewComponents[type], `${type} not registered`);\n    const LayoutElement = viewComponents[type];\n    if (type === LayoutType.SIDEBAR_LAYOUT) {\n      return (\n        <ActionContext.Consumer>\n          {actions => <LayoutElement layout={layout} {...props}\n            actionContext={actions}>\n          </LayoutElement>}\n        </ActionContext.Consumer>\n      );\n    } else {\n      return <LayoutElement layout={layout} {...props}></LayoutElement>;\n    }\n  }\n}","export enum DND_TYPES {\n  LAYOUT = 'layout'\n}","import * as React from 'react';\nimport { connect } from 'react-redux';\nimport * as invariant from 'invariant';\nimport { Layout, LayoutProps, LayoutActionContext } from '../types';\nimport { getSectionLayout, emptyFunc } from '../utils';\nimport { LayoutItem } from '../layout-item';\nimport { IMAppConfig } from '../../types/app-config';\nimport { UrlParameters } from '../../types/url-parameters';\nimport { IMState } from '../../types/state';\nimport { AppMode } from '../../types/constants';\n\ninterface Props {\n  layout: Layout;\n  width: number;\n  height: number;\n  actionContext?: LayoutActionContext;\n}\n\ninterface StateProps{\n  appConfig: IMAppConfig;\n  queryObject: UrlParameters,\n  appMode: AppMode,\n  isMobile: boolean,\n  dispatch?: any\n}\n\nexport class SectionLayout extends React.Component<Props & StateProps> {\n  static defaultProps: Partial<Props> = {\n    actionContext: {\n      updateSetting: emptyFunc,\n      addLayout: emptyFunc,\n      removeLayout: emptyFunc,\n      resizeLayouts: emptyFunc,\n      dndLayout: emptyFunc,\n      activate: emptyFunc,\n      removeWidget: emptyFunc\n    }\n  };\n\n  constructor(props) {\n    super(props);\n  }\n\n  _getCurrentLayoutId() {\n    const { appConfig, queryObject, layout, isMobile, width, height } = this.props;\n    const section = appConfig.sections[layout.sectionId];\n    invariant(section, `no section in appConfig with id ${layout.sectionId}`);\n    if (section.views && section.views.length > 0) {\n      let viewId = section.views[0];\n      if(queryObject.views){\n        let viewsId: string[] = queryObject.views.split(',');\n        viewsId.forEach(vId => {\n          if(section.views.indexOf(vId) > -1){//the view id in URL parameter is in this section\n            viewId = vId;\n          }\n        });\n      }\n      const view = appConfig.views[viewId];\n      invariant(view, `no view in appConfig with id ${viewId}`);\n      let layout;\n      if (isMobile) {\n        if (view.mobileTheresholdSize &&\n          (view.mobileTheresholdSize.width > width || view.mobileTheresholdSize.height > height)) {\n          layout = view.mobileLayoutCompact || view.mobileLayout || view.layout;\n        } else {\n          layout = view.mobileLayout || view.layout;\n        }\n      } else {\n        if (view.desktopThresholdSize &&\n          (view.desktopThresholdSize.width > width || view.desktopThresholdSize.height > height)) {\n          layout = view.desktopLayoutCompact || view.layout;\n        } else {\n          layout = view.layout;\n        }\n      }\n      return layout;\n    }\n    return null;\n  }\n\n  render() {\n    const { appConfig, layout, width, height, appMode } = this.props;\n    const layoutId = this._getCurrentLayoutId();\n    const sectionLayout = getSectionLayout(layoutId, appConfig);\n    if (!sectionLayout) {\n      return null;\n    }\n    const pos = {\n      x: 0,\n      y: 0,\n      w: width - 2,\n      h: height - 2\n    };\n\n    return (\n      <div className='section-layout'\n      data-sectionid={layout.sectionId}\n      data-layoutitemid={layout.id}\n      data-layoutid={layout.layoutId}>\n        <LayoutItem layout={sectionLayout as any} appMode={appMode} pos={pos} style={{position: 'relative'}}>\n        </LayoutItem>\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IMState) => {\n  return {\n    appConfig: state.appConfig,\n    queryObject: state.queryObject,\n    appMode: state.appMode,\n    isMobile: state.appContext.isMobile\n  }\n};\n\nexport default connect<StateProps, {}, Props>(mapStateToProps)(SectionLayout);","import assign = require(\"lodash.assign\");\nimport { AttachType, SidebarItemSetting } from '../types';\nimport { DEFAULT_LAYOUT_SETTING } from '../default-common-setting';\n\nexport const DEFAULT_SIDEBAR_SETTING: SidebarItemSetting = assign({}, DEFAULT_LAYOUT_SETTING, {\n  draggable: false,\n  overlay: false,\n  togglable: true,\n  toggleOn: true\n});","import * as React from 'react';\nimport * as Immutable from 'seamless-immutable';\nimport { connect } from 'react-redux';\nimport resizable, {ResizableProps} from '../react-dnd-resizable';\nimport { Layout, Position, AttachType, SidebarItemSetting, LayoutActionContext, LayoutInfo } from '../types';\nimport { autoBindHandlers, getLayoutItem, emptyFunc } from '../utils';\nimport { Sidebar } from './sidebar';\nimport { LayoutItem } from '../layout-item';\n// import { LayoutFactory } from '../layout-factory'\nimport './style/sidebar-layout.scss';\nimport { AppMode } from '../../types/constants';\nimport { IMState } from '../../types/state';\nimport { UrlParameters } from '../../types/url-parameters';\nimport * as utils from './sidebar-layout-util';\n\ninterface SidebarLayoutProps {\n  appMode: AppMode;\n  width: number;\n  height: number;\n  layout: Layout;\n  actionContext?: LayoutActionContext;\n}\n\ninterface StateProps{\n  queryObject: UrlParameters\n}\n\ninterface SidebarLayoutState {\n  layout: Layout;\n  layoutMap: {[key: string]: Layout},\n  // pixelLayouts: {[key: string]: Immutable.ImmutableObject<Position>};\n  resizingSide: AttachType;\n  delta: {w: number, h: number};\n}\n\nclass SidebarLayoutPrototype extends React.Component<SidebarLayoutProps & StateProps, SidebarLayoutState> {\n  static defaultProps: Partial<SidebarLayoutProps> = {\n    layout: null,\n    width: 0,\n    height: 0,\n    actionContext: {\n      updateSetting: emptyFunc,\n      addLayout: emptyFunc,\n      removeLayout: emptyFunc,\n      resizeLayouts: emptyFunc,\n      dndLayout: emptyFunc,\n      activate: emptyFunc,\n      removeWidget: emptyFunc\n    }\n  };\n\n  state: SidebarLayoutState = {\n    layout: null,\n    layoutMap: null,\n    // pixelLayouts: {},\n    resizingSide: null,\n    delta: null\n  }\n\n  interactComponent: React.ComponentType<ResizableProps>;\n\n  constructor(props) {\n    super(props);\n    autoBindHandlers(this, [\n      '_onResizeStart',\n      '_onResizeEnd',\n      '_onResizing',\n      '_onItemToggleChange'\n    ]);\n    this.interactComponent = resizable({\n      onToggleChange: this._onItemToggleChange\n    })(Sidebar);\n    const {layout, queryObject} = this.props;\n    const sideLayouts = utils.collectSidebars(layout.content || [], queryObject && queryObject.layouts);\n\n    this.state = {\n      layout: layout,\n      layoutMap: sideLayouts as {[key: string]: Layout},\n      resizingSide: null,\n      delta: null\n    };\n  }\n\n  static getDerivedStateFromProps(nextProps: SidebarLayoutProps & StateProps, prevState: SidebarLayoutState) {\n    if (nextProps.layout !== prevState.layout) {\n      const {layout} = nextProps;\n      const sideLayouts = utils.collectSidebars(layout.content || []);\n\n      return {\n        layout: nextProps.layout,\n        layoutMap: sideLayouts\n      };\n    }\n    return null;\n  }\n\n  _onResizeStart(id: string) {\n    const {layout} = this.props;\n    let targetLayout: Layout;\n    layout.content.some(layoutItem => {\n      if(layoutItem.id === id) {\n        targetLayout = layoutItem;\n        return true;\n      }\n    });\n    this.setState({\n      resizingSide: (targetLayout.setting as SidebarItemSetting).attach\n    });\n  }\n\n  _onResizing(id: string, x: number, y: number, dw: number, dh: number) {\n    this.setState({\n      delta: {w: dw, h: dh}\n    });\n  }\n\n  _onResizeEnd(id: string, x: number, y: number, dw: number, dh: number) {\n    const { layoutMap, resizingSide, delta } = this.state;\n    const { width, height, actionContext, layout } = this.props;\n    const positionMap = utils.calculatePosition(layoutMap, width, height, resizingSide, delta);\n\n    if (resizingSide && delta) {\n      switch(resizingSide) {\n        case AttachType.LEFT:\n          positionMap['left'].w += delta.w;\n          break;\n        case AttachType.RIGHT:\n          positionMap['right'].x -= delta.w;\n          positionMap['right'].w += delta.w;\n          break;\n        case AttachType.TOP:\n          positionMap['header'].h += delta.h;\n          break;\n        case AttachType.BOTTOM:\n          positionMap['footer'].y -= delta.h;\n          positionMap['footer'].h += delta.h;\n          break;\n      }\n    }\n\n    let results = [];\n    Object.keys(positionMap).forEach(key => {\n      if (key !== 'main') {\n        results.push({\n          id: layoutMap[key].id,\n          layoutId: layout.layoutId,\n          pos: positionMap[key]\n        });\n      }\n    });\n\n    this.setState({\n      resizingSide: null,\n      delta: null\n    });\n    actionContext.resizeLayouts(results);\n  }\n\n  _onItemToggleChange(id: string, toggle: boolean) {\n    const { layout, actionContext } = this.props;\n    const targetLayout = getLayoutItem(layout.content, id);\n    if (targetLayout) {\n      const setting = Immutable(targetLayout.setting || {}).set('toggleOn', toggle);\n      actionContext.updateSetting({\n        layoutId: layout.layoutId,\n        layoutItemId: id\n      }, setting);\n    }\n  }\n\n  _createSidebar(direction: string, position: Position) {\n    const { layoutMap } = this.state;\n    const setting = layoutMap[direction].setting as SidebarItemSetting;\n    const { attach, min, max, resizable, togglable, toggleOn } = setting;\n    const horizontal = attach === AttachType.LEFT || attach === AttachType.RIGHT;\n    const ResizableSidebar = this.interactComponent;\n\n    return <ResizableSidebar\n      pos={position}\n      layout={layoutMap[direction]}\n      appMode={this.props.appMode}\n      disableInteract={!resizable || (togglable && !toggleOn)}\n      onResizeStart={this._onResizeStart}\n      onResizing={this._onResizing}\n      onResizeEnd={this._onResizeEnd}\n      minWidth={horizontal ? min : null}\n      maxWidth={horizontal ? max : null}\n      minHeight={horizontal ? null : min}\n      maxHeight={horizontal ? null : max}\n      left={attach === AttachType.RIGHT}\n      right={attach === AttachType.LEFT}\n      top={attach === AttachType.BOTTOM}\n      bottom={attach === AttachType.TOP}\n      className={direction}\n    ></ResizableSidebar>;\n  }\n\n  render() {\n    const {  layoutMap, resizingSide, delta } = this.state;\n    const { width, height, layout, appMode } = this.props;\n    const positionMap = utils.calculatePosition(layoutMap, width, height, resizingSide, delta);\n\n    return (<div className=\"sidebar-layout\" data-layoutid={layout.layoutId} data-layoutitemid={layout.id}>\n      {positionMap.main && <LayoutItem layout={layoutMap.main} pos={positionMap['main']} appMode={appMode}></LayoutItem>}\n      {positionMap.header && this._createSidebar('header', positionMap['header'])}\n      {positionMap.left && this._createSidebar('left', positionMap['left'])}\n      {positionMap.right && this._createSidebar('right', positionMap['right'])}\n      {positionMap.footer && this._createSidebar('footer', positionMap['footer'])}\n    </div>)\n  }\n}\n\nconst mapStateToProps = (state: IMState) => {\n  return {\n    queryObject: state.queryObject\n  }\n};\n\nexport const SidebarLayout = connect<StateProps, {}, SidebarLayoutProps>(mapStateToProps)(SidebarLayoutPrototype);\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./layout.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./layout.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./layout.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","import { FixedLayoutSetting } from '../types';\nimport assign = require(\"lodash.assign\");\nimport { DEFAULT_LAYOUT_SETTING } from '../default-common-setting';\n\nexport const DEFAULT_FIX_LAYOUT_SETTING: FixedLayoutSetting = assign({}, DEFAULT_LAYOUT_SETTING, {\n  static: false,\n  order: 0,\n  gridSize: 16,\n  restrict: false,\n  alignCenter: false,\n  hPriority: 'left',\n  vPriority: 'top'\n});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./grid.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./grid.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./grid.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","import * as invariant from 'invariant';\nimport * as Immutable from 'seamless-immutable';\nimport { Layout, Position, CompactType, GridLayoutSetting } from '../types';\nimport { isStaticLayout, getLayoutItem } from '../utils';\n\nconst isProduction = process.env.NODE_ENV === \"production\";\nconst DEBUG = false;\n\n/**\n * Return the bottom coordinate of the layout.\n *\n * @param  {Array} layouts Layout array.\n * @return {Number}       Bottom coordinate.\n */\nexport function bottom(layouts: Array<Layout>): number {\n  let max = 0, bottomY;\n  layouts.forEach(layout => {\n    bottomY = layout.pos.y + layout.pos.h;\n    if (bottomY > max) {\n      max = bottomY;\n    }\n  });\n  return max;\n}\n\n// /**\n//  * Comparing React `children` is a bit difficult. This is a good way to compare them.\n//  * This will catch differences in keys, order, and length.\n//  */\n// export function childrenEqual(a: ReactChildren, b: ReactChildren): boolean {\n//   return isEqual(\n//     React.Children.map(a, c => c.key),\n//     React.Children.map(b, c => c.key)\n//   );\n// }\n\n// /**\n//  * Given two layoutitems, check if they collide.\n//  */\nexport function collides(l1: Layout, l2: Layout): boolean {\n  if (l1 === l2) {// same element\n    return false;\n  }\n  const p1 = l1.pos, p2 = l2.pos\n  if (p1.x + p1.w <= p2.x) return false; // l1 is left of l2\n  if (p1.x >= p2.x + p2.w) return false; // l1 is right of l2\n  if (p1.y + p1.h <= p2.y) return false; // l1 is above l2\n  if (p1.y >= p2.y + p2.h) return false; // l1 is below l2\n  return true; // boxes overlap\n}\n\n/**\n * Given a layout, compact it. This involves going down each y coordinate and removing gaps\n * between items.\n *\n * @param  {Array} layouts Layout.\n * @param  {CompactType} compactType Whether or not to compact the layout vertically.\n * @return {Array}       Compacted Layout.\n */\nexport function compact(\n  layouts: Array<Layout>,\n  compactType: CompactType,\n  cols: number\n): Array<Layout> {\n  // Statics go in the compareWith array right away so items flow around them.\n  const compareWith = getStatics(layouts);\n  // We go through the items by row and column.\n  const sorted = sortLayoutItems(layouts, compactType);\n  // Holding for new items.\n  const out = Array(layouts.length);\n\n  for (let i = 0, len = sorted.length; i < len; i++) {\n    let index = -1;\n    layouts.some((layout, idx) => {\n      if (layout.id === sorted[i].id) {\n        index = idx;\n        return true;\n      }\n    })\n    invariant(index >= 0, 'sorted item is not in the original array');\n    let l;\n    if (Immutable.isImmutable(sorted[i])) {\n      l = sorted[i];\n    } else {\n      l = Immutable(sorted[i]);\n    }\n\n    // Don't move static elements\n    if (!isStaticLayout(l)) {\n      l = compactItem(compareWith, l, compactType, cols, sorted);\n\n      // Add to comparison array. We only collide with items before this one.\n      // Statics are already in this array.\n      compareWith.push(l);\n    }\n    // Clear moved flag, if it exists.\n    l = l.set('moved', false);\n    // Add to output array to make sure they still come out in the right order.\n    out[index] = l;\n  }\n\n  return out;\n}\n\nconst heightWidth = { x: \"w\", y: \"h\" };\n// /**\n//  * Before moving item down, it will check if the movement will cause collisions and move those items down before.\n//  */\nfunction resolveCompactionCollision(\n  layouts: Array<Layout>,\n  item: Immutable.ImmutableObject<Layout>,\n  moveToCoord: number,\n  axis: \"x\" | \"y\"\n) : Immutable.ImmutableObject<Layout> {\n  const sizeProp = heightWidth[axis];\n  item = item.setIn(['pos', axis], item.pos[axis] + 1);\n  let itemIndex = 0;\n  layouts.some((layout, index) => {\n    if (layout.id === item.id) {\n      itemIndex = index;\n      return true;\n    }\n  });\n\n  // Go through each item we collide with.\n  for (let i = itemIndex + 1; i < layouts.length; i++) {\n    const otherItem = Immutable(layouts[i]);\n    // Ignore static items\n    if (isStaticLayout(otherItem)) {\n      continue;\n    }\n\n    // Optimization: we can break early if we know we're past this el\n    // We can do this b/c it's a sorted layout\n    if (otherItem.pos.y > (item.pos.y + item.pos.h)) {\n      break;\n    }\n\n    if (collides(item, otherItem)) {\n      layouts[i] = resolveCompactionCollision(\n        layouts,\n        otherItem,\n        moveToCoord + item.pos[sizeProp],\n        axis\n      );\n    }\n  }\n\n  return item.setIn(['pos', axis], moveToCoord);\n}\n\n/**\n * Compact an item in the layout.\n */\nexport function compactItem(\n  compareWith: Array<Layout>,\n  l: Immutable.ImmutableObject<Layout>,\n  compactType: CompactType,\n  cols: number,\n  fullLayout: Array<Layout>\n): Immutable.ImmutableObject<Layout> {\n  if (compactType === CompactType.VERTICAL) {\n    // Bottom 'y' possible is the bottom of the layout.\n    // This allows you to do nice stuff like specify {y: Infinity}\n    // This is here because the layout must be sorted in order to get the correct bottom `y`.\n    l = l.setIn(['pos', 'y'], Math.min(bottom(compareWith), l.pos.y));\n    // Move the element up as far as it can go without colliding.\n    while (l.pos.y > 0 && !getFirstCollision(compareWith, l)) {\n      l = l.setIn(['pos', 'y'], l.pos.y - 1);\n    }\n  } else if (compactType === CompactType.HORIZONTAL) {\n    l = l.setIn(['pos', 'y'], Math.min(bottom(compareWith), l.pos.y));\n    // Move the element left as far as it can go without colliding.\n    while (l.pos.x > 0 && !getFirstCollision(compareWith, l)) {\n      l = l.setIn(['pos', 'x'], l.pos.x - 1);\n    }\n  }\n\n  // Move it down, and keep moving it down if it's colliding.\n  let collides = getFirstCollision(compareWith, l);\n  while (collides) {\n    if (compactType === CompactType.HORIZONTAL) {\n      l = resolveCompactionCollision(fullLayout, l, collides.pos.x + collides.pos.w, \"x\");\n    } else {\n      l = resolveCompactionCollision(fullLayout, l, collides.pos.y + collides.pos.h, \"y\");\n    }\n    // Since we can't grow without bounds horizontally, if we've overflown, let's move it down and try again.\n    if (compactType === CompactType.HORIZONTAL && l.pos.x + l.pos.w > cols) {\n      l = l.setIn(['pos', 'x'], cols - l.pos.w);\n      l = l.setIn(['pos', 'y'], l.pos.y + 1);\n    }\n    collides = getFirstCollision(compareWith, l);\n  }\n  return l;\n}\n\n/**\n * Given a layout, make sure all elements fit within its bounds.\n *\n * @param  {Array} layout Layout array.\n * @param  {Number} bounds Number of columns.\n */\nexport function correctBounds(\n  layouts: Array<Layout>,\n  cols: number\n): Array<Layout> {\n  const out = Array(layouts.length);\n  const collidesWith = getStatics(layouts);\n  for (let i = 0, len = layouts.length; i < len; i++) {\n    let l = Immutable(layouts[i]);\n    // Overflows right\n    if (l.pos.x + l.pos.w > cols) {\n      l = l.setIn(['pos', 'x'], cols - l.pos.w);\n    }\n    // Overflows left\n    if (l.pos.x < 0) {\n      l = l.setIn(['pos', 'x'], 0);\n      l = l.setIn(['pos', 'w'], cols);\n    }\n    if (!isStaticLayout(l)) {\n      collidesWith.push(l);\n    } else {\n      // If this is static and collides with other statics, we must move it down.\n      // We have to do something nicer than just letting them overlap.\n      while (getFirstCollision(collidesWith, l)) {\n        l = l.setIn(['pos', 'y'], l.pos.y + 1);\n      }\n    }\n    out[i] = l;\n  }\n  return out;\n}\n\n/**\n * Returns the first item this layout collides with.\n * It doesn't appear to matter which order we approach this from, although\n * perhaps that is the wrong thing to do.\n *\n * @param  {Object} layoutItem Layout item.\n * @return {Object|undefined}  A colliding layout item, or undefined.\n */\nexport function getFirstCollision(\n  layout: Array<Layout>,\n  layoutItem: Layout\n): Layout {\n  for (let i = 0, len = layout.length; i < len; i++) {\n    if (collides(layout[i], layoutItem)) {\n      return layout[i];\n    }\n  }\n}\n\nexport function getAllCollisions(\n  layouts: Array<Layout>,\n  layoutItem: Layout\n): Array<Layout> {\n  return layouts.filter(l => collides(l, layoutItem));\n}\n\n/**\n * Get all static elements.\n * @param  {Array} layout Array of layout objects.\n * @return {Array}        Array of static layout items..\n */\nexport function getStatics(layout: Array<Layout>): Array<Layout> {\n  const result = layout.filter(l => isStaticLayout(l));\n  if (Immutable.isImmutable(result)) {\n    return (result as Immutable.ImmutableObject<Array<Layout>>).asMutable();\n  }\n  return result;\n}\n\n/**\n * Move an element. Responsible for doing cascading movements of other elements.\n *\n * @param  {Array}      layouts            Full layout to modify.\n * @param  {String}     layoutId          element id to move.\n * @param  {Number}     [x]               X position in grid units.\n * @param  {Number}     [y]               Y position in grid units.\n */\nexport function moveElement(\n  layouts: Array<Layout>,\n  layoutId: string,\n  compactType: CompactType,\n  cols: number,\n  x?: number,\n  y?: number,\n  isUserAction?: boolean,\n  preventCollision?: boolean,\n): Array<Layout> {\n  let out: Array<Layout>;\n  if (!Immutable.isImmutable(layouts[0])) {\n    out = layouts.map(layout => Immutable(layout));\n  } else {\n    out = layouts as Array<Immutable.ImmutableObject<Layout>>;\n  }\n\n  let l = getLayoutItem(out, layoutId) as Immutable.ImmutableObject<Layout>;\n  const index = out.indexOf(l);\n  invariant(index >= 0, 'layoutId should in the layouts array');\n\n  if (isStaticLayout(l)) {\n    return out;\n  }\n\n  // Short-circuit if nothing to do.\n  if (l.pos.y === y && l.pos.x === x) {\n    return out;\n  }\n\n  const oldX = l.pos.x;\n  const oldY = l.pos.y;\n\n  // This is quite a bit faster than extending the object\n  if (typeof x === 'number') {\n    l = l.setIn(['pos', 'x'], x);\n  }\n  if (typeof y === 'number') {\n    l = l.setIn(['pos', 'y'], y);\n  }\n  l = l.set('moved', true);\n\n  // If this collides with anything, move it.\n  // When doing this comparison, we have to sort the items we compare with\n  // to ensure, in the case of multiple collisions, that we're getting the\n  // nearest collision.\n  out[index] = l;\n  let sorted = sortLayoutItems(out, compactType);\n  const movingUp =\n    compactType === CompactType.VERTICAL && typeof y === 'number' ? oldY >= y\n    : compactType === CompactType.HORIZONTAL && typeof x === 'number' ? oldX >= x\n    : false;\n  if (movingUp) {\n    sorted = sorted.reverse();\n  }\n  const collisions = getAllCollisions(sorted, l);\n\n  // There was a collision; abort\n  if (preventCollision && collisions.length) {\n    l = l.setIn(['pos', 'x'], oldX);\n    l = l.setIn(['pos', 'y'], oldY);\n    l = l.set('moved', false);\n    out[index] = l;\n    return out;\n  }\n\n  // Move each item that collides away from this element.\n  for (let i = 0, len = collisions.length; i < len; i++) {\n    const collision = collisions[i] as Immutable.ImmutableObject<Layout>;\n\n    // Short circuit so we can't infinite loop\n    if (collision.moved) {\n      continue;\n    };\n\n    // Don't move static items - we have to move *this* element away\n    if (isStaticLayout(collision)) {\n      out = moveElementAwayFromCollision(\n        out,\n        collision,\n        l,\n        compactType,\n        cols,\n        isUserAction\n      );\n    } else {\n      out = moveElementAwayFromCollision(\n        out,\n        l,\n        collision,\n        compactType,\n        cols,\n        isUserAction\n      );\n    }\n  }\n  return out;\n}\n\n/**\n * This is where the magic needs to happen - given a collision, move an element away from the collision.\n * We attempt to move it up if there's room, otherwise it goes below.\n *\n * @param  {Array} layouts            Full layout to modify.\n * @param  {LayoutItem} collidesWith Layout item we're colliding with.\n * @param  {LayoutItem} itemToMove   Layout item we're moving.\n */\nexport function moveElementAwayFromCollision(\n  layouts: Array<Layout>,\n  collidesWith: Immutable.ImmutableObject<Layout>,\n  itemToMove: Immutable.ImmutableObject<Layout>,\n  compactType: CompactType,\n  cols: number,\n  isUserAction: boolean,\n): Array<Layout> {\n  const compactH = compactType === CompactType.HORIZONTAL;\n  const compactV = compactType === CompactType.VERTICAL;\n  const preventCollision = false; // we're already colliding\n\n  // If there is enough space above the collision to put this element, move it there.\n  // We only do this on the main collision as this can get funky in cascades and cause\n  // unwanted swapping behavior.\n  if (isUserAction) {\n    // Reset isUserAction flag because we're not in the main collision anymore.\n    isUserAction = false;\n\n    // Make a mock item so we don't modify the item here, only modify in moveElement.\n    const fakeItem: Layout = {\n      pos: {\n        x: compactH ? Math.max(collidesWith.pos.x - itemToMove.pos.w, 0) : itemToMove.pos.x,\n        y: compactV ? Math.max(collidesWith.pos.y - itemToMove.pos.h, 0) : itemToMove.pos.y,\n        w: itemToMove.pos.w,\n        h: itemToMove.pos.h\n      },\n      id: \"-1\"\n    };\n\n    // No collision? If so, we can go up there; otherwise, we'll end up moving down as normal\n    if (!getFirstCollision(layouts, fakeItem)) {\n      return moveElement(\n        layouts,\n        itemToMove.id,\n        compactType,\n        cols,\n        compactH ? fakeItem.pos.x : undefined,\n        compactV ? fakeItem.pos.y : undefined,\n        isUserAction,\n        preventCollision,\n      );\n    }\n  }\n\n  return moveElement(\n    layouts,\n    itemToMove.id,\n    compactType,\n    cols,\n    compactH ? itemToMove.pos.x + 1 : undefined,\n    compactV ? itemToMove.pos.y + 1 : undefined,\n    isUserAction,\n    preventCollision,\n  );\n}\n\n/**\n * Get layout items sorted from top left to right and down.\n *\n * @return {Array} Array of layout objects.\n * @return {Array}        Layout, sorted static items first.\n */\nexport function sortLayoutItems(\n  layouts: Array<Layout>,\n  compactType: CompactType\n): Array<Layout> {\n  if (compactType === CompactType.HORIZONTAL) {\n    return sortLayoutItemsByColRow(layouts);\n  } else if (compactType === CompactType.VERTICAL) {\n    return sortLayoutItemsByRowCol(layouts);\n  } else {\n    return layouts;\n  }\n}\n\nexport function sortLayoutItemsByRowCol(layouts: Array<Layout>): Array<Layout> {\n  return [].concat(layouts).sort((a, b) => {\n    if (a.pos.y > b.pos.y || (a.pos.y === b.pos.y && a.pos.x > b.pos.x)) {\n      return 1;\n    } else if (a.pos.y === b.pos.y && a.pos.x === b.pos.x) {\n      // Without this, we can get different sort results in IE vs. Chrome/FF\n      return 0;\n    }\n    return -1;\n  });\n}\n\nexport function sortLayoutItemsByColRow(layout: Array<Layout>): Array<Layout> {\n  return [].concat(layout).sort((a, b) => {\n    if (a.pos.x > b.pos.x || (a.pos.x === b.pos.x && a.pos.y > b.pos.y)) {\n      return 1;\n    } else if (a.pos.y === b.pos.y && a.pos.x === b.pos.x) {\n      return 0;\n    }\n    return -1;\n  });\n}\n\n/**\n * Generate a layout using the initialLayout and children as a template.\n * Missing entries will be added, extraneous ones will be truncated.\n *\n * @param  {Array}  initialLayouts Layout passed in through props.\n * @param  {String} breakpoint    Current responsive breakpoint.\n * @param  {?String} compact      Compaction option.\n * @return {Array}                Working layout.\n */\nexport function synchronizeLayoutWithChildren(\n  initialLayouts: Array<Layout>,\n  cols: number,\n  compactType: CompactType\n): Array<Layout> {\n  initialLayouts = initialLayouts || [];\n\n  // Generate one layout item per child.\n  let layout: Array<Layout> = [];\n  // Correct the layout.\n  layout = correctBounds(initialLayouts, cols);\n  layout = compact(layout, compactType, cols);\n\n  return layout;\n}\n\n/**\n * Given breakpoints, return an array of breakpoints sorted by width. This is usually\n * e.g. ['xxs', 'xs', 'sm', ...]\n *\n * @param  {Object} breakpoints Key/value pair of breakpoint names to widths.\n * @return {Array}              Sorted breakpoints.\n */\nexport function sortBreakpoints(breakpoints: { [key: string]: number }): Array<string> {\n  const keys: Array<string> = Object.keys(breakpoints);\n  return keys.sort(function(a, b) {\n    return breakpoints[a] - breakpoints[b];\n  });\n}\n\n/**\n * Given a width, find the highest breakpoint that matches is valid for it (width > breakpoint).\n *\n * @param  {Object} breakpoints Breakpoints object (e.g. {lg: 1200, md: 960, ...})\n * @param  {Number} width Screen width.\n * @return {String}       Highest breakpoint that is less than width.\n */\nexport function getBreakpointFromWidth(\n  breakpoints: { [key: string]: number },\n  width: number\n): string {\n  const sorted = sortBreakpoints(breakpoints);\n  let matching = sorted[0];\n  for (let i = 1, len = sorted.length; i < len; i++) {\n    const breakpointName = sorted[i];\n    if (width > breakpoints[breakpointName]) {\n      matching = breakpointName;\n    }\n  }\n  return matching;\n}\n\n/**\n * Given a breakpoint, get the # of cols set for it.\n * @param  {String} breakpoint Breakpoint name.\n * @param  {Object} cols       Map of breakpoints to cols.\n * @return {Number}            Number of cols.\n */\nexport function getColsFromBreakpoint(\n  breakpoint: string,\n  cols: { [key: string]: number }\n): number {\n  invariant(cols[breakpoint], \"ResponsiveReactGridLayout: `cols` entry for breakpoint \" +\n  breakpoint +\n  \" is missing!\");\n  return cols[breakpoint];\n}\n\n/**\n * Given existing layouts and a new breakpoint, find or generate a new layout.\n *\n * This finds the layout above the new one and generates from it, if it exists.\n *\n * @param  {Object} layouts     Existing layouts.\n * @param  {Array} breakpoints All breakpoints.\n * @param  {String} breakpoint New breakpoint.\n * @param  {String} breakpoint Last breakpoint (for fallback).\n * @param  {Number} cols       Column count at new breakpoint.\n * @param  {Boolean} verticalCompact Whether or not to compact the layout\n *   vertically.\n * @return {Array}             New layout.\n */\nexport function generateResponsiveLayout(\n  layouts: Array<Layout>,\n  cols: number,\n  compactType: CompactType\n): Layout[] {\n  layouts = layouts || [];\n  return compact(correctBounds(layouts, cols), compactType, cols);\n}\n\nexport function collectLayoutsAtBreakpoint(content: Array<Layout>, breakpoint: string, setting: GridLayoutSetting): Array<Layout> {\n  if (!content) {\n    return [];\n  }\n  const breakpointsSorted = sortBreakpoints(setting.breakpoints);\n  const index = breakpointsSorted.indexOf(breakpoint);\n  const breakpointsAbove = breakpointsSorted.slice(index);\n\n  return content.map(layout => {\n    let imLayout: Immutable.ImmutableObject<Layout>;\n    if (!Immutable.isImmutable(layout)) {\n      imLayout = Immutable(layout);\n    } else {\n      imLayout = layout as Immutable.ImmutableObject<Layout>;\n    }\n    let pos = layout.pos[breakpoint];\n    if (!pos) {\n      breakpointsAbove.some(item => {\n        if (layout.pos[item]) {\n          pos = layout.pos[item];\n          return true;\n        }\n      });\n      if (!pos && index !== 0) {\n        for (let i = index - 1; i >= 0; i--){\n          if (layout.pos[breakpointsSorted[i]]) {\n            pos = layout.pos[breakpointsSorted[i]];\n            break;\n          }\n        }\n      }\n    }\n    return imLayout.set('pos', pos || {\n        x: layout.pos.x,\n        y: layout.pos.y,\n        w: layout.pos.w,\n        h: layout.pos.h\n      }\n    );\n  });\n}\n\n/**\n * Translate coordinates from pixels to grid units.\n */\nexport function toGridPosition(pos: Position, setting: GridLayoutSetting,\n  numOfCols: number, colWidth: number): Position {\n  const { space, rowHeight } = setting;\n\n  let x = Math.round((pos.x - space) / (colWidth + space));\n  let y = Math.round((pos.y - space) / (rowHeight + space));\n  let w = Math.round((pos.w + space) / (colWidth + space));\n  let h = Math.round((pos.h + space) / (rowHeight + space));\n\n  // Capping\n  x = Math.max(Math.min(x, numOfCols - w), 0);\n  y = Math.max(y, 0);\n\n  // Capping\n  w = Math.max(Math.min(w, numOfCols - x), 1);\n  h = Math.max(h, 1);\n\n  return { x, y, w, h };\n}\n\n/**\n * Return position on the page given an x, y, w, h.\n * left, top, width, height are all in pixels.\n * @param  {Number}  x             X coordinate in grid units.\n * @param  {Number}  y             Y coordinate in grid units.\n * @param  {Number}  w             W coordinate in grid units.\n * @param  {Number}  h             H coordinate in grid units.\n * @return {Object}                Object containing coords.\n */\nexport function toPixelPosition(\n  pos: Position,\n  setting: GridLayoutSetting,\n  colWidth: number,\n  resizingPos?: Position,\n  draggingPos?: Position\n): Position {\n  const { space, padding, rowHeight } = setting;\n\n  const out = {\n    x: Math.round((colWidth + space) * pos.x + padding[0]),\n    y: Math.round((rowHeight + space) * pos.y + padding[1]),\n    // 0 * Infinity === NaN, which causes problems with resize constraints;\n    // Fix this if it occurs.\n    // Note we do it here rather than later because Math.round(Infinity) causes deopt\n    w:\n      pos.w === Infinity\n        ? pos.w\n        : Math.round(colWidth * pos.w + Math.max(0, pos.w - 1) * space),\n    h:\n      pos.h === Infinity\n        ? pos.h\n        : Math.round(rowHeight * pos.h + Math.max(0, pos.h - 1) * space)\n  };\n\n  if (resizingPos) {\n    out.w = Math.round(resizingPos.w);\n    out.h = Math.round(resizingPos.h);\n  }\n\n  if (draggingPos) {\n    out.y = Math.round(draggingPos.y);\n    out.x = Math.round(draggingPos.x);\n  }\n\n  return out;\n}","import { CompactType, GridLayoutSetting } from '../types';\nimport assign = require(\"lodash.assign\");\nimport { DEFAULT_LAYOUT_SETTING } from '../default-common-setting';\n\nexport const DEFAULT_GRID_LAYOUT_SETTING: GridLayoutSetting = assign({}, DEFAULT_LAYOUT_SETTING, {\n  padding: [10, 10],\n  rowHeight: 32,\n  breakpoints: { lg: 1200, md: 992, sm: 768, xs: 576, xxs: 0 },\n  cols: { lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 },\n  space: 10,\n  compactType: CompactType.VERTICAL,\n  restrict: true\n});","import * as React from 'react';\nimport classNames = require(\"classnames\");\nimport { DragSource, DragSourceConnector, DragSourceMonitor, ConnectDragSource } from 'react-dnd';\nimport { DND_TYPES } from './react-dnd-types';\nimport { setTransform } from './utils';\n\nimport { LayoutProps } from './types';\n\nexport interface DragProps {\n  connectDragSource?: ConnectDragSource,\n  isDragging?: boolean,\n  offset?: {x: number, y: number}\n}\n\nexport interface DragHandlers {\n  disableInteract?: boolean;\n  onMoveStart: (id: string) => void;\n  onMoving: (id: string, dx: number, dy: number) => void;\n  onMoveEnd: (id: string, dx: number, dy: number) => void;\n}\n\nexport type DraggableProps = DragProps & LayoutProps & DragHandlers;\n\nfunction getDisplayName(WrappedComponent) {\n  return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n}\n\nexport default function draggable(injectProps?) {\n  return (WrapperComponent: React.ComponentClass<LayoutProps>) => {\n    const spec = {\n      beginDrag: (props) => {\n        if (typeof props.onMoveStart === 'function') {\n          props.onMoveStart(props.layout.id);\n        }\n        return {\n          layout: props.layout,\n          width: props.pos.w,\n          height: props.pos.h\n        };\n      },\n      endDrag: (props, monitor) => {\n        if (typeof props.onMoveEnd === 'function') {\n          const { layout } = props;\n          const offset = monitor.getDifferenceFromInitialOffset();\n          props.onMoveEnd(layout.id, offset.x, offset.y);\n        }\n      },\n      canDrag: (props) => {\n        if (props.disableInteract) {\n          return false;\n        }\n        if(props.layout && props.layout.setting) {\n          return props.layout.setting.draggable !== false;\n        }\n        return true;\n      }\n    }\n\n    const collect = (connect: DragSourceConnector, monitor: DragSourceMonitor) => {\n      return {\n        connectDragSource: connect.dragSource(),\n        isDragging: monitor.isDragging()\n      }\n    }\n\n    class DraggableComponent extends React.PureComponent<DraggableProps, {}> {\n      static displayName = `react-dnd-draggable(${getDisplayName(WrapperComponent)})`;\n\n      render() {\n        const { pos, isDragging, className, style, connectDragSource, appMode, ...passThroughProps } = this.props;\n\n        const displayPos = {\n          x: 0,\n          y: 0,\n          w: pos.w,\n          h: pos.h\n        };\n        const placeholderStyle = {\n          position: 'absolute',\n          left: 0,\n          top: 0,\n          width: pos.w,\n          height: pos.h,\n          backgroundColor: '#F1F1F1',\n          outline: '1px solid #55BCFF',\n          boxShadow: 'inset 0 0 8px 0 rgba(0,0,0,0.15)'\n        }\n        const mergedClass = classNames('exb-draggable', className);\n\n        return (\n          connectDragSource &&\n          connectDragSource(\n            <div className={mergedClass} style={setTransform(pos)}>\n              <WrapperComponent pos={displayPos} appMode={appMode} style={{\n                position: 'relative'\n              }} {...injectProps} {...passThroughProps}/>\n              {isDragging && <div style={placeholderStyle as any}></div>}\n            </div>\n          )\n        );\n      }\n    }\n\n    return DragSource(DND_TYPES.LAYOUT, spec, collect)(DraggableComponent);\n  };\n}","import * as React from 'react';\n\nimport {store} from './store';\nimport {IMAppConfig, IMWidgetJson} from './types/app-config';\nimport {MessageActionProperty} from './types/manifest';\nimport {getAllWidgets} from './utils/app-config';\nimport {Message, DummyMessageAction, MessageAction} from './message/base-types';\nimport {amdRequire} from './amd-loader';\n\nexport default class MessageManager{\n\n  static instance: MessageManager;\n  static getInstance(){\n    if(!MessageManager.instance){\n      MessageManager.instance = new MessageManager();\n      window._messageManager = MessageManager.instance;\n    }\n    return MessageManager.instance;\n  }\n\n  private messageActions: DummyMessageAction[] = [];\n  private messageActionClasses: {[actionName: string]: typeof DummyMessageAction} = {};\n\n  createMessageActions(appConfig: IMAppConfig): Promise<any>{\n    let actionPromises = [];\n    getAllWidgets(appConfig).forEach(w => {\n      if(w.manifest.messageActions){\n        w.manifest.messageActions.forEach(action => {\n          actionPromises.push(this.createMessageAction(w, action));\n        });\n      }\n    });\n\n    return Promise.all(actionPromises);\n  }\n\n  createMessageAction(widgetJson: IMWidgetJson, actionProp: MessageActionProperty): Promise<MessageAction>{\n    let action: MessageAction = this.messageActions.filter(action => action.widgetId === widgetJson.id && action.name === actionProp.name)[0];\n    if(action){\n      return Promise.resolve(action);\n    }else{\n      return this.loadMessageActionClass(widgetJson, actionProp).then(ActionClass => {\n        action = new ActionClass(widgetJson.id, actionProp.name);\n        this.messageActions.push(action);\n        return Promise.resolve(action);\n      });\n    }\n  }\n\n  loadMessageActionClass(widgetJson: IMWidgetJson, actionProp: MessageActionProperty): Promise<typeof DummyMessageAction>{\n    if(this.messageActionClasses[actionProp.name]){\n      return Promise.resolve(this.messageActionClasses[actionProp.name]);\n    }\n    var uri = widgetJson.context.amdFolder + 'dist/' + actionProp.uri;\n    return amdRequire(uri).then(ActionClass => {\n      this.messageActionClasses[actionProp.name] = ActionClass.default;\n      return ActionClass.default;\n    });\n  }\n\n  publishMessage(message: Message){\n    let messagesConfig = store.getState().appConfig.messages;\n    let matchMessageCfg = messagesConfig && messagesConfig.filter(m => m.messageType === message.type && m.widgetId === message.widgetId)[0];\n    if(!matchMessageCfg){\n      return;\n    }\n\n    matchMessageCfg.actions.forEach(actionJson => {\n      let action = this.messageActions.filter(action => action.widgetId === actionJson.widgetId && action.name === actionJson.actionName)[0];\n      if(!action){\n        console.error(`Not find action: ${action.name}`);\n        return;\n      }\n\n      if(!action.filterMessage(message)){\n        return;\n      }\n\n      action.onExecute(message, actionJson.config);\n    });\n  }\n}\n","export interface Location {\n  pathname: string;\n  search: string;\n  hash: string;\n}\n\nexport function parsePath(path: string): Location {\n  var pathname = path || '/';\n  var search = '';\n  var hash = '';\n\n  var hashIndex = pathname.indexOf('#');\n  if (hashIndex !== -1) {\n    hash = pathname.substr(hashIndex);\n    pathname = pathname.substr(0, hashIndex);\n  }\n\n  var searchIndex = pathname.indexOf('?');\n  if (searchIndex !== -1) {\n    search = pathname.substr(searchIndex);\n    pathname = pathname.substr(0, searchIndex);\n  }\n\n  return {\n    pathname: pathname,\n    search: search === '?' ? '' : search,\n    hash: hash === '#' ? '' : hash,\n  };\n};\n\nexport function isAbsoluteUrl(url: string){\n  return /(^http:)|(^https:)|(^\\/\\/)/.test(url);\n}","import DataSourceManager from '../data-source-manager';\nimport { stat } from 'fs';\nimport { addThemeManifestProperies } from '../utils/app-config';\n\nexport enum DataSourceStatus{\n  //for remote query\n  Unloaded = 'UNLOADED',\n  UnloadedLoading = 'UNLOADED_LOADING',\n  LoadedLoading = 'LOADED_LOADING',\n  Loaded = 'LOADED',\n\n  //for remote push\n  Closed = 'CLOSED',\n  Connecting = 'CONNECTING',\n  Connected = 'CONNECTED',\n  Closing = 'CLOSING',\n\n  //for client DS, we don't define status\n}\n\nexport interface DataRecord{\n  getData: () => any;\n}\n\nexport interface DataSource{\n  id: string\n  label: string\n  type: string\n  status?: DataSourceStatus;\n  dataSourceManager?: DataSourceManager;\n  isDataSourceSet: boolean;\n  \n  //for data source\n  getRecords?: () => DataRecord[];\n  getCurrentRecord?: () => DataRecord;\n  getCurrentRecords?: () => DataRecord[];\n  getCurrentRecordIndexes?: () => number[];\n  nextRecord?: () => DataRecord;\n  prevRecord?: () => DataRecord;\n  selectRecord?: (index: number, layerId?: string) => void;\n  selectRecords?: (indexes: number[], layerId?: string) => void; // TODO\n  findRecord?: (index: number) => DataRecord;\n  clearData?: () => void;\n  getDataSchema?: () => any;\n  init: () => void;\n  updateStatus?: (statue: DataSourceStatus) => void;\n\n  //for data source set\n  getDataSources?: () => DataSource[];\n\n  // for feature layer based date source\n  highlightRecord?: (objectId: number, layerId?: string) => void;\n\n  destroy: () => void;\n}\n\nexport interface EditableDataSource extends DataSource {\n  addRecord?: (record: DataRecord) => Promise<DataRecord>;\n  updateRecord?: (record: DataRecord) => Promise<DataRecord>;\n  deleteRecord?: (index: number) => Promise<number>;\n  // TODO add/update/delete multiple records\n}\n\nexport abstract class AbstractDataSource implements DataSource{\n  id: string\n  label: string\n  type: string\n  status?: DataSourceStatus;\n  dataSourceManager: DataSourceManager;\n  isDataSourceSet: boolean = false;\n\n  protected records: DataRecord[] = [];\n  protected currentIndexes: number[] = [];\n\n  abstract getDataSchema();\n  abstract init();\n\n  updateStatus(status: DataSourceStatus){\n    this.status = status;\n    if(this.dataSourceManager) this.dataSourceManager.onDataSourceStatusChanged(this.id, status);\n  }\n\n  getRecords(): DataRecord[]{\n    return this.records;\n  }\n\n  getCurrentRecord(): DataRecord {\n    return this.records[this.currentIndexes[0]];\n  }\n\n  getCurrentRecords(): DataRecord[] {\n    return this.currentIndexes.map( index => this.records[index] );\n  }\n\n  getCurrentRecordIndexes(): number[] {\n    return this.currentIndexes;\n  }\n\n  nextRecord(): DataRecord {\n    if(this.currentIndexes.length > 1) {\n      console.warn('method \"nextRecord\" only works when single record is selected');\n      return null;\n    }\n\n    if(this.currentIndexes.indexOf(this.records.length - 1)){\n      throw Error('Reach the end of data.');\n    }\n\n    this.currentIndexes[0] ++;\n    return this.getCurrentRecord();\n  }\n\n  prevRecord(): DataRecord{\n    if(this.currentIndexes.length > 1) {\n      console.warn('method \"prevRecord\" only works when single record is selected');\n      return null;\n    }\n\n    if(this.currentIndexes.indexOf(0)){\n      throw Error('Reach the start of data.');\n    }\n\n    this.currentIndexes[0] --;\n    return this.getCurrentRecord();\n  }\n\n  findRecord(index: number): DataRecord {\n    return this.records[index];\n  }\n\n  clearData(): void{\n    this.records = [];\n    this.currentIndexes =[];\n  }\n\n  destroy(){}\n}\n\nexport interface RemoteQueryDataSource extends DataSource{\n  url: string;\n\n  query(query): Promise<DataRecord[]>;\n}\n\nexport interface ClientDataSource extends DataSource{\n\n}\n","import * as React from 'react';\n\nimport {store} from './store';\nimport {DataSource, DataSourceStatus, AbstractDataSource, RemoteQueryDataSource, DataRecord, EditableDataSource} from './data-source/base-types';\nimport {IMDataSourceJson} from './types/app-config';\nimport ExtensionManager from './extension-manager';\nimport {DataSourceFactory, ExtensionPoints} from './extension-spec/extension-spec';\nimport {dataSourceStatusChanged, dataSourceCurrentIndexesChanged} from './app-actions';\nimport {changeQueryObject} from './browser-history';\n\n// TODO: move this to the hub extension once we create one\nimport { IFeature, IUser } from '@esri/arcgis-rest-common-types';\nimport { queryFeatures, IQueryFeaturesRequestOptions, addFeatures, IAddFeaturesRequestOptions  } from '@esri/arcgis-rest-feature-service';\nimport SessionManager from './session-manager';\n\n// TODO: move this to the hub extension once we create one\nexport enum DataSourceTypes{\n  HubAnnotations = 'HUB_ANNOTATIONS'\n}\n\n//the supported ds in jimu-core\nconst supportDataSourceTypes = [\n  // TODO: remove this once we have a hub extension\n  DataSourceTypes.HubAnnotations\n] as string[];\n\n// TODO: move this to the hub extension once we create one\nexport class HubAnnotationDataRecord implements DataRecord{\n  feature: IFeature\n  user: IUser\n\n  constructor(feature: IFeature, user?: IUser){\n    this.feature = feature;\n    this.user = user;\n  }\n\n  getData(){\n    return this.user ? { user: this.user, ... this.feature.attributes } : this.feature.attributes;\n  }\n}\n\n// TODO: move this to the hub extension once we create one\nexport class HubAnnotationsDataSource extends AbstractDataSource implements RemoteQueryDataSource, EditableDataSource {\n  url: string;\n\n  constructor(dsConfig: IMDataSourceJson){\n    super();\n    this.url = dsConfig.url;\n    this.type = DataSourceTypes.HubAnnotations;\n    this.id = dsConfig.id;\n  }\n\n  init(){\n    this.updateStatus(DataSourceStatus.Unloaded);\n  }\n\n  query(query: IQueryFeaturesRequestOptions): Promise<HubAnnotationDataRecord[]>{\n    const sessionManager = SessionManager.getInstance();\n    // merge in default url and authentication into query options\n    const options: IQueryFeaturesRequestOptions = {\n      authentication: sessionManager.getSession(),\n      url: this.url,\n      ...query\n    }\n    if(!this.status || this.status === DataSourceStatus.Unloaded){\n      this.updateStatus(DataSourceStatus.UnloadedLoading);\n    }else{\n      this.updateStatus(DataSourceStatus.LoadedLoading);\n    }\n    return queryFeatures(options).then(response => {\n      let records = response.features.map(feature => {\n        // TODO: get user from related records in response\n        let user: IUser;\n        return new HubAnnotationDataRecord(feature, user);\n      });\n      this.records = records;\n      this.updateStatus(DataSourceStatus.Loaded);\n      return records;\n    })\n    // retry if request was unauthenticated and the item is not shared with everyone\n    .catch(sessionManager.handleAuthError.bind(sessionManager));\n  }\n\n  selectRecord(index: number): void {\n    this.currentIndexes = [index];\n    this.dataSourceManager.onDataSourceCurrentIndexesChanged(this.id, [index]);\n  }\n\n  addRecord(record: HubAnnotationDataRecord) {\n    const sessionManager = SessionManager.getInstance();\n    const attributes = record.getData();\n    const feature: IFeature = {\n      attributes\n    };\n    const options: IAddFeaturesRequestOptions = {\n      url: this.url,\n      adds: [feature],\n      authentication: sessionManager.getSession()\n    }\n    return addFeatures(options)\n    .then(response => {\n      // return a new record with the OBJECTID\n      const objectId = response.addResults[0].objectId;\n      attributes.OBJECTID = objectId;\n      return new HubAnnotationDataRecord({\n        attributes       \n      });\n    })\n    // retry if request was unauthenticated\n    .catch(sessionManager.handleAuthError.bind(sessionManager));\n  }\n\n  addAnnotation(description: string, target: string, feature_id?: number) {\n    // use the current user as the author\n    const session = SessionManager.getInstance().getSession();\n    // TODO: what if user is not logged in? throw error?\n    const author = session.username;\n    // use this application as the source of the comment\n    const source = window && window.location.toString();\n    const record = new HubAnnotationDataRecord({\n      attributes: {\n        author,\n        source,\n        target,\n        feature_id,\n        description,\n        created_at: new Date().getTime(),\n        status: 'pending'\n      }\n    });\n    return this.addRecord(record);\n  }\n\n  getDataSchema(){}\n\n}\n\nexport default class DataSourceManager{\n\n  static instance: DataSourceManager;\n  static getInstance(){\n    if(!DataSourceManager.instance){\n      DataSourceManager.instance = new DataSourceManager();\n      window._dataSourceManager = DataSourceManager.instance;\n    }\n    return DataSourceManager.instance;\n  }\n\n  private dataSources: {[dsId: string]: DataSource} = {};\n\n  getDataSource(dsId: string): DataSource{\n    return this.dataSources[dsId];\n  }\n\n  destroyDataSource(dsId: string){\n    if(this.dataSources[dsId]){\n      this.dataSources[dsId].destroy();\n      delete this.dataSources[dsId];\n    }\n  }\n  \n  createAllDataSources(): DataSource[]{\n    Object.keys(store.getState().appConfig.dataSources).forEach(dsId => {\n      if(!this.dataSources[dsId]){\n        this.createDataSource(dsId);\n      }\n    });\n\n    return Object.keys(this.dataSources).map(dsId => this.dataSources[dsId]);\n  }\n\n  /**\n   * \n   * @param ds if the ds is JSON, the ds may not be in app config, this is the case that widget can use internal data source. \n   */\n  createDataSource(dsId: string): DataSource;\n  createDataSource(dsJson: IMDataSourceJson): DataSource;\n  createDataSource(ds: string | IMDataSourceJson): DataSource{\n    let dsJson:IMDataSourceJson;\n\n    if(typeof ds === 'string'){\n      dsJson = store.getState().appConfig.dataSources[ds];\n    }else{\n      dsJson = ds;\n    }\n\n    if(!dsJson){\n      throw Error('Unknown data source id:' + dsJson.id);\n    }\n\n    let dsObj: DataSource;\n    if(supportDataSourceTypes.indexOf(dsJson.type) > -1){\n      // TODO: remove this once we have a hub extension\n      if (dsJson.type === DataSourceTypes.HubAnnotations) {\n        dsObj = this.createHubAnnotationsDataSource(dsJson);\n      }\n    }else{\n      let dsFactories: DataSourceFactory[] = ExtensionManager.getInstance().getExtensions(ExtensionPoints.DataSourceFactory) as DataSourceFactory[];\n      let dsFactory: DataSourceFactory = dsFactories.filter(f => f.getSupportDataSourceTypes().indexOf(dsJson.type) > -1)[0];\n      if(!dsFactory){\n        throw Error('Unknown data source type:' + dsJson.type);\n      }\n      dsObj = dsFactory.createDataSource(dsJson);\n    }\n    if (dsObj) {\n      dsObj.dataSourceManager = this;\n      dsObj.init();\n\n      this.dataSources[dsJson.id] = dsObj;\n    }\n    return dsObj;\n  }\n\n  onDataSourceStatusChanged(dsId: string, status: DataSourceStatus){\n    store.dispatch(dataSourceStatusChanged(dsId, status));\n  }\n\n  onDataSourceCurrentIndexesChanged(dsId: string, indexes: number[]){\n    if(store.getState().dataSourcesInfo[dsId] && store.getState().dataSourcesInfo[dsId].currentIndexes && \n      store.getState().dataSourcesInfo[dsId].currentIndexes[0] === indexes[0]){\n      return;\n    }\n\n    let urlDs = store.getState().queryObject.data;\n    let oldDs: string[] = [];\n    if(urlDs){\n      oldDs = urlDs.split(',');\n    }\n    let newDs = [];\n    let added = false;\n    oldDs.forEach(od => {\n      let oId = od.split(':')[0];\n      let oi = od.split(':')[1];\n      if(oId === dsId){\n        newDs.push(`${dsId}:${indexes[0]}`); //TODO put 1 now\n        added = true;\n      }else{\n        newDs.push(od);\n      }\n    });\n    if(!added){\n      newDs.push(`${dsId}:${indexes[0]}`)\n    }\n    changeQueryObject({data: newDs.join(',')}, true);\n\n    store.dispatch(dataSourceCurrentIndexesChanged(dsId, indexes));\n  }\n\n  // TODO: remove this once we have a hub extension\n  private createHubAnnotationsDataSource(dsConfig: IMDataSourceJson): HubAnnotationsDataSource {\n    return new HubAnnotationsDataSource(dsConfig);\n  }\n}\n","import * as React from 'react';\n\nimport {AllWidgetProps} from './types/props';\nimport {IMState} from './types/state';\nimport {getWidgetCallbackNamesFromWidgetState, logShallowDiff} from './utils/utils';\nimport {DataSource} from './data-source/base-types';\n\n\nexport default class BaseWidget<P extends AllWidgetProps<{}> = AllWidgetProps<{}>, S = {}> extends React.PureComponent<P, S>{\n  /**\n   * By default, the props in \"WidgetInjectedProps\" will be injected into widget props. To map more props, please use this function.\n   */\n  static mapExtraStateProps: (state: IMState, ownProps?: AllWidgetProps<{}>) => any;\n\n  showDiffLog: boolean = false;\n\n  onOpen(){\n    console.log('base widget onOpen');\n  }\n\n  onClose(){\n  }\n\n  onActive(){\n  }\n\n  onDeActive(){\n  }\n\n  componentDidUpdate(prevProps: P, prevState: S){\n    let widgetState = this.props.state;\n    let prevWidgetState = prevProps.state;\n\n    if(this.showDiffLog){\n      logShallowDiff(`Widget ${this.props.manifest.name} Props diff:`, this.props, prevProps);\n      logShallowDiff(`Widget ${this.props.manifest.name} State diff:`, this.state, prevState);\n    }\n\n    let fn = getWidgetCallbackNamesFromWidgetState(widgetState, prevWidgetState);\n    if(!fn){\n      return;\n    }\n    \n    if(typeof fn === 'string'){\n      this[fn]();\n    }else if(Array.isArray(fn)){\n      fn.forEach(f => this[f]());\n    }else{\n      console.error('Bad widget callback name.');\n    }\n  }\n}\n","import {ImmutableObject, Immutable, ImmutableArray, ImmutableArrayMixin, ImmutableObjectMixin} from 'seamless-immutable';\nimport * as SeamlessImmutable from 'seamless-immutable';\nimport {WidgetManifest} from './manifest';\n\nexport enum ContainerType{\n  //use lower case here to match the keys in appconfig.json\n  Page = 'pages',\n  View = 'views',\n  SharedArea = 'sharedArea',\n}\n\nexport interface WidgetContext{\n  folderUrl: string;\n  amdFolder: string;\n  isRemote: boolean;\n}\nexport interface LayoutElementJson{\n  id: string;\n  parentId?: string;\n  pos: ImmutableObject<{\n    x?: number;\n    y?: number;\n    w?: number;\n    h?: number;\n  }>,\n  type: string;\n  setting?: any;\n}\nexport type IMLayoutElementJson = ImmutableObject<LayoutElementJson>;\n\nexport interface LayoutJson{\n  [layoutElementId: string]: string & IMLayoutElementJson;\n}\nexport type IMLayoutJson = ImmutableObject<LayoutJson>;\n\nexport type IMWidgetContext = ImmutableObject<WidgetContext>;\n\nexport interface WidgetJsonWithoutConfig{\n  id: string;\n  icon: string;\n  label: string;\n  visible: boolean;\n  index?: number;\n  uri: string; //do not end with \"/\"\n  itemId?: string;\n  context: IMWidgetContext;\n  manifest: WidgetManifest;\n  version: string;\n  useDataSources: string[];\n  outputDataSources: string[];\n}\n\nexport interface WidgetJson extends WidgetJsonWithoutConfig{\n  config: any;\n}\nexport type IMWidgetJson = ImmutableObject<WidgetJson>;\n\nexport interface AbstractContainerJson{\n  layout: string;\n  mobileLayout?: string;\n  widgets: ImmutableArray<string>;\n  visible?: boolean;\n}\nexport type IMAbstractContainerJson = ImmutableObject<AbstractContainerJson>;\n\nexport interface SectionJson{\n  id: string;\n  visible?: boolean;\n  views: ImmutableArray<string>; //show \"default\" view by default\n}\nexport type IMSectionJson = ImmutableObject<SectionJson>;\n\nexport interface ViewJson extends AbstractContainerJson{\n  id: string;\n  label: string;\n\n  mobileTheresholdSize?: {width?: number, height?: number};\n  desktopThresholdSize?: {width?: number, height?: number};\n  mobileLayoutCompact?: string;\n  desktopLayoutCompact?: string;\n\n  sections?: ImmutableArray<string>;\n}\nexport type IMViewJson = ImmutableObject<ViewJson>;\n\nexport interface PageJson extends AbstractContainerJson{\n  id: string;\n  label: string;\n  sharedArea: ImmutableObject<Partial<{\n    header: boolean;\n    footer: boolean;\n    leftArea: boolean;\n    rightArea: boolean;\n  }>>;\n\n  sections?: ImmutableArray<string>;\n}\nexport type IMPageJson = ImmutableObject<PageJson>;\n\nexport interface DataSourceJson{\n  id: string\n  label: string\n  type: string;\n\n  url?: string;\n\n  //for item\n  portalUrl?: string; //if no portalUrl, default to app config's portalUrl\n  itemId?: string;\n\n  //for map\n  layers?: ImmutableArray<IMDataSourceLayerJson>;\n\n  // for layer view\n  layerId?: string\n}\nexport type IMDataSourceJson = ImmutableObject<DataSourceJson>;\n\nexport interface DataSourceLayerJson{\n  id: string;\n  title: string;\n  url: string;\n}\nexport type IMDataSourceLayerJson = ImmutableObject<DataSourceLayerJson>;\n\nexport interface ActionJson{\n  description: string;\n  widgetId: string;\n  actionName: string;\n  config: any;\n}\nexport type IMActionJson = ImmutableObject<ActionJson>;\n\nexport interface MessageJson{\n  widgetId: string;\n  messageType: String;\n  actions: ImmutableArray<IMActionJson>\n}\nexport type IMMessageJson = ImmutableObject<MessageJson>;\n\nexport interface AttributesJson{\n  logo: string;\n  title: string;\n  subTitle?: string;\n\n  /**\n   * These attributes are for arcgis only, so they should be defined in jimu-arcgis.\n   * The reason that We put them here is: we can see a full app config in one place.\n   */\n  portalUrl?: string;\n  geometryService?: string;\n}\nexport type IMAttributesJson = ImmutableObject<AttributesJson>;\n\nexport interface AppConfig{\n  pages: ImmutableObject<{[pageId: string]: IMPageJson}>; //show \"default\" page by default\n\n  layouts: ImmutableObject<{[layoutId: string]: IMLayoutJson}>;\n\n  sections?: ImmutableObject<{[sectionId: string]: IMSectionJson}>;\n\n  views?: ImmutableObject<{[viewId: string]: IMViewJson}>;\n\n  widgets: ImmutableObject<{[widgetId: string]: IMWidgetJson}>;\n\n  sharedArea: ImmutableObject<{\n    header?: ImmutableObject<{\n      widgets: ImmutableArray<string>\n    }>;\n    footer?: ImmutableObject<{\n      widgets: ImmutableArray<string>\n    }>;\n    leftArea?: ImmutableObject<{\n      widgets: ImmutableArray<string>\n    }>;\n    rightArea?: ImmutableObject<{\n      widgets: ImmutableArray<string>\n    }>;\n    layout: string; //the layout for control these elements\n    mobileLayout?: string;\n  }>;\n\n  skin: string;\n  dataSources?: ImmutableObject<{[dsId: string]: IMDataSourceJson}>;\n\n  messages?: ImmutableArray<IMMessageJson>;\n\n  attributes: IMAttributesJson;\n}\n\nexport type IMAppConfig = ImmutableObject<AppConfig>;\n\nexport interface AppConfigDiff{\n  removedWidgets: string[]\n}","import {amdRequire} from './amd-loader';\n\nexport default class I18NManager{\n\n  static instance: I18NManager;\n\n  static getInstance(){\n    if(!I18NManager.instance){\n      I18NManager.instance = new I18NManager();\n    }\n    return I18NManager.instance;\n  }\n\n  loadNls(nlsModle: string): Promise<any>{\n    return amdRequire(`${nlsModle}`).then(rootNls => {\n      let locale = window.jimuConfig.locale;\n      if(locale === 'en'){\n        return rootNls.root;\n      }\n\n      if(!rootNls[locale]){\n        return rootNls.root;\n      }\n\n      let segs = nlsModle.split('/');\n      let folder = segs.slice(0, segs.length - 2).join('/');\n      let file = segs[segs.length - 1];\n      //TODO get correct locale.\n      return amdRequire(`${folder}/${locale}/${file}`).then(localeNls => {\n        //TODO correct strings merge.\n        return Object.assign(rootNls.root, localeNls);\n      });\n    });\n  }\n}","import Graphic = require('esri/Graphic');\n\nexport enum MessageType {\n  FeatureSelectionChange = 'FEATURE_SELECTION_CHANGE',\n  StringSelectionChange = 'STRING_SELECTION_CHANGE',\n};\n\nexport interface Message{\n  type: MessageType;\n  widgetId: string;\n}\n\nexport class StringSelectionChangeMessage implements Message{\n  type: MessageType = MessageType.StringSelectionChange;\n  widgetId: string;\n\n  str: string;\n\n  constructor(widgetId: string, str: string){\n    this.widgetId = widgetId;\n    this.str = str;\n  }\n}\n\nexport class FeatureSelectionChangeMessage implements Message{\n  type: MessageType = MessageType.FeatureSelectionChange;\n  widgetId: string;\n  feature: Graphic;\n\n  constructor(widgetId: string, feature: Graphic) {\n    this.widgetId = widgetId;\n    this.feature = feature;\n  }\n}\n\n///////////////////////////////\n\nexport abstract class MessageAction{\n  name: string;\n  widgetId: string;\n\n  constructor(widgetId: string, name: string){\n    this.name = name;\n    this.widgetId = widgetId;\n  }\n\n  /**\n   * Whether the tyep of message can trigger this action.\n   * This method will be used in builder to filter the available actions.\n   * @param messageType \n   */\n  abstract filterMessageType(messageType: MessageType): boolean;\n\n  /**\n   * whether a specific message will trigger this action.\n   * This method will be used when a widget publish a message.\n   */\n  abstract filterMessage(message: Message): boolean;\n\n  abstract onExecute(message: Message, actionConfig?: any): Promise<boolean> | boolean;\n\n  get id(): string{\n    return `${this.widgetId}-${this.name}`;\n  }\n}\n\n/**\n * this class is used for type check\n */\nexport class DummyMessageAction extends MessageAction{\n  filterMessageType(messageType: MessageType): boolean{return true;}\n\n  filterMessage(message: Message): boolean{return true;}\n\n  onExecute(message: Message, actionConfig?: any): Promise<boolean> | boolean{return true;}\n}","import * as React from 'react';\nimport assign = require(\"lodash.assign\");\nimport { Layout, FixedLayoutSetting } from '../types';\nimport { DEFAULT_FIX_LAYOUT_SETTING } from './default-setting';\nimport { LayoutItem } from '../layout-item';\nimport * as utils from '../utils';\nimport './style/layout.scss';\nimport { AppMode } from '../../types/constants';\n\ninterface Props {\n  layout?: Layout;\n  appMode: AppMode;\n  width: number;\n  height: number;\n}\n\nexport class FixedLayoutViewer extends React.Component<Props, {}> {\n  setting: FixedLayoutSetting;\n\n  constructor(props) {\n    super(props);\n\n    this.setting = assign({}, DEFAULT_FIX_LAYOUT_SETTING, this.props.layout.setting);\n  }\n\n  _processLayoutItem(l: Layout, key: number) {\n    const {width, height, appMode} = this.props;\n    const setting = assign({}, DEFAULT_FIX_LAYOUT_SETTING, l.setting);\n    const pos = utils.calPixelPosition(l.pos, width, height, setting);\n    return <LayoutItem\n      key={key}\n      layout={l}\n      pos={pos}\n      appMode={appMode}>\n    </LayoutItem>\n  }\n\n  render() {\n    const layouts = this.props.layout.content || [];\n    return <div className='fixed-layout' >\n        {layouts.map((layoutItem, index) => {\n          return this._processLayoutItem(layoutItem, index);\n        })}\n      </div>\n  }\n}\n","import * as React from 'react';\nimport classNames = require(\"classnames\");\nimport assign = require('lodash.assign');\nimport { DEFAULT_GRID_LAYOUT_SETTING } from './default-setting';\nimport * as gridUtils from \"./grid-utils\";\nimport { getLayoutItem } from '../utils';\nimport { LayoutItem } from \"../layout-item\";\nimport { LayoutType, GridLayoutSetting } from '../types';\nimport './style/grid.scss';\n\n// Types\nimport {\n  CompactType,\n  EventCallback,\n  Layout,\n} from '../types';\n\ntype State = {\n  activeDrag?: Layout,\n  width: number,\n  numOfCols: number,\n  breakpoint: string,\n  setting: GridLayoutSetting,\n  pixelLayouts: Array<Layout>,\n  gridLayouts: Array<Layout>\n};\n\nexport type Props = {\n  className?: string,\n  style?: Object,\n  width: number,\n  autoSize?: boolean,\n  layout?: Layout,\n  children?: any\n};\n// End Types\n\nexport class GridLayoutViewer extends React.Component<Props, State> {\n  static displayName = \"GridLayout\";\n\n  static defaultProps: Partial<Props> = {\n    autoSize: true,\n    className: \"\",\n    style: {},\n    layout: null\n  };\n\n  state: State = {\n    width: 0,\n    numOfCols: -1,\n    activeDrag: null,\n    pixelLayouts: [],\n    gridLayouts: [],\n    breakpoint: '',\n    setting: DEFAULT_GRID_LAYOUT_SETTING\n  };\n\n  static getDerivedStateFromProps(nextProps: Props, prevState: State) {\n    const layoutSetting = assign({}, DEFAULT_GRID_LAYOUT_SETTING, nextProps.layout.setting);\n    const { space, padding } = layoutSetting;\n    const breakpoint = gridUtils.getBreakpointFromWidth(layoutSetting.breakpoints, nextProps.width);\n    const colNo = gridUtils.getColsFromBreakpoint(breakpoint, layoutSetting.cols);\n    const colWidth = (nextProps.width - space * (colNo - 1) - padding[0] * 2) / colNo;\n    const gridLayouts = gridUtils.collectLayoutsAtBreakpoint(nextProps.layout.content, breakpoint, layoutSetting);\n    let layouts = gridUtils.generateResponsiveLayout(\n      gridLayouts,\n      colNo,\n      layoutSetting.compactType\n    );\n    const pixelLayouts = layouts.map(layoutItem => {\n      return {\n        id: layoutItem.id,\n        pos: gridUtils.toPixelPosition(layoutItem.pos, layoutSetting, colWidth)\n      };\n    });\n    return {\n      breakpoint: breakpoint,\n      pixelLayouts: pixelLayouts,\n      gridLayouts: layouts,\n      width: nextProps.width,\n      numOfCols: colNo,\n      setting: layoutSetting\n    };\n  }\n\n  /**\n   * Calculates a pixel value for the container.\n   * @return {String} Container height in pixels.\n   */\n  containerHeight() {\n    if (!this.props.autoSize) {\n      return;\n    }\n    const { padding, space, rowHeight } = this.state.setting;\n    const nbRow = gridUtils.bottom(this.props.layout.content || []);\n    const containerPaddingY = padding\n      ? padding[1]\n      : space;\n    return (\n      nbRow * rowHeight +\n      (nbRow - 1) * space +\n      containerPaddingY * 2 +\n      \"px\"\n    );\n  }\n\n  /**\n   * Given a grid item, set its style attributes & surround in a <Draggable>.\n   */\n  processGridItem(l: Layout, key: number) {\n    const content = this.props.layout.content || [];\n    let layoutItem = getLayoutItem(this.state.gridLayouts, l.id);\n    if (!layoutItem) {\n      return null;\n    }\n\n    return <LayoutItem\n        key={key}\n        layout={layoutItem}\n        pos={l.pos}>\n      </LayoutItem>\n  }\n\n  render() {\n    const { className, style } = this.props;\n    const { pixelLayouts, numOfCols } = this.state;\n\n    const mergedClassName = classNames(\"react-grid-layout\", className);\n    const mergedStyle = {\n      height: this.containerHeight(),\n      ...style\n    };\n\n    return (\n      <div className={mergedClassName} style={mergedStyle as any}>\n        {pixelLayouts.map((layoutItem, index) => {\n          return this.processGridItem(layoutItem, index);\n        })}\n      </div>\n    );\n  }\n}\n","\nimport * as React from 'react';\nimport assign = require(\"lodash.assign\");\nimport { DEFAULT_LAYOUT_SETTING } from './default-common-setting';\nimport * as ReactRedux from 'react-redux';\nimport {AllLayoutProps, LayoutProps, LayoutStateProps } from '../types/props';\nimport { IMState} from '../types/state';\nimport { Layout, LayoutType, LayoutActionContext } from './types';\nimport { GridLayoutViewer } from './grid-layout/layout-viewer';\nimport { FixedLayoutViewer } from './fixed-layout/layout-viewer';\nimport { SidebarLayout } from './sidebar-layout/layout';\nimport SectionLayout from './section-layout/layout';\nimport { registerLayoutViewer } from './layout-factory';\nimport { LayoutItem } from './layout-item';\nimport LayoutReduxStoreExtension from './global-layout-redux-store-extension';\nimport ExtensionManager from '../extension-manager';\nimport {ExtensionPoints} from '../extension-spec/extension-spec';\nimport { ActionContext } from './action-context';\nimport { AppMode } from '../types/constants';\nimport * as utils from './utils';\nimport {\n  resizeLayouts,\n  updateSetting\n} from './actions/global-layout-actions';\n\nregisterLayoutViewer(LayoutType.FIXED_LAYOUT, FixedLayoutViewer);\nregisterLayoutViewer(LayoutType.GRID_LAYOUT, GridLayoutViewer);\nregisterLayoutViewer(LayoutType.SIDEBAR_LAYOUT, SidebarLayout);\nregisterLayoutViewer(LayoutType.SECTION_LAYOUT, SectionLayout);\n\ninterface State {\n  layout: Layout;\n}\n\nclass JimuLayoutViewer extends React.PureComponent<AllLayoutProps & {width: number, height: number, appMode: AppMode}, State>{\n  // nodeRef;\n  // mounted: boolean;\n  // _debouncedResize;\n\n  state: State = {\n    layout: null,\n  }\n\n  static getDerivedStateFromProps(nextProps: AllLayoutProps, prevState: State) {\n    if (nextProps.layout !== prevState.layout) {\n      return {\n        layout: nextProps.layout\n      };\n    }\n    return null;\n  }\n\n  constructor(props){\n    super(props);\n    // this.nodeRef = React.createRef();\n    // this.mounted = false;\n    ExtensionManager.getInstance().registerExtension({\n      epName: ExtensionPoints.ReduxStore,\n      extension: new LayoutReduxStoreExtension()\n    });\n  }\n\n  // componentDidMount() {\n  //   this.mounted = true;\n  //   const node = this.nodeRef.current;\n  //   const rect = node.getBoundingClientRect();\n\n  //   this._debouncedResize = debounce(this.updateDimensions.bind(this), 100);\n  //   window.addEventListener(\"resize\", this._debouncedResize);\n\n  //   this.setState({\n  //     width: rect.width,\n  //     height: rect.height\n  //   });\n  // }\n\n  // componentWillUnmount() {\n  //   window.removeEventListener(\"resize\", this._debouncedResize);\n  // }\n\n  // updateDimensions() {\n  //   const node = this.nodeRef.current;\n  //   const rect = node.getBoundingClientRect();\n  //   this.setState({\n  //     width: rect.width,\n  //     height: rect.height\n  //   });\n  // }\n\n  render(){\n    const actions: LayoutActionContext = {\n      updateSetting: (id, newSetting) => {\n        this.props.dispatch(updateSetting(id, newSetting))\n      },\n      addLayout: () => {},\n      removeLayout: () => {},\n      resizeLayouts: (layouts, breakpoint) => {\n        this.props.dispatch(resizeLayouts(layouts, breakpoint))\n      },\n      activate: () => {},\n      dndLayout: () => {},\n      removeWidget: () => {}\n    };\n\n    // if (!this.mounted) {\n    //   return <div style={style} ref={this.nodeRef}></div>;\n    // }\n    const {layout} = this.state;\n    const {width, height, appMode} = this.props;\n    if (!layout) {\n      return null;\n    }\n    const setting = assign({}, DEFAULT_LAYOUT_SETTING, layout.setting);\n    const layoutPos = utils.calPixelPosition(layout.pos, width, height, setting);\n    const mergedStyle = {\n      ...this.props.style,\n      position: 'relative',\n      margin: '0 auto'\n    }\n    return (\n      <ActionContext.Provider value={actions}>\n        <div className=\"layout\" style={mergedStyle as any}>\n          <LayoutItem style={this.props.style} layout={layout} appMode={appMode}\n            pos={layoutPos}>\n          </LayoutItem>\n        </div>\n      </ActionContext.Provider>\n    );\n  }\n}\n\nconst mapStateToProps = (state: IMState) => {\n  return {\n    appConfig: state.appConfig,\n    appMode: state.appMode\n  }\n};\n\n//connect<IMapStateToProps, IMapDispatchToProps, ICompProps, IReduxState>(mapStateToProps, mapDispatchToProps)\nexport default ReactRedux.connect<LayoutStateProps, {}, LayoutProps & {width: number, height: number}>(mapStateToProps)(JimuLayoutViewer);\n","import * as Immutable from 'seamless-immutable';\nimport * as invariant from 'invariant';\nimport { GlobalLayouts, Layout, LayoutInfo, LayoutType, LayoutMap, Position, OrderAdjustType, FixedLayoutSetting } from './types';\nimport { getMaximumId } from './utils';\n\nexport function findRootLayout(layoutMap: LayoutMap): Layout {\n  let root: Layout = null;\n  Object.keys(layoutMap).some(key => {\n    if (typeof layoutMap[key].parentId === 'undefined') {\n      root = layoutMap[key];\n      return true;\n    }\n  });\n  if (root.type === LayoutType.SIDEBAR_LAYOUT) {\n    return filterMainAreaFromSidebar(root.id, layoutMap);\n  }\n  return root;\n}\n\nfunction filterMainAreaFromSidebar(rootId: string, layoutMap: LayoutMap) {\n  let target: Layout = null;\n  Object.keys(layoutMap).some(key => {\n    const layoutItem = layoutMap[key];\n    if (layoutItem.parentId === rootId && (!layoutItem.setting || !('attach' in layoutItem.setting))) {\n      target = layoutMap[key];\n      return true;\n    }\n  });\n  if (target && target.type === LayoutType.SIDEBAR_LAYOUT) {\n    return filterMainAreaFromSidebar(target.id, layoutMap);\n  }\n  return target;\n}\n\nexport function addWidget(widgetId: string, layoutInfo: LayoutInfo,\n  layouts: GlobalLayouts) {\n  const { layoutId, layoutItemId } = layoutInfo;\n  invariant(layouts[layoutId], `layoutId ${layoutId} missing`);\n  let updatedLayouts = layouts;\n  if(!Immutable.isImmutable(layouts)) {\n    updatedLayouts = Immutable(layouts);\n  }\n\n  if (layoutInfo.layoutItemId) { // add widget into a exsting layout item\n    invariant(layouts[layoutId][layoutItemId], `layoutId ${layoutId}.${layoutItemId} missing`);\n    return updatedLayouts.setIn([layoutId, layoutItemId, 'widgetId'], widgetId);\n  }\n  // create a layout item then add widget\n  const rootLayout = findRootLayout(layouts[layoutId] as LayoutMap);\n  const nextId = getMaximumId(layouts[layoutId] as LayoutMap) + 1;\n  const newLayout: Layout = {\n    id: `${nextId}`,\n    layoutId: layoutId,\n    parentId: rootLayout.id,\n    type: LayoutType.WIDGET,\n    widgetId: widgetId,\n    pos: {x: 0, y: 0, w: 300, h: 200}\n  };\n  if (rootLayout.type === LayoutType.GRID_LAYOUT) {\n    newLayout.pos = {x: 0, y: Infinity, w: 4, h: 3};\n  }\n  return updatedLayouts.setIn([layoutId, `${nextId}`], newLayout);\n}\n\nexport function addSection(sectionId: string, layoutInfo: LayoutInfo, layouts: GlobalLayouts) {\n  const { layoutId, layoutItemId } = layoutInfo;\n  invariant(layouts[layoutId], `layoutId ${layoutId} missing`);\n  let updatedLayouts = layouts;\n  if(!Immutable.isImmutable(layouts)) {\n    updatedLayouts = Immutable(layouts);\n  }\n\n  if (layoutInfo.layoutItemId) { // add widget into a exsting layout item\n    invariant(layouts[layoutId][layoutItemId], `layoutId ${layoutId}.${layoutItemId} missing`);\n    return updatedLayouts.setIn([layoutId, layoutItemId, 'sectionId'], sectionId);\n  }\n  // create a layout item then add widget\n  const rootLayout = findRootLayout(layouts[layoutId] as LayoutMap);\n  const nextId = getMaximumId(layouts[layoutId] as LayoutMap) + 1;\n  const newLayout: Layout = {\n    id: `${nextId}`,\n    layoutId: layoutId,\n    parentId: rootLayout.id,\n    type: LayoutType.SECTION_LAYOUT,\n    sectionId: sectionId,\n    pos: {x: 0, y: 0, w: 300, h: 200}\n  };\n  if (rootLayout.type === LayoutType.GRID_LAYOUT) {\n    newLayout.pos = {x: 0, y: Infinity, w: 4, h: 3};\n  }\n  return updatedLayouts.setIn([layoutId, `${nextId}`], newLayout);\n}\n\nexport function addLayout(layoutId: string, parentId: string, initPosition: Position, layoutType: LayoutType,\nlayouts: GlobalLayouts) {\n  invariant(layouts[layoutId], `layoutId ${layoutId} missing`);\n  let updatedLayouts = Immutable.isImmutable(layouts) ? layouts : Immutable(layouts);\n\n  // create a layout item then add widget\n  const nextId = getMaximumId(layouts[layoutId] as LayoutMap) + 1;\n  const newLayout: Layout = {\n    id: `${nextId}`,\n    layoutId: layoutId,\n    parentId: parentId,\n    type: layoutType,\n    pos: initPosition\n  };\n  return updatedLayouts.setIn([layoutId, `${nextId}`], newLayout);\n}\n\nexport function removeWidget(widgetId: string, layouts: GlobalLayouts) {\n  let updatedLayouts = Immutable.isImmutable(layouts) ? layouts : Immutable(layouts);\n\n  Object.keys(layouts).forEach(layoutId => {\n    Object.keys(layouts[layoutId]).forEach(layoutItemId => {\n      if (layouts[layoutId][layoutItemId].type === LayoutType.WIDGET &&\n        layouts[layoutId][layoutItemId].widgetId === widgetId) {\n        updatedLayouts = updatedLayouts.setIn([layoutId, layoutItemId, 'widgetId'], null);\n      }\n    });\n  });\n  return updatedLayouts;\n}\n\nexport function removeLayout(layoutInfo: LayoutInfo, layouts: GlobalLayouts) {\n  const { layoutId, layoutItemId } = layoutInfo;\n  if (!layouts[layoutId] || !layouts[layoutId][layoutItemId]) {\n    return layouts;\n  }\n  let updatedLayouts = layouts, targetLayout = layouts[layoutId] as LayoutMap;\n  if(!Immutable.isImmutable(layouts)) {\n    updatedLayouts = Immutable(layouts);\n  }\n  if(!Immutable.isImmutable(targetLayout)) {\n    targetLayout = Immutable(targetLayout);\n  }\n\n  const removeDescendants = (itemId: string, layoutMap: LayoutMap) => {\n    let updatedLayoutMap = layoutMap.without(itemId);\n    Object.keys(layoutMap).forEach(key => {\n      if (layoutMap[key].parentId === itemId) {\n        updatedLayoutMap = removeDescendants(key, updatedLayoutMap);\n      }\n    });\n    return updatedLayoutMap;\n  }\n\n  targetLayout = removeDescendants(layoutItemId, targetLayout);\n  return updatedLayouts.set(layoutId, targetLayout);\n}\n\nexport function updateSetting(layoutInfo: LayoutInfo, setting, layouts: GlobalLayouts) {\n  return updateLayout(layoutInfo, null, setting, layouts);\n}\n\nexport function updateLayout(layoutInfo: LayoutInfo, pos: Position, setting, layouts: GlobalLayouts) {\n  const { layoutId, layoutItemId } = layoutInfo;\n  if (!layouts[layoutId] || !layouts[layoutId][layoutItemId]) {\n    return layouts;\n  }\n  let updatedLayouts = Immutable.isImmutable(layouts) ? layouts : Immutable(layouts);\n  if (setting) {\n    let mergedSetting = Immutable(layouts[layoutId][layoutItemId].setting || {}).merge(setting);\n    updatedLayouts = updatedLayouts.setIn([layoutId, layoutItemId, 'setting'], mergedSetting);\n  }\n  if (pos) {\n    let mergedPos = Immutable(layouts[layoutId][layoutItemId].pos).merge(pos);\n    updatedLayouts = updatedLayouts.setIn([layoutId, layoutItemId, 'pos'], mergedPos);\n  }\n  return updatedLayouts;\n}\n\nexport function resizeLayouts(newLayouts: Array<Layout>, breakpoint, layouts: GlobalLayouts) {\n  let updatedLayouts = Immutable.isImmutable(layouts) ? layouts : Immutable(layouts);\n  newLayouts.forEach(layout => {\n    const {layoutId, id } = layout;\n    if (!updatedLayouts[layoutId] || !updatedLayouts[layoutId][id]) {\n      return;\n    }\n    if (breakpoint) {\n      updatedLayouts = updatedLayouts.setIn([layoutId, id, 'pos', breakpoint], layout.pos);\n    } else {\n      updatedLayouts = updatedLayouts.setIn([layoutId, id, 'pos'], layout.pos);\n    }\n  });\n  return updatedLayouts;\n}\n\nexport function activeLayout(layoutInfo: LayoutInfo, layouts: GlobalLayouts) {\n  let updatedLayout = layouts;\n  Object.keys(layouts).forEach(layoutId => {\n    let layoutMap : LayoutMap = Immutable.isImmutable(layouts[layoutId]) ? layouts[layoutId] as LayoutMap : Immutable(layouts[layoutId]);\n    Object.keys(layoutMap).forEach(layoutItemId => {\n      if (layoutId === layoutInfo.layoutId && layoutItemId === layoutInfo.layoutItemId) {\n        layoutMap = layoutMap.setIn([layoutItemId, 'setting', 'active'], true);\n      } else {\n        const setting = Immutable(layoutMap[layoutItemId].setting || {}).without('active');\n        layoutMap = layoutMap.setIn([layoutItemId, 'setting'], setting);\n      }\n    });\n    updatedLayout = updatedLayout.set(layoutId, layoutMap);\n  });\n  return updatedLayout;\n}\n\nexport function findDescendantIdArray(layoutId: string, layoutMap: LayoutMap) {\n  const childrenIdArray = [];\n  const findDescendants = (parentId: string) => {\n    childrenIdArray.push(parentId);\n    Object.keys(layoutMap).forEach(key => {\n      if (layoutMap[key].parentId === parentId) {\n        findDescendants(layoutMap[key].id);\n      }\n    });\n  }\n  findDescendants(layoutId);\n  return childrenIdArray;\n}\n\nexport function dndLayout(layoutInfo: LayoutInfo, parentLayoutInfo: LayoutInfo,\nnewPosition: Position, layouts: GlobalLayouts) {\n  const {layoutId, layoutItemId} = layoutInfo;\n  if (!layouts[layoutId] || !layouts[layoutId][layoutItemId]) {\n    return layouts;\n  }\n  if (!layouts[parentLayoutInfo.layoutId] || !layouts[parentLayoutInfo.layoutId][parentLayoutInfo.layoutItemId]) {\n    return layouts;\n  }\n  const targetLayout = layouts[layoutId][layoutItemId];\n  const parentLayout = layouts[parentLayoutInfo.layoutId][parentLayoutInfo.layoutItemId];\n  if (layoutId === parentLayoutInfo.layoutId && targetLayout.parentId === parentLayout.id) {\n    return layouts; // already in\n  }\n\n  if (layoutId !== parentLayoutInfo.layoutId) {\n    const nextId = getMaximumId(layouts[parentLayoutInfo.layoutId] as LayoutMap);\n    let fromLayoutMap = Immutable.isImmutable(layouts[layoutId]) ?\n      layouts[layoutId] as LayoutMap : Immutable(layouts[layoutId]);\n    let toLayoutMap = Immutable.isImmutable(layouts[parentLayoutInfo.layoutId]) ?\n      layouts[parentLayoutInfo.layoutId] as LayoutMap : Immutable(layouts[parentLayoutInfo.layoutId]);\n    const childrenIdArray = findDescendantIdArray(targetLayout.id, fromLayoutMap);\n    // add tree to parent layout\n    childrenIdArray.forEach(itemId => {\n      let item = Immutable.isImmutable(fromLayoutMap[itemId]) ?\n        fromLayoutMap[itemId] as Immutable.ImmutableObject<Layout> : Immutable(fromLayoutMap[itemId]);\n      const idBeforeMove = item.id;\n      if (itemId === layoutItemId) { // top layout\n        item = item.set('id', `${+item.id + nextId + 1}`)\n          .set('parentId', `${+parentLayout.id}`)\n          .set('pos', newPosition);\n      } else { // children layout\n        // update the id of the layouts to make them unique among the layout\n        item = item.set('id', `${+item.id + nextId + 1}`).set('parentId', `${+item.parentId + nextId + 1}`);\n      }\n\n      invariant(!toLayoutMap[item.id], `layout with id ${item.id} should not in ${parentLayoutInfo.layoutId} before dropping`);\n      toLayoutMap = toLayoutMap.set(item.id, item);\n      fromLayoutMap = fromLayoutMap.without(idBeforeMove);\n    });\n    return layouts.set(layoutId, fromLayoutMap).set(parentLayoutInfo.layoutId, toLayoutMap);\n  } else {\n    // drag and drop in the same layout\n    return layouts.setIn([layoutId, layoutItemId, 'parentId'], parentLayout.id)\n      .setIn([layoutId, layoutItemId, 'pos'], newPosition);\n  }\n}\n\nexport function removeSection(sectionId, layouts: GlobalLayouts) {\n  let updatedLayouts = Immutable.isImmutable(layouts) ? layouts : Immutable(layouts);\n\n  Object.keys(layouts).forEach(layoutId => {\n    let layoutMap = Immutable.isImmutable(layouts[layoutId]) ? layouts[layoutId] as LayoutMap : Immutable(layouts[layoutId]);\n    Object.keys(layouts[layoutId]).forEach(layoutItemId => {\n      if (layouts[layoutId][layoutItemId].type === LayoutType.SECTION_LAYOUT &&\n        layouts[layoutId][layoutItemId].sectionId === sectionId) {\n        layoutMap = layoutMap.without(layoutItemId);\n      }\n    });\n    updatedLayouts = updatedLayouts.set(layoutId, layoutMap);\n  });\n  return updatedLayouts;\n}\n\nexport function changeLayoutOrder(layoutInfo: LayoutInfo, orderType: OrderAdjustType, layouts: GlobalLayouts) {\n  const {layoutId, layoutItemId} = layoutInfo;\n  if (!layouts[layoutId] || !layouts[layoutId][layoutItemId]) {\n    return layouts;\n  }\n  const parentId = layouts[layoutId][layoutItemId].parentId;\n  if (!parentId || !layouts[layoutId][parentId] || layouts[layoutId][parentId].type !== LayoutType.FIXED_LAYOUT) {\n    return layouts;\n  }\n  // collect siblings with the same parentId\n  let siblings:Array<{id: string, order: number}> = [];\n  Object.keys(layouts[layoutId]).forEach(key => {\n    const item = layouts[layoutId][key];\n    const setting = item.setting as FixedLayoutSetting;\n    if (item.parentId === parentId) {\n      siblings.push({\n        id: key,\n        order: item.setting && !isNaN(+setting.order) ? +setting.order : 0\n      });\n    }\n  });\n  siblings = siblings.sort((a, b) => {\n    return a.order - b.order;\n  });\n  let targetIndex = -1;\n  siblings.some((item, index) => {\n    if (item.id === layoutItemId) {\n      targetIndex = index;\n      return true;\n    }\n  });\n\n  let temp = siblings[targetIndex];\n\n  switch(orderType) {\n    case OrderAdjustType.BRING_FORWARD:\n      if (targetIndex < siblings.length - 1) {\n        siblings[targetIndex] = siblings[targetIndex + 1];\n        siblings[targetIndex + 1] = temp;\n      }\n      break;\n    case OrderAdjustType.SEND_BACKWARD:\n      if (targetIndex > 0) {\n        siblings[targetIndex] = siblings[targetIndex - 1];\n        siblings[targetIndex - 1] = temp;\n      }\n      break;\n    case OrderAdjustType.BRING_TO_FRONT:\n      if (targetIndex < siblings.length - 1) {\n        for (let i = targetIndex; i < siblings.length - 1; i++) {\n          siblings[i] = siblings[i + 1];\n        }\n        siblings[siblings.length - 1] = temp;\n      }\n      break;\n    case OrderAdjustType.SEND_TO_BACK:\n      if (targetIndex > 0) {\n        for (let i = targetIndex; i > 0; i--) {\n          siblings[i] = siblings[i - 1];\n        }\n        siblings[0] = temp;\n      }\n      break;\n  }\n\n  let updatedLayouts = Immutable.isImmutable(layouts) ? layouts : Immutable(layouts);\n  siblings.forEach((item, index) => {\n    updatedLayouts = updatedLayouts.setIn([layoutId, item.id, 'setting', 'order'], index);\n  });\n  return updatedLayouts;\n}","import * as Immutable from 'seamless-immutable';\nimport * as utils from '../global-action-utils';\nimport { GlobalLayoutActions } from '../actions/global-layout-actions';\nimport { LayoutType } from '../types';\n\nconst defaultState = Immutable({\n  'default': {\n    '0': {\n      id: '0',\n      pos: {\n        x: 0,\n        y: 0,\n        w: 0,\n        h: 0\n      },\n      type: LayoutType.FIXED_LAYOUT\n    }\n  }\n});\n\nexport function globalLayoutReducer(state=defaultState, action) {\n  switch (action.type) {\n    case GlobalLayoutActions.ADD_WIDGET:\n      return utils.addWidget(action.widgetId, action.layoutInfo, state);\n    case GlobalLayoutActions.ADD_SECTION:\n      return utils.addSection(action.sectionId, action.layoutInfo, state);\n    case GlobalLayoutActions.REMOVE_LAYOUT:\n      return utils.removeLayout(action.layoutInfo, state);\n    case GlobalLayoutActions.RESIZE_LAYOUTS:\n      return utils.resizeLayouts(action.layouts, action.breakpoint, state);\n    case GlobalLayoutActions.UPDATE_SETTING:\n      return utils.updateSetting(action.layoutInfo, action.newSetting, state);\n    case GlobalLayoutActions.REMOVE_WIDGET:\n      return utils.removeWidget(action.widgetId, state);\n    case GlobalLayoutActions.ADD_LAYOUT:\n      return utils.addLayout(action.layoutId, action.parentId,\n        action.initPosition,\n        action.layoutType,\n        state);\n    case GlobalLayoutActions.DRAG_DROP_LAYOUT:\n    {\n      const {layoutInfo, parentLayoutInfo, newPosition} = action;\n      return utils.dndLayout(layoutInfo, parentLayoutInfo, newPosition, state);\n    }\n    case GlobalLayoutActions.ACTIVATE:\n      return utils.activeLayout(action.layoutInfo, state);\n    case GlobalLayoutActions.REMOVE_SECTION:\n      return utils.removeSection(action.sectionId, state);\n    case GlobalLayoutActions.UPDATE_LAYOUT:\n      return utils.updateLayout(action.layoutInfo, action.pos, action.newSetting, state);\n    case GlobalLayoutActions.CHANGE_ORDER:\n      return utils.changeLayoutOrder(action.layoutInfo, action.orderType, state);\n    default:\n      return state;\n  }\n}","import assign = require(\"lodash.assign\");\nimport * as Immutable from 'seamless-immutable';\nimport { Layout, AttachType, SidebarItemSetting, Position } from '../types';\nimport { DEFAULT_SIDEBAR_SETTING } from './default-sidebar-setting';\n\nexport interface SideLayouts {\n  header?: Layout;\n  footer?: Layout;\n  left?: Layout;\n  right?: Layout;\n  main?: Layout;\n}\n\nexport function calculatePosition(sideLayouts: SideLayouts,\nwidth: number,\nheight: number,\nresizingSide?: AttachType,\ndelta?: {w: number, h: number}): {[key: string]: Position} {\n  const layouts = {};\n  const { header, footer, left, right } = sideLayouts;\n\n  if (header) {\n    if (header.setting.toggleOn === true && header.pos.h === null) {\n      layouts['header'] = {\n        x: 0,\n        y: 0,\n        w: width,\n        h: height\n      }\n      return layouts;\n    }\n    let pos = {\n      x: 0,\n      y: 0,\n      w: width,\n      h: header.pos.h\n    };\n    if (header.setting.toggleOn === false) {\n      pos.h = header.setting.min || 0;\n    }\n    layouts['header'] = pos;\n  }\n  if (footer) {\n    if (footer.setting.toggleOn === true && footer.pos.h === null) {\n      layouts['footer'] = {\n        x: 0,\n        y: 0,\n        w: width,\n        h: height\n      }\n      return layouts;\n    }\n    let pos = {\n      x: 0,\n      y: 0,\n      w: width,\n      h: footer.pos.h\n    };\n    if (footer.setting.toggleOn === false) {\n      pos.h = footer.setting.min || 0;\n    }\n    pos.y = height - pos.h;\n    layouts['footer'] = pos;\n  }\n  if (left) {\n    if (left.setting.toggleOn === true && left.pos.w === null) {\n      layouts['left'] = {\n        x: 0,\n        y: 0,\n        w: width,\n        h: height\n      }\n      return layouts;\n    }\n    let pos = {\n      x: 0,\n      y: header && occupySpace(header.setting) ? layouts['header'].h : 0,\n      w: left.pos.w,\n      h: 0\n    }\n    pos.h = height - pos.y - (footer && occupySpace(footer.setting) ? layouts['footer'].h : 0);\n    if (left.setting.toggleOn === false) {\n      pos.w = left.setting.min || 0;\n    }\n    layouts['left'] = pos;\n  }\n  if (right) {\n    if (right.setting.toggleOn === true && right.pos.w === null) {\n      layouts['right'] = {\n        x: 0,\n        y: 0,\n        w: width,\n        h: height\n      }\n      return layouts;\n    }\n    let pos = {\n      x: 0,\n      y: header && occupySpace(header.setting) ? layouts['header'].h : 0,\n      w: right.pos.w,\n      h: 0\n    }\n    pos.h = height - pos.y - (footer && occupySpace(footer.setting) ? layouts['footer'].h : 0);\n    if (right.setting.toggleOn === false) {\n      pos.w = right.setting.min || 0;\n    }\n    pos.x = width - pos.w;\n    layouts['right'] = pos;\n  }\n\n  layouts['main'] = {\n    x: left && occupySpace(left.setting) ? layouts['left'].w : 0,\n    y: header && occupySpace(header.setting) ? layouts['header'].h : 0,\n    w: width - (left && occupySpace(left.setting) ? layouts['left'].w : 0) -\n      (right && occupySpace(right.setting) ? layouts['right'].w : 0),\n    h: height - (header && occupySpace(header.setting) ? layouts['header'].h : 0) -\n      (footer && occupySpace(footer.setting) ? layouts['footer'].h : 0)\n  }\n  if(resizingSide === AttachType.TOP && header && occupySpace(header.setting) && delta) {\n    layouts['main'].h -= delta.h;\n    layouts['main'].y += delta.h;\n  }\n  if(resizingSide === AttachType.BOTTOM && footer && occupySpace(footer.setting) && delta) {\n    layouts['main'].h -= delta.h;\n  }\n  if(resizingSide === AttachType.LEFT && left && occupySpace(left.setting) && delta) {\n    layouts['main'].w -= delta.w;\n    layouts['main'].x += delta.w;\n  }\n  if(resizingSide === AttachType.RIGHT && right && occupySpace(right.setting) && delta) {\n    layouts['main'].w -= delta.w;\n  }\n  return layouts;\n}\n\nexport function collectSidebars(layouts: Array<Layout>, layoutsQueryObject?: string): SideLayouts {\n  const result: SideLayouts = {};\n  layouts.forEach(layout => {\n    const setting: SidebarItemSetting = assign({}, DEFAULT_SIDEBAR_SETTING, layout.setting);\n    let imLayout = Immutable(layout).set('setting', setting);\n    const attach = setting.attach;\n\n    if (layoutsQueryObject) {\n      const params = layoutsQueryObject.split(',');\n      params.forEach(param => {\n        // format: layoutId:layoutItemId:settingKey:settingValue\n        const items = param.split(':');\n        if (items.length === 4) {\n          if (layout.layoutId === items[0] && layout.id === items[1]) {\n            if (items[3] === 'true') {\n              imLayout = imLayout.setIn(['setting', items[2]], true);\n            } else if (items[3] === 'false') {\n              imLayout = imLayout.setIn(['setting', items[2]], false);\n            } else if (!isNaN(+items[3])) {\n              imLayout = imLayout.setIn(['setting', items[2]], +items[3]);\n            } else {\n              imLayout = imLayout.setIn(['setting', items[2]], items[3]);\n            }\n          }\n        }\n      });\n    }\n\n    switch (attach) {\n      case AttachType.TOP:\n        result.header = imLayout;\n        break;\n      case AttachType.BOTTOM:\n        result.footer = imLayout;\n        break;\n      case AttachType.LEFT:\n        result.left = imLayout;\n        break;\n      case AttachType.RIGHT:\n        result.right = imLayout;\n        break;\n      default:\n        result.main = imLayout;\n        break;\n    }\n  });\n  return result;\n}\n\nexport function occupySpace(setting: SidebarItemSetting) {\n  return !setting.overlay;\n}\n\nexport function visible(setting: SidebarItemSetting) {\n  return !setting.togglable || setting.toggleOn;\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@supports (position: -webkit-sticky) or (position: sticky) {\\n  .header {\\n    position: -webkit-sticky;\\n    position: sticky;\\n    top: 0;\\n    z-index: 1050; }\\n  .sidebar {\\n    position: -webkit-sticky;\\n    position: sticky;\\n    z-index: 1000; } }\\n\\n.sidebar-layout {\\n  width: 100%;\\n  height: 100%; }\\n\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./sidebar-layout.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./sidebar-layout.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./sidebar-layout.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".sidebar-layout .sidebar_handler_top,\\n.sidebar-layout .sidebar_handler_left,\\n.sidebar-layout .sidebar_handler_bottom,\\n.sidebar-layout .sidebar_handler_right {\\n  position: absolute;\\n  cursor: pointer;\\n  background-color: #fff;\\n  border: 1px solid #ced4da; }\\n  .sidebar-layout .sidebar_handler_top::before,\\n  .sidebar-layout .sidebar_handler_left::before,\\n  .sidebar-layout .sidebar_handler_bottom::before,\\n  .sidebar-layout .sidebar_handler_right::before {\\n    content: '';\\n    display: block;\\n    width: 0;\\n    height: 0;\\n    border: 5px solid transparent; }\\n\\n.sidebar-layout .sidebar_handler_top,\\n.sidebar-layout .sidebar_handler_bottom {\\n  left: 50%;\\n  padding: 5px 18px;\\n  transform: translate(-50%, 0); }\\n\\n.sidebar-layout .sidebar_handler_left,\\n.sidebar-layout .sidebar_handler_right {\\n  top: 50%;\\n  padding: 18px 5px;\\n  transform: translate(0, -50%); }\\n\\n.sidebar-layout .sidebar_handler_top {\\n  bottom: -15px;\\n  border-top: 0; }\\n  .sidebar-layout .sidebar_handler_top::before {\\n    border-bottom: 0;\\n    border-top-color: #343a40; }\\n\\n.sidebar-layout .sidebar_handler_left {\\n  right: -15px;\\n  border-left: 0; }\\n  .sidebar-layout .sidebar_handler_left::before {\\n    border-left: 0;\\n    border-right-color: #343a40; }\\n\\n.sidebar-layout .sidebar_handler_bottom {\\n  top: -15px;\\n  border-bottom: 0; }\\n  .sidebar-layout .sidebar_handler_bottom::before {\\n    border-top: 0;\\n    border-bottom-color: #343a40; }\\n\\n.sidebar-layout .sidebar_handler_right {\\n  left: -15px;\\n  border-right: 0; }\\n  .sidebar-layout .sidebar_handler_right::before {\\n    border-right: 0;\\n    border-left-color: #343a40; }\\n\\n.sidebar-layout .toggle-off .sidebar_handler_left::before,\\n.sidebar-layout .toggle-off .sidebar_handler_right::before {\\n  transform: scaleX(-1); }\\n\\n.sidebar-layout .toggle-off .sidebar_handler_top::before,\\n.sidebar-layout .toggle-off .sidebar_handler_bottom::before {\\n  transform: scaleY(-1); }\\n\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./sidebar.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./sidebar.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./sidebar.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","import * as React from 'react';\nimport assign = require(\"lodash.assign\");\nimport classNames = require(\"classnames\");\nimport { setTransform } from '../utils';\nimport { Layout, Position, SidebarItemSetting, AttachType } from '../types';\nimport { DEFAULT_SIDEBAR_SETTING } from './default-sidebar-setting';\nimport './style/sidebar.scss';\nimport { LayoutItem } from '../layout-item';\nimport { AppMode } from '../../types/constants';\n\ninterface Props {\n  layout: Layout;\n  appMode: AppMode;\n  pos: Position;\n  className?: string;\n  style?: Object;\n  onToggleChange? (id: string, toggle: boolean);\n}\n\nexport class Sidebar extends React.PureComponent<Props> {\n  static defaultProps: Partial<Props> = {\n    onToggleChange: () => {}\n  };\n\n  _getLayoutId() {\n    return this.props.layout ? this.props.layout.id : '';\n  }\n\n  toggleItem() {\n    const setting = assign({}, DEFAULT_SIDEBAR_SETTING, this.props.layout.setting);\n    this.props.onToggleChange(this.props.layout.id, !setting.toggleOn);\n  }\n\n  render() {\n    const { pos, style, layout, className } = this.props;\n    let { w, h } = pos;\n    const setting = layout.setting as SidebarItemSetting;\n    const { attach, togglable, toggleOn } = setting;\n    let layoutItem = null;\n    if (!togglable || (togglable && toggleOn) || setting.min > 0) {\n      layoutItem = <LayoutItem pos={{x:0, y:0, w, h}} layout={layout} appMode={this.props.appMode}></LayoutItem>;\n    }\n    const mergedStyle = {\n      ...setTransform(pos),\n      ...style\n    };\n    const mergedClassNames = classNames(className, {\n      'toggle-on': togglable && toggleOn,\n      'toggle-off': togglable && !toggleOn\n    })\n    return (\n      <div className={mergedClassNames}\n        style={mergedStyle as any}>\n        {layoutItem}\n        {togglable &&\n          <div className={`sidebar_handler_${attach}`} onClick={this.toggleItem.bind(this)}></div>\n        }\n      </div>\n    );\n  }\n}\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".fixed-layout {\\n  width: 100%;\\n  height: 100%; }\\n\\n.restricted-fixed-layout {\\n  width: 100%;\\n  height: 100%;\\n  overflow: auto; }\\n\\n.layout-container {\\n  width: 100%;\\n  height: 100%; }\\n\", \"\"]);\n\n// exports\n","import * as Immutable from 'seamless-immutable';\nimport { Layout, FixedLayoutSetting } from '../types';\n\nexport function sortLayoutItems(layoutArray: Array<Layout>): Array<Layout> {\n  const result = [];\n  layoutArray.forEach(layoutItem => {\n    let imLayoutItem = Immutable(layoutItem);\n    if (!layoutItem.setting || isNaN(+(layoutItem.setting as FixedLayoutSetting).order)) {\n      imLayoutItem = imLayoutItem.setIn(['setting', 'order'], 0);\n    }\n    result.push(imLayoutItem);\n  });\n  return result.sort((a: Layout, b: Layout) => {\n    return (a.setting as FixedLayoutSetting).order - (b.setting as FixedLayoutSetting).order;\n  });\n}","import * as React from 'react';\nimport classNames = require(\"classnames\");\nimport assign = require(\"lodash.assign\");\nimport { Layout, FixedLayoutSetting, LayoutActionContext, LayoutInfo } from '../types';\nimport { DropTarget, ConnectDropTarget, DropTargetMonitor, DropTargetConnector } from 'react-dnd';\nimport draggable from '../react-dnd-draggable';\nimport resizable from '../react-dnd-resizable';\nimport * as utils from '../utils';\nimport * as fixedUtils from './fixed-layout-util';\nimport { DEFAULT_FIX_LAYOUT_SETTING } from './default-setting';\nimport './style/layout.scss';\nimport { AppMode } from '../../types/constants';\nimport { LayoutItem } from '../layout-item';\nimport { DND_TYPES } from '../react-dnd-types';\n\nexport interface DropProps {\n  connectDropTarget?: ConnectDropTarget,\n  isOver?: boolean,\n  draggingItem?: {layout: Layout}\n}\ninterface FixedLayoutProps {\n  layout?: Layout;\n  appMode: AppMode;\n  width: number;\n  height: number;\n  actionContext?: LayoutActionContext;\n}\n\nconst InteractItem = resizable()(draggable(null)(LayoutItem));\n\nclass FixedLayoutPrototype extends React.PureComponent<FixedLayoutProps & DropProps> {\n  static displayName = \"FixedLayout\";\n\n  static defaultProps: Partial<FixedLayoutProps> = {\n    actionContext: {\n      updateSetting: utils.emptyFunc,\n      addLayout: utils.emptyFunc,\n      removeLayout: utils.emptyFunc,\n      resizeLayouts: utils.emptyFunc,\n      dndLayout: utils.emptyFunc,\n      activate: utils.emptyFunc,\n      removeWidget: utils.emptyFunc\n    }\n  };\n\n  ref;\n  clientRect: ClientRect;\n\n  constructor(props) {\n    super(props);\n    utils.autoBindHandlers(this, [\n      '_onItemResizeEnd'\n    ]);\n  }\n\n  componentDidMount() {\n    const domNode = this.ref as HTMLElement;\n    this.clientRect = domNode.getBoundingClientRect();\n  }\n\n  componentDidUpdate() {\n    const domNode = this.ref as HTMLElement;\n    this.clientRect = domNode.getBoundingClientRect();\n  }\n\n  _getFixedPosOfLayoutItem(id: string) {\n    const layoutItem = utils.getLayoutItem(this.props.layout.content, id);\n    const itemSetting = assign({}, DEFAULT_FIX_LAYOUT_SETTING, layoutItem.setting);\n    return utils.calPixelPosition(layoutItem.pos, this.props.width, this.props.height, itemSetting);\n  }\n\n  _onItemResizeEnd(id: string, x: number, y: number, dw: number, dh: number) {\n    const { actionContext } = this.props;\n    const layoutItem = utils.getLayoutItem(this.props.layout.content, id);\n    const itemSetting = assign({}, DEFAULT_FIX_LAYOUT_SETTING, layoutItem.setting);\n    const pos = this._getFixedPosOfLayoutItem(id);\n\n    this.setState({\n      movingLayout: null,\n      deltaPos: null\n    });\n\n    const newPos = {\n      x: x,\n      y: y,\n      w: pos.w + dw,\n      h: pos.h + dh\n    };\n\n    const relativePos = utils.calLayoutPosition(newPos, this.props.width,\n      this.props.height, itemSetting);\n    actionContext.resizeLayouts([{\n      id: id,\n      layoutId: layoutItem.layoutId,\n      pos: relativePos\n    }]);\n  }\n\n  _processLayoutItem(l: Layout, key: number, layoutSetting: FixedLayoutSetting) {\n    if (!l) {\n      return;\n    }\n    const { appMode } = this.props;\n    const pos = this._getFixedPosOfLayoutItem(l.id);\n\n    return <InteractItem\n      key={key}\n      pos={pos}\n      layout={l}\n      appMode={appMode}\n      disableInteract={appMode !== AppMode.Design}\n      resizeGrid={[layoutSetting.gridSize, layoutSetting.gridSize]}\n      onResizeEnd={this._onItemResizeEnd}>\n    </InteractItem>;\n  }\n\n  render() {\n    const { layout, connectDropTarget, isOver, draggingItem } = this.props;\n    const layouts = layout.content || [];\n    const sortedLayouts = fixedUtils.sortLayoutItems(layouts);\n    const layoutSetting = assign({}, DEFAULT_FIX_LAYOUT_SETTING, layout.setting);\n    const isDropTaget = isOver === true && draggingItem &&\n      (draggingItem.layout.layoutId !== layout.layoutId || draggingItem.layout.parentId !== layout.id);\n    const mergedClasses = classNames('fixed-layout', {\n      'drop-target': isDropTaget === true\n    });\n    return ( connectDropTarget &&\n      connectDropTarget(\n        <div ref={(el) => this.ref = el } className={mergedClasses}\n          data-layoutid={layout.layoutId}\n          data-layoutitemid={layout.id}>\n          {sortedLayouts.map((layoutItem, index) => {\n            return this._processLayoutItem(layoutItem, index, layoutSetting);\n          })}\n        </div>\n      )\n    )\n  }\n}\n\nconst spec = {\n  drop: (props: FixedLayoutProps, monitor: DropTargetMonitor, component: FixedLayoutPrototype) => {\n    if (!component || monitor.didDrop()) {\n      return;\n    }\n    const item = monitor.getItem() as {layout: Layout, width: number, height: number};\n    const actionContext = props.actionContext as LayoutActionContext;\n    // adjust the position of a layout item\n    if (item.layout.layoutId === props.layout.layoutId && item.layout.parentId === props.layout.id) {\n      const delta = monitor.getDifferenceFromInitialOffset();\n      const layoutSetting = assign({}, DEFAULT_FIX_LAYOUT_SETTING, props.layout.setting);\n      const { gridSize } = layoutSetting;\n      const pos = component._getFixedPosOfLayoutItem(item.layout.id);\n      const snapX = Math.round((pos.x + delta.x)/gridSize) * gridSize,\n        snapY = Math.round((pos.y + delta.y)/gridSize) * gridSize,\n        snapW = Math.round(pos.w/gridSize) * gridSize,\n        snapH = Math.round(pos.h/gridSize) * gridSize;\n      const newPos = {\n        x: snapX,\n        y: snapY,\n        w: snapW,\n        h: snapH\n      };\n\n      const layoutItem = utils.getLayoutItem(props.layout.content, item.layout.id);\n      const itemSetting = assign({}, DEFAULT_FIX_LAYOUT_SETTING, layoutItem.setting);\n      const relativePos = utils.calLayoutPosition(newPos, props.width,\n        props.height, itemSetting);\n      actionContext.resizeLayouts([{\n        id: item.layout.id,\n        layoutId: item.layout.layoutId,\n        pos: relativePos\n      }]);\n    } else {\n      // drag and drop a layout item from other layout\n      const clientOffset = monitor.getSourceClientOffset();\n      const { width, height } = item;\n      actionContext.dndLayout({\n        layoutItemId: item.layout.id,\n        layoutId: item.layout.layoutId\n      }, {\n        layoutItemId: props.layout.id,\n        layoutId: props.layout.layoutId\n      }, {\n        x: clientOffset.x - component.clientRect.left,\n        y: clientOffset.y - component.clientRect.top,\n        w: width,\n        h: height\n      });\n    }\n  }\n}\n\nconst collect = (connect: DropTargetConnector, monitor: DropTargetMonitor) => {\n  return {\n    connectDropTarget: connect.dropTarget(),\n    isOver: monitor.isOver({shallow: true}),\n    draggingItem: monitor.getItem()\n  }\n}\n\nexport const FixedLayout = DropTarget([DND_TYPES.LAYOUT], spec, collect)(FixedLayoutPrototype);","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".grid-layout {\\n  width: 100%;\\n  height: 100%; }\\n\\n.layout-grid-item {\\n  box-sizing: border-box;\\n  transition: all 200ms ease; }\\n  .layout-grid-item__content {\\n    width: 100%;\\n    height: 100%;\\n    overflow: auto; }\\n  .layout-grid-item:not(.react-grid-placeholder) {\\n    background: #ccc;\\n    border: 1px solid black; }\\n  .layout-grid-item.cssTransforms {\\n    transition-property: transform; }\\n  .layout-grid-item .text {\\n    font-size: 16px;\\n    text-align: center;\\n    position: absolute;\\n    top: 0;\\n    bottom: 0;\\n    left: 0;\\n    right: 0;\\n    margin: auto;\\n    height: 24px; }\\n  .layout-grid-item .remove {\\n    position: absolute;\\n    right: 2px;\\n    top: 0px;\\n    cursor: pointer; }\\n  .layout-grid-item.grid-item-placeholder {\\n    background: red;\\n    opacity: 0.2;\\n    transition-duration: 100ms;\\n    z-index: 2;\\n    -webkit-user-select: none;\\n    -moz-user-select: none;\\n    -ms-user-select: none;\\n    -o-user-select: none;\\n    user-select: none; }\\n  .layout-grid-item.layout-grid-item--resizing {\\n    z-index: 1;\\n    will-change: width, height; }\\n  .layout-grid-item.layout-grid-item--dragging {\\n    transition: none;\\n    z-index: 3;\\n    will-change: transform; }\\n  .layout-grid-item.layout-grid-item--draggable {\\n    cursor: move; }\\n\\n/*\\n.grid-item-placeholder {\\n  background: red;\\n  opacity: 0.2;\\n  transition-duration: 100ms;\\n  z-index: 2;\\n  -webkit-user-select: none;\\n  -moz-user-select: none;\\n  -ms-user-select: none;\\n  -o-user-select: none;\\n  user-select: none;\\n}\\n*/\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".layout-item {\\n  background: #FFFFFF;\\n  box-sizing: border-box; }\\n  .layout-item__content {\\n    width: 100%;\\n    height: 100%; }\\n  .layout-item.has-focus {\\n    outline: 1px solid #E5E5E5; }\\n\\n.drop-target {\\n  background: #D9F0FF;\\n  outline: 1px solid #55BCFF;\\n  box-shadow: inset 0 0 8px 0 rgba(0, 0, 0, 0.15); }\\n\\n.section-layout {\\n  outline: 1px solid #E5E5E5; }\\n\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--6-1!../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./layout-item.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--6-1!../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./layout-item.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--6-1!../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./layout-item.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","module.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUwLjIgKDU1MDQ3KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5zZXR0aW5nczwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJidWlsZGVyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iZGVzaWduLW1vZGVfc2VjdGlvbl9lZGl0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtOTg2LjAwMDAwMCwgLTQ5NC4wMDAwMDApIiBmaWxsPSIjRkZGRkZGIj4KICAgICAgICAgICAgPGcgaWQ9InNldGluZ19pY29uLWdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5NDUuMDAwMDAwLCA0ODcuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8ZyBpZD0ic2V0dGluZ3MiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQxLjAwMDAwMCwgNy4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTMuMjU3MTQyOSw4LjM4MDk1MjM4IEMxMy4yNTcxNDI5LDguMTUyMzgwOTUgMTMuMzMzMzMzMyw3LjkyMzgwOTUyIDEzLjMzMzMzMzMsNy42MTkwNDc2MiBDMTMuMzMzMzMzMyw3LjMxNDI4NTcxIDEzLjMzMzMzMzMsNy4wODU3MTQyOSAxMy4yNTcxNDI5LDYuODU3MTQyODYgTDE0Ljg1NzE0MjksNS41NjE5MDQ3NiBDMTUuMDA5NTIzOCw1LjQwOTUyMzgxIDE1LjAwOTUyMzgsNS4yNTcxNDI4NiAxNC45MzMzMzMzLDUuMTA0NzYxOSBMMTMuNDA5NTIzOCwyLjQzODA5NTI0IEMxMy4zMzMzMzMzLDIuMzYxOTA0NzYgMTMuMTgwOTUyNCwyLjI4NTcxNDI5IDEyLjk1MjM4MSwyLjM2MTkwNDc2IEwxMS4wNDc2MTksMy4xMjM4MDk1MiBDMTAuNjY2NjY2NywyLjgxOTA0NzYyIDEwLjIwOTUyMzgsMi41OTA0NzYxOSA5Ljc1MjM4MDk1LDIuMzYxOTA0NzYgTDkuNDQ3NjE5MDUsMC4zODA5NTIzODEgQzkuNTIzODA5NTIsMC4xNTIzODA5NTIgOS4yOTUyMzgxLDAgOS4xNDI4NTcxNCwwIEw2LjA5NTIzODEsMCBDNS45NDI4NTcxNCwwIDUuNzE0Mjg1NzEsMC4xNTIzODA5NTIgNS43MTQyODU3MSwwLjMwNDc2MTkwNSBMNS40MDk1MjM4MSwyLjM2MTkwNDc2IEM0Ljk1MjM4MDk1LDIuNTE0Mjg1NzEgNC41NzE0Mjg1NywyLjgxOTA0NzYyIDQuMTE0Mjg1NzEsMy4xMjM4MDk1MiBMMi4yODU3MTQyOSwyLjM2MTkwNDc2IEMyLjA1NzE0Mjg2LDIuMjg1NzE0MjkgMS45MDQ3NjE5LDIuMzYxOTA0NzYgMS43NTIzODA5NSwyLjUxNDI4NTcxIEwwLjIyODU3MTQyOSw1LjE4MDk1MjM4IEMwLjE1MjM4MDk1Miw1LjI1NzE0Mjg2IDAuMjI4NTcxNDI5LDUuNDg1NzE0MjkgMC4zODA5NTIzODEsNS42MzgwOTUyNCBMMS45ODA5NTIzOCw2Ljg1NzE0Mjg2IEMxLjk4MDk1MjM4LDcuMDg1NzE0MjkgMS45MDQ3NjE5LDcuMzE0Mjg1NzEgMS45MDQ3NjE5LDcuNjE5MDQ3NjIgQzEuOTA0NzYxOSw3LjkyMzgwOTUyIDEuOTA0NzYxOSw4LjE1MjM4MDk1IDEuOTgwOTUyMzgsOC4zODA5NTIzOCBMMC4zODA5NTIzODEsOS42NzYxOTA0OCBDMC4yMjg1NzE0MjksOS44Mjg1NzE0MyAwLjIyODU3MTQyOSw5Ljk4MDk1MjM4IDAuMzA0NzYxOTA1LDEwLjEzMzMzMzMgTDEuODI4NTcxNDMsMTIuOCBDMS45MDQ3NjE5LDEyLjg3NjE5MDUgMi4wNTcxNDI4NiwxMi45NTIzODEgMi4yODU3MTQyOSwxMi44NzYxOTA1IEw0LjE5MDQ3NjE5LDEyLjExNDI4NTcgQzQuNTcxNDI4NTcsMTIuNDE5MDQ3NiA1LjAyODU3MTQzLDEyLjY0NzYxOSA1LjQ4NTcxNDI5LDEyLjg3NjE5MDUgTDUuNzkwNDc2MTksMTQuODU3MTQyOSBDNS43OTA0NzYxOSwxNS4wMDk1MjM4IDUuOTQyODU3MTQsMTUuMTYxOTA0OCA2LjE3MTQyODU3LDE1LjE2MTkwNDggTDkuMjE5MDQ3NjIsMTUuMTYxOTA0OCBDOS4zNzE0Mjg1NywxNS4xNjE5MDQ4IDkuNiwxNS4wMDk1MjM4IDkuNiwxNC44NTcxNDI5IEw5LjkwNDc2MTksMTIuODc2MTkwNSBDMTAuMzYxOTA0OCwxMi42NDc2MTkgMTAuODE5MDQ3NiwxMi40MTkwNDc2IDExLjIsMTIuMTE0Mjg1NyBMMTMuMTA0NzYxOSwxMi44NzYxOTA1IEMxMy4yNTcxNDI5LDEyLjk1MjM4MSAxMy40ODU3MTQzLDEyLjg3NjE5MDUgMTMuNTYxOTA0OCwxMi43MjM4MDk1IEwxNS4wODU3MTQzLDEwLjA1NzE0MjkgQzE1LjE2MTkwNDgsOS45MDQ3NjE5IDE1LjE2MTkwNDgsOS42NzYxOTA0OCAxNS4wMDk1MjM4LDkuNiBMMTMuMjU3MTQyOSw4LjM4MDk1MjM4IEwxMy4yNTcxNDI5LDguMzgwOTUyMzggWiBNNy42MTkwNDc2MiwxMC4yODU3MTQzIEM2LjE3MTQyODU3LDEwLjI4NTcxNDMgNC45NTIzODA5NSw5LjA2NjY2NjY3IDQuOTUyMzgwOTUsNy42MTkwNDc2MiBDNC45NTIzODA5NSw2LjE3MTQyODU3IDYuMTcxNDI4NTcsNC45NTIzODA5NSA3LjYxOTA0NzYyLDQuOTUyMzgwOTUgQzkuMDY2NjY2NjcsNC45NTIzODA5NSAxMC4yODU3MTQzLDYuMTcxNDI4NTcgMTAuMjg1NzE0Myw3LjYxOTA0NzYyIEMxMC4yODU3MTQzLDkuMDY2NjY2NjcgOS4wNjY2NjY2NywxMC4yODU3MTQzIDcuNjE5MDQ3NjIsMTAuMjg1NzE0MyBMNy42MTkwNDc2MiwxMC4yODU3MTQzIFoiIGlkPSJTaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=\"","module.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTNweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTMgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUwLjIgKDU1MDQ3KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5kZWxldGU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz48L2RlZnM+CiAgICA8ZyBpZD0iYnVpbGRlciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9ImRlc2lnbi1tb2RlX3NlY3Rpb25fZWRpdCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk1NS4wMDAwMDAsIC00OTQuMDAwMDAwKSIgZmlsbD0iI0ZGRkZGRiI+CiAgICAgICAgICAgIDxnIGlkPSJzZXRpbmdfaWNvbi1ncm91cCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTQ1LjAwMDAwMCwgNDg3LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPGcgaWQ9ImRlbGV0ZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuMDAwMDAwLCA3LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLjg4ODg4ODg4OSwxNC4yMjIyMjIyIEMwLjg4ODg4ODg4OSwxNS4yIDEuNjg4ODg4ODksMTYgMi42NjY2NjY2NywxNiBMOS43Nzc3Nzc3OCwxNiBDMTAuNzU1NTU1NiwxNiAxMS41NTU1NTU2LDE1LjIgMTEuNTU1NTU1NiwxNC4yMjIyMjIyIEwxMS41NTU1NTU2LDMuNTU1NTU1NTYgTDAuODg4ODg4ODg5LDMuNTU1NTU1NTYgTDAuODg4ODg4ODg5LDE0LjIyMjIyMjIgTDAuODg4ODg4ODg5LDE0LjIyMjIyMjIgWiBNMTIuNDQ0NDQ0NCwwLjg4ODg4ODg4OSBMOS4zMzMzMzMzMywwLjg4ODg4ODg4OSBMOC40NDQ0NDQ0NCwwIEw0LDAgTDMuMTExMTExMTEsMC44ODg4ODg4ODkgTDAsMC44ODg4ODg4ODkgTDAsMi42NjY2NjY2NyBMMTIuNDQ0NDQ0NCwyLjY2NjY2NjY3IEwxMi40NDQ0NDQ0LDAuODg4ODg4ODg5IEwxMi40NDQ0NDQ0LDAuODg4ODg4ODg5IFoiIGlkPSJTaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=\"","var escape = require(\"../../../../node_modules/css-loader/lib/url/escape.js\");\nexports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".layout-widget {\\n  width: 100%;\\n  height: 100%; }\\n  .layout-widget .settings {\\n    position: absolute;\\n    height: 32px;\\n    width: 60px;\\n    display: flex;\\n    justify-content: space-evenly;\\n    left: 0;\\n    top: -32px;\\n    background: #0189F3;\\n    border: 0; }\\n    .layout-widget .settings .settings-item {\\n      width: 32px;\\n      height: 32px;\\n      background-position: center;\\n      background-repeat: no-repeat;\\n      cursor: pointer;\\n      opacity: 0.8; }\\n      .layout-widget .settings .settings-item:hover {\\n        opacity: 1; }\\n      .layout-widget .settings .settings-item + .settings-item {\\n        position: relative; }\\n        .layout-widget .settings .settings-item + .settings-item::before {\\n          content: ' ';\\n          display: block;\\n          position: absolute;\\n          border-left: 1px solid #fff;\\n          left: -1px;\\n          top: 4px;\\n          bottom: 4px;\\n          opacity: 0.2; }\\n    .layout-widget .settings .delete {\\n      background-image: url(\" + escape(require(\"./images/delete.svg\")) + \");\\n      background-size: 13px 16px; }\\n    .layout-widget .settings .config {\\n      background-image: url(\" + escape(require(\"./images/settings.svg\")) + \");\\n      background-size: 16px; }\\n  .layout-widget .highlight {\\n    position: absolute;\\n    left: 0;\\n    top: 0;\\n    width: 100%;\\n    height: 100%;\\n    background-color: rgba(232, 75, 75, 0.4); }\\n  .layout-widget.placeholder {\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n    outline: 1px solid #E5E5E5; }\\n    .layout-widget.placeholder .handler {\\n      cursor: pointer;\\n      font-size: 24px; }\\n\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--6-1!../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./widget.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--6-1!../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./widget.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--6-1!../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./widget.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","import * as React from 'react';\nimport { connect } from 'react-redux';\nimport WidgetManager from '../widget-manager';\nimport {IMState, IMRuntimeInfo } from '../types/state';\nimport {AppMode} from '../types/constants';\nimport {autoBindHandlers} from './utils';\nimport { ActionContext } from './action-context';\nimport {Layout} from './types';\nimport \"./style/widget.scss\";\nimport {publishCurrentEditWidgetChangeToBuilder, publishRemoveWidgetToBuilder, letBuilderPopupChooseWidget} from '../app-builder-sync';\n\ninterface State{\n  showSettings: boolean;\n}\ninterface OwnProps{\n  layout: Layout;\n  widgetId?: string;\n}\ninterface StateProps{\n  runtimeInfo: IMRuntimeInfo;\n  appMode: AppMode\n}\nclass WidgetRendererComponent extends React.PureComponent<OwnProps & StateProps, State>{\n  state: State = {\n    showSettings: false\n  };\n\n  constructor(props) {\n    super(props);\n    autoBindHandlers(this, ['showSetting', 'hideSetting']);\n  }\n\n  componentDidMount(){\n    if (this.props.widgetId) {\n      WidgetManager.getInstance().loadWidgetClass(this.props.widgetId);\n    }\n  }\n\n  componentDidUpdate(){\n    if (this.props.widgetId) {\n      (!this.props.runtimeInfo || !this.props.runtimeInfo.isClassLoaded) &&\n        WidgetManager.getInstance().loadWidgetClass(this.props.widgetId);\n    }\n  }\n\n  showSetting() {\n    const { appMode, widgetId } = this.props;\n    if (appMode === AppMode.Config && widgetId) {\n      this.setState({\n        showSettings: true\n      });\n    }\n  }\n\n  hideSetting() {\n    this.setState({\n      showSettings: false\n    });\n  }\n\n  render(){\n    const { appMode, layout } = this.props;\n    const { showSettings } = this.state;\n    if (this.props.widgetId) {\n      let WidgetClass = WidgetManager.getInstance().getWidgetClass(this.props.widgetId);\n\n      if (WidgetClass) {\n        return <ActionContext.Consumer>\n        {actions =>\n          <div className=\"layout-widget\"\n          data-widgetid={this.props.widgetId}\n          onMouseEnter={this.showSetting}\n          onMouseLeave={this.hideSetting}>\n            <WidgetClass></WidgetClass>\n            { appMode === AppMode.Design && <div className=\"widget-mask\" style={{\n              position: 'absolute',\n              left: 0,\n              top: 0,\n              width: '100%',\n              height: '100%'\n            }}></div> }\n            { appMode === AppMode.Config && showSettings && <div className=\"settings\">\n              <div onClick={() => {\n                actions.removeWidget(this.props.widgetId);\n                publishRemoveWidgetToBuilder(this.props.widgetId);\n              }} className=\"settings-item delete\"></div>\n              <div onClick={() => publishCurrentEditWidgetChangeToBuilder(this.props.widgetId)} className=\"settings-item config\"></div>\n            </div> }\n            { appMode === AppMode.Config && this.props.runtimeInfo.isHighlight && <div className=\"highlight\"> </div> }\n          </div>\n        }\n        </ActionContext.Consumer>\n      }\n      //return this.props.widgetId + ' is Loading...' ;\n      return <div className='jimu-small-loading'></div>\n    } else if (appMode !== AppMode.Run) {\n      return <ActionContext.Consumer>\n        {actions => <div className=\"layout-widget placeholder\" style={{width: '100%', height: '100%'}}>\n          <div className=\"handler\" onClick={() => letBuilderPopupChooseWidget(layout.layoutId, layout.id)}>+</div>\n          </div>\n        }\n      </ActionContext.Consumer>\n    }\n    return null;\n  }\n}\n\nconst mapStateToProps = (state: IMState, ownProps: OwnProps) => {\n  return {\n    runtimeInfo: state.widgetsRuntimeInfo[ownProps.widgetId],\n    appMode: state.appMode\n  }\n};\n\nexport default connect<StateProps, {}, OwnProps>(mapStateToProps)(WidgetRendererComponent);\n\n\n","import * as React from 'react';\nimport assign = require('lodash.assign');\nimport * as Immutable from 'seamless-immutable';\nimport classNames = require(\"classnames\");\nimport { DropTarget, ConnectDropTarget, DropTargetMonitor, DropTargetConnector } from 'react-dnd';\nimport draggable from '../react-dnd-draggable';\nimport resizable from '../react-dnd-resizable';\nimport { DND_TYPES } from '../react-dnd-types';\nimport { DEFAULT_GRID_LAYOUT_SETTING } from './default-setting';\nimport * as gridUtils from \"./grid-utils\";\nimport * as utils from \"../utils\";\nimport { Position } from '../types';\nimport { LayoutItem } from '../layout-item';\nimport './style/grid.scss';\n\n// Types\nimport {\n  Layout,\n  GridLayoutSetting,\n  LayoutActionContext\n} from '../types';\nimport { AppMode } from '../../types/constants';\n\ninterface State {\n  // activeDrag?: Layout;\n  width: number;\n  numOfCols: number;\n  colWidth: number;\n  breakpoint: string;\n  pixelLayouts: {[key: string]: Position};\n  gridLayouts: {[key: string]: Position};\n  layout: Layout;\n  setting: GridLayoutSetting;\n};\n\ninterface GridLayoutProps {\n  width: number;\n  layout?: Layout;\n  appMode: AppMode;\n  actionContext?: LayoutActionContext;\n  className?: string,\n  style?: Object,\n  autoSize?: boolean\n};\n\nexport interface DropProps {\n  connectDropTarget?: ConnectDropTarget,\n  isOver?: boolean,\n  draggingItem?: {layout: Layout}\n}\n\nconst InteractItem = resizable()(draggable(null)(LayoutItem));\n\n/**\n * A reactive, fluid grid layout with draggable, resizable components.\n */\nclass GridLayoutPrototype extends React.Component<GridLayoutProps & DropProps, State> {\n  static displayName = \"GridLayout\";\n\n  static defaultProps: Partial<GridLayoutProps> = {\n    autoSize: true,\n    className: \"\",\n    style: {},\n    layout: null,\n    actionContext: {\n      updateSetting: utils.emptyFunc,\n      addLayout: utils.emptyFunc,\n      removeLayout: utils.emptyFunc,\n      resizeLayouts: utils.emptyFunc,\n      dndLayout: utils.emptyFunc,\n      activate: utils.emptyFunc,\n      removeWidget: utils.emptyFunc\n    }\n  };\n\n  state: State = {\n    // activeDrag: null,\n    breakpoint: '',\n    width: 0,\n    numOfCols: -1,\n    colWidth: 0,\n    pixelLayouts: {},\n    gridLayouts: {},\n    setting: DEFAULT_GRID_LAYOUT_SETTING,\n    layout: null\n  };\n\n  ref;\n  clientRect: ClientRect;\n\n  constructor(props: GridLayoutProps, context: any) {\n    super(props, context);\n    utils.autoBindHandlers(this, [\n      '_onItemResize'\n    ]);\n  }\n\n  componentDidMount() {\n    const domNode = this.ref as HTMLElement;\n    this.clientRect = domNode.getBoundingClientRect();\n  }\n\n  componentDidUpdate() {\n    const domNode = this.ref as HTMLElement;\n    this.clientRect = domNode.getBoundingClientRect();\n  }\n\n  static getDerivedStateFromProps(nextProps: GridLayoutProps, prevState: State) {\n    if (nextProps.layout !== prevState.layout) {\n      const layoutSetting = assign({}, DEFAULT_GRID_LAYOUT_SETTING, nextProps.layout.setting);\n      const { space, padding } = layoutSetting;\n      const breakpoint = gridUtils.getBreakpointFromWidth(layoutSetting.breakpoints, nextProps.width);\n      const colNo = gridUtils.getColsFromBreakpoint(breakpoint, layoutSetting.cols);\n      const colWidth = (nextProps.width - space * (colNo - 1) - padding[0] * 2) / colNo;\n      const breakpointLayouts = gridUtils.collectLayoutsAtBreakpoint(nextProps.layout.content, breakpoint, layoutSetting);\n      const layouts = gridUtils.generateResponsiveLayout(\n        breakpointLayouts,\n        colNo,\n        layoutSetting.compactType\n      );\n      const pixelLayouts = {}, gridLayouts = {};\n      layouts.forEach(layoutItem => {\n        gridLayouts[layoutItem.id] = Immutable(layoutItem.pos);\n        pixelLayouts[layoutItem.id] = Immutable(gridUtils.toPixelPosition(layoutItem.pos, layoutSetting, colWidth));\n      });\n\n      return {\n        breakpoint: breakpoint,\n        pixelLayouts: pixelLayouts,\n        gridLayouts: gridLayouts,\n        width: nextProps.width,\n        numOfCols: colNo,\n        colWidth: colWidth,\n        setting: layoutSetting,\n        layout: nextProps.layout\n      };\n    }\n    return null;\n  }\n\n  _onItemResize(id: string, x: number, y: number, dw: number, dh: number) {\n    const { numOfCols, gridLayouts, pixelLayouts, setting, colWidth, breakpoint } = this.state;\n    const l = gridLayouts[id];\n    const pixelLayout = pixelLayouts[id];\n\n    const resizingPos = {\n      x: x,\n      y: y,\n      w: pixelLayout.w + dw,\n      h: pixelLayout.h + dh\n    };\n    const moveToPosition = gridUtils.toGridPosition(resizingPos, setting, numOfCols, colWidth);\n\n    const layouts = Object.keys(gridLayouts).map(key => {\n      if (key !== id) {\n        return {\n          id: key,\n          pos: gridLayouts[key]\n        };\n      } else {\n        return {\n          id: key,\n          pos: moveToPosition\n        };\n      }\n    });\n\n    const isUserAction = true;\n    let newLayout = gridUtils.moveElement(\n      layouts,\n      id,\n      setting.compactType,\n      numOfCols,\n      moveToPosition.x,\n      moveToPosition.y,\n      isUserAction,\n      false,\n    );\n\n    // Re-compact the layout and set the drag placeholder.\n    newLayout = gridUtils.compact(newLayout, setting.compactType, numOfCols);\n    const newPixelLayouts = {}, newGridLayouts = {};\n\n    newLayout.forEach(layoutItem => {\n      const dPos = layoutItem.id === id ? resizingPos : null;\n      newGridLayouts[layoutItem.id] = Immutable(layoutItem.pos);\n      newPixelLayouts[layoutItem.id] = Immutable(gridUtils.toPixelPosition(layoutItem.pos, setting, colWidth, dPos, dPos))\n    });\n\n    const { actionContext } = this.props;\n\n    const newLayouts = Object.keys(newGridLayouts).map(key => {\n      return {\n        id: key,\n        layoutId: this.props.layout.layoutId,\n        pos: newGridLayouts[key]\n      };\n    });\n\n    actionContext.resizeLayouts(newLayouts, breakpoint);\n  }\n\n  /**\n   * Given a grid item, set its style attributes & surround in a <Draggable>.\n   */\n  processGridItem(l: Layout, key: number) {\n    const { pixelLayouts } = this.state;\n    const { appMode } = this.props;\n    const imPos = pixelLayouts[l.id];\n    const pos = {\n      x: imPos.x,\n      y: imPos.y,\n      w: imPos.w,\n      h: imPos.h\n    };\n\n    return <InteractItem\n      key={key}\n      pos={pos}\n      layout={l}\n      appMode={appMode}\n      disableInteract={appMode !== AppMode.Design}\n      onResizeEnd={this._onItemResize}>\n    </InteractItem>;\n  }\n\n  render() {\n    const { className, style, layout, connectDropTarget, isOver, draggingItem } = this.props;\n    const layouts = layout.content || [];\n    const isDropTaget = isOver === true && draggingItem &&\n      (draggingItem.layout.layoutId !== layout.layoutId || draggingItem.layout.parentId !== layout.id);\n    const mergedClassName = classNames(\"grid-layout\", className, {\n      'drop-target': isDropTaget === true\n    });\n\n    return ( connectDropTarget &&\n      connectDropTarget(\n        <div ref={(el) => this.ref = el } className={mergedClassName} style={style}\n          data-layoutitemid={layout.id}\n          data-layoutid={layout.layoutId}>\n          {layouts.map((layoutItem, index) => {\n            return this.processGridItem(layoutItem, index);\n          })}\n        </div>\n      )\n    );\n  }\n}\n\nconst spec = {\n  drop: (props: GridLayoutProps, monitor: DropTargetMonitor, component: GridLayoutPrototype) => {\n    if (!component || monitor.didDrop()) {\n      return;\n    }\n    const item = monitor.getItem() as {layout: Layout, width: number, height: number};\n    const actionContext = props.actionContext as LayoutActionContext;\n    // adjust the position of a layout item\n    if (item.layout.layoutId === props.layout.layoutId && item.layout.parentId === props.layout.id) {\n      const delta = monitor.getDifferenceFromInitialOffset();\n      const { pixelLayouts } = component.state;\n      const pixelLayout = pixelLayouts[item.layout.id];\n      component._onItemResize(item.layout.id, pixelLayout.x + delta.x, pixelLayout.y + delta.y, 0, 0);\n    } else {\n      // drag and drop a layout item from other layout\n      const { width, height } = item;\n      const clientOffset = monitor.getSourceClientOffset();\n      const { colWidth, setting } = component.state;\n      actionContext.dndLayout({\n        layoutItemId: item.layout.id,\n        layoutId: item.layout.layoutId\n      }, {\n        layoutItemId: props.layout.id,\n        layoutId: props.layout.layoutId\n      }, {\n        x: Math.round((clientOffset.x - component.clientRect.left) / colWidth),\n        y: Math.round((clientOffset.y - component.clientRect.top) / setting.rowHeight),\n        w: Math.round(width / colWidth),\n        h: Math.round(height / setting.rowHeight)\n      });\n    }\n  }\n}\n\nconst collect = (connect: DropTargetConnector, monitor: DropTargetMonitor) => {\n  return {\n    connectDropTarget: connect.dropTarget(),\n    isOver: monitor.isOver({shallow: true}),\n    draggingItem: monitor.getItem()\n  }\n}\n\nexport const GridLayout = DropTarget([DND_TYPES.LAYOUT], spec, collect)(GridLayoutPrototype);","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"/*\\n.action-handler {\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: 100%;\\n  height: 100%;\\n  border: 1px solid $edit-box-default-color;\\n  */\\n.handle {\\n  position: absolute; }\\n  .handle.handle-resize-corner {\\n    width: 8px;\\n    height: 8px;\\n    background-color: #fff;\\n    border: 1px solid #3899ec;\\n    border-radius: 50%;\\n    z-index: 1; }\\n    .handle.handle-resize-corner.top.left {\\n      top: -4px;\\n      left: -4px; }\\n    .handle.handle-resize-corner.top.right {\\n      top: -4px;\\n      right: -4px; }\\n    .handle.handle-resize-corner.bottom.right {\\n      bottom: -4px;\\n      right: -4px; }\\n    .handle.handle-resize-corner.bottom.left {\\n      bottom: -4px;\\n      left: -4px; }\\n  .handle.handle-resize-side.top {\\n    height: 4px;\\n    left: 4px;\\n    right: 4px;\\n    top: -2px; }\\n    .handle.handle-resize-side.top:after {\\n      content: \\\"\\\";\\n      width: 8px;\\n      height: 8px;\\n      background-color: #fff;\\n      border: 1px solid #3899ec;\\n      border-radius: 50%;\\n      position: absolute;\\n      left: 50%;\\n      top: 50%;\\n      margin-left: -4px;\\n      margin-top: -4px; }\\n  .handle.handle-resize-side.right {\\n    width: 4px;\\n    top: 4px;\\n    bottom: 4px;\\n    right: -2px; }\\n    .handle.handle-resize-side.right:after {\\n      content: \\\"\\\";\\n      width: 8px;\\n      height: 8px;\\n      background-color: #fff;\\n      border: 1px solid #3899ec;\\n      border-radius: 50%;\\n      position: absolute;\\n      top: 50%;\\n      right: 50%;\\n      margin-top: -4px;\\n      margin-right: -4px; }\\n  .handle.handle-resize-side.bottom {\\n    height: 4px;\\n    left: 4px;\\n    right: 4px;\\n    bottom: -2px; }\\n    .handle.handle-resize-side.bottom:after {\\n      content: \\\"\\\";\\n      width: 8px;\\n      height: 8px;\\n      background-color: #fff;\\n      border: 1px solid #3899ec;\\n      border-radius: 50%;\\n      position: absolute;\\n      left: 50%;\\n      bottom: 50%;\\n      margin-left: -4px;\\n      margin-bottom: -4px; }\\n  .handle.handle-resize-side.left {\\n    width: 4px;\\n    top: 4px;\\n    bottom: 4px;\\n    left: -2px; }\\n    .handle.handle-resize-side.left:after {\\n      content: \\\"\\\";\\n      width: 8px;\\n      height: 8px;\\n      background-color: #fff;\\n      border: 1px solid #3899ec;\\n      border-radius: 50%;\\n      position: absolute;\\n      top: 50%;\\n      left: 50%;\\n      margin-top: -4px;\\n      margin-left: -4px; }\\n\\n/* }*/\\n\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--6-1!../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./handle.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--6-1!../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./handle.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--6-1!../../../../node_modules/sass-loader/lib/loader.js??ref--6-2!../../../../node_modules/postcss-loader/lib/index.js??ref--6-3!./handle.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","\nimport * as React from 'react';\nimport assign = require(\"lodash.assign\");\nimport { DragDropContext } from 'react-dnd';\nimport HTML5Backend from 'react-dnd-html5-backend';\n// import debounce = require(\"lodash.debounce\");\nimport { DEFAULT_LAYOUT_SETTING } from './default-common-setting';\nimport * as ReactRedux from 'react-redux';\nimport {AllLayoutProps, LayoutProps, LayoutStateProps } from '../types/props';\nimport { IMState} from '../types/state';\nimport resizable from './react-dnd-resizable';\nimport { Layout, LayoutType, Position, LayoutActionContext, LayoutMap, CommonLayoutSetting, LayoutInfo } from './types';\nimport * as utils from './utils';\nimport { GridLayout } from './grid-layout/layout';\nimport { FixedLayout } from './fixed-layout/layout';\nimport { SidebarLayout } from './sidebar-layout/layout';\nimport SectionLayout from './section-layout/layout';\nimport { registerLayout } from './layout-factory';\nimport { LayoutItem } from './layout-item';\nimport { ActionContext } from './action-context';\nimport LayoutReduxStoreExtension from './global-layout-redux-store-extension';\nimport GlobalLayoutReduxStoreExtension from './global-layout-redux-store-extension';\nimport ExtensionManager from '../extension-manager';\nimport {ExtensionPoints} from '../extension-spec/extension-spec';\n\nimport {\n  addLayout,\n  removeLayout,\n  resizeLayouts,\n  activate,\n  updateSetting,\n  removeWidget,\n  dndLayout,\n  removeSection\n} from './actions/global-layout-actions';\nimport { AppMode } from '../types/constants';\n\nregisterLayout(LayoutType.FIXED_LAYOUT, FixedLayout);\nregisterLayout(LayoutType.GRID_LAYOUT, GridLayout);\nregisterLayout(LayoutType.SIDEBAR_LAYOUT, SidebarLayout);\nregisterLayout(LayoutType.SECTION_LAYOUT, SectionLayout);\n\ninterface State {\n  width?: number;\n  height?: number;\n  layout?: Layout;\n  layoutPos?: Position;\n}\n\nconst ResizableLayoutItem = resizable()(LayoutItem);\n\nclass JimuLayout extends React.PureComponent<AllLayoutProps & {width: number, height: number, appMode: AppMode}, State>{\n  // nodeRef;\n  // mounted: boolean;\n  // _debouncedResize;\n  state: State = {\n    layout: null\n  }\n\n  layoutActions: LayoutActionContext;\n\n  static getDerivedStateFromProps(nextProps: AllLayoutProps & {width: number, height: number}, prevState: State) {\n    if (nextProps.layout !== prevState.layout) {\n      const {layout, width, height} = nextProps;\n      const setting = assign({}, DEFAULT_LAYOUT_SETTING, layout.setting);\n      const layoutPos = utils.calPixelPosition(layout.pos, width, height, setting);\n      return {\n        layout: nextProps.layout,\n        width: nextProps.width,\n        height: nextProps.height,\n        layoutPos: layoutPos\n      };\n    }\n    return null;\n  }\n\n  constructor(props){\n    super(props);\n    // this.nodeRef = React.createRef();\n    // this.mounted = false;\n    ExtensionManager.getInstance().registerExtension({\n      epName: ExtensionPoints.ReduxStore,\n      extension: new LayoutReduxStoreExtension()\n    });\n    ExtensionManager.getInstance().registerExtension({\n      epName: ExtensionPoints.ReduxStore,\n      extension: new GlobalLayoutReduxStoreExtension()\n    });\n    utils.autoBindHandlers(this, ['_onItemResizeEnd']);\n\n    this.layoutActions = {\n      updateSetting: (info, newSetting) => {\n        this.props.dispatch(updateSetting(info, newSetting));\n      },\n      addLayout: (layoutId, parentId, pos, type?) => {\n        this.props.dispatch(addLayout(layoutId, parentId, pos, type));\n      },\n      removeLayout: (info) => {\n        this.props.dispatch(removeLayout(info));\n      },\n      resizeLayouts: (layouts, breakpoint) => {\n        this.props.dispatch(resizeLayouts(layouts, breakpoint));\n      },\n      activate: (info) => {\n        this.props.dispatch(activate(info));\n      },\n      dndLayout: (layoutInfo, parentId, newPosition) => {\n        this.props.dispatch(dndLayout(layoutInfo, parentId, newPosition));\n      },\n      removeWidget: (widgetId) => {\n        this.props.dispatch(removeWidget(widgetId));\n      },\n      removeSection: (sectionId) => {\n        this.props.dispatch(removeSection(sectionId));\n      }\n    };\n  }\n\n  // _onItemResize(id: string, x: number, y: number, dw: number, dh: number) {\n  //   if (!this._isInDesignMode()) {\n  //     return;\n  //   }\n  //   const {width, height} = this.state;\n  //   this.setState({\n  //     width: width + dw,\n  //     height: height + dh\n  //   });\n  // }\n\n  _onItemResizeEnd(id: string, x: number, y: number, dw: number, dh: number) {\n    if (!this._isInDesignMode()) {\n      return;\n    }\n    const { pos } = this.props.layout;\n    const {width, height} = this.state;\n    const setting = assign({}, DEFAULT_LAYOUT_SETTING, this.props.layout.setting);\n    const layoutPos = utils.calPixelPosition(pos, width, height, setting);\n\n    layoutPos.w += dw;\n    layoutPos.h += dh;\n\n    const newPos = utils.calLayoutPosition(layoutPos, width, height, setting);\n    this.props.dispatch(resizeLayouts([{\n      id: id,\n      layoutId: this.props.layout.layoutId,\n      pos: newPos\n    }]));\n  }\n\n  _isInDesignMode() {\n    const { appMode } = this.props;\n    return appMode === AppMode.Design;\n  }\n\n  render(){\n    const {width, height, layout} = this.state;\n    if (!layout) {\n      return null;\n    }\n\n    const { appMode } = this.props;\n    const setting = assign({}, DEFAULT_LAYOUT_SETTING, layout.setting);\n    const layoutPos = utils.calPixelPosition(layout.pos, width, height, setting);\n    const style = {\n      width: '100%',\n      height: '100%'\n    };\n\n    return (\n      <ActionContext.Provider value={this.layoutActions}>\n        <div className=\"layout\" style={style}>\n          <ResizableLayoutItem\n            layout={layout}\n            pos={layoutPos}\n            appMode={appMode}\n            left={false}\n            top={false}\n            disableInteract={appMode !== AppMode.Design}\n            onResizeEnd={this._onItemResizeEnd}\n            style={{\n              position: 'relative',\n              margin: '0 auto'\n            }}>\n          </ResizableLayoutItem>\n        </div>\n      </ActionContext.Provider>\n    );\n  }\n}\n\nconst mapStateToProps = (state: IMState) => {\n  return {\n    appConfig: state.appConfig,\n    appMode: state.appMode\n  }\n};\n\n//connect<IMapStateToProps, IMapDispatchToProps, ICompProps, IReduxState>(mapStateToProps, mapDispatchToProps)\nconst connectedLayoutEntry = ReactRedux.connect<LayoutStateProps, {}, LayoutProps & {width: number, height: number}>(\n  mapStateToProps)(JimuLayout);\n\nexport default DragDropContext(HTML5Backend)(connectedLayoutEntry);","// TODO: remove unused imports\n// import * as React from 'react';\n// import { connect } from 'react-redux';\n// import {ImmutableObject, ImmutableArray} from 'seamless-immutable';\nimport * as SeamlessImmutable from 'seamless-immutable';\nimport {store} from './store';\nimport {AppConfig, IMAppConfig, IMWidgetJson, IMWidgetContext} from './types/app-config';\n// import {IMState} from './types/state';\nimport {getWidgetContext, getAllWidgets, addWidgetDefaultLabelAndIcon} from './utils/app-config';\nimport WidgetManager from './widget-manager';\nimport MessageManager from './message-manager';\nimport ExtensionManager from './extension-manager';\nimport SessionManager from './session-manager';\nimport {AppConfigProcessorExtension, ExtensionPoints, AppConfigServiceExtension} from './extension-spec/extension-spec';\n\nimport { getItemData } from '@esri/arcgis-rest-items';\nimport { AppMode } from './types/constants';\n\nexport default class ConfigManager{\n  \n  static instance: ConfigManager;\n\n  static getInstance(){\n    if(!ConfigManager.instance){\n      ConfigManager.instance = new ConfigManager();\n    }\n    return ConfigManager.instance;\n  }\n\n  loadAppConfig(): Promise<IMAppConfig>{\n    return this.loadRawAppConfig().then(appConfig => {\n      this.processAppConfigAfterLoad(appConfig);\n      return this.loadAllWidgetsManifest(appConfig);\n    }).then(appConfig => {\n      this.addDefaultLabelAndIcon(appConfig);\n      return this.loadAndUpgradeAllWidgetsConfig(appConfig);\n    }).then(appConfig => {\n      return this.registerAllWidgetExtensions(appConfig);\n    }).then(appConfig => {\n      return this.applyAppConfigProcessorExtension(appConfig);\n    }).then(appConfig => {\n      return this.createAllWidgetMessageActions(appConfig);\n    }).then(appConfig => {\n      this.setDocumentTitle(appConfig.attributes.title);\n      return SeamlessImmutable(appConfig);\n    });\n  }\n\n  private setDocumentTitle(title: string) {\n    if(!title){\n      return;\n    }\n    if(!store.getState().appContext.isBuilder && (store.getState().appMode === AppMode.Preview || store.getState().appMode === AppMode.Run)) {\n      //TODO sanitize\n      document.title = title;\n    }\n  }\n\n  registerAllWidgetExtensions(appConfig: AppConfig): Promise<AppConfig> {\n    return ExtensionManager.getInstance().registerAllWidgetExtensions(appConfig).then(() => {\n      return appConfig;\n    });\n  }\n\n  createAllWidgetMessageActions(appConfig: AppConfig): Promise<AppConfig> {\n    return MessageManager.getInstance().createMessageActions(appConfig as IMAppConfig).then(() => {\n      return appConfig;\n    });\n  }\n\n  loadRawAppConfig(): Promise<AppConfig>{\n    let extension = ExtensionManager.getInstance().getExtensions(ExtensionPoints.AppConfigService)[0];\n    if(!extension){\n      return this.loadAppConfigWithDefault();\n    }\n\n    return (extension as AppConfigServiceExtension).loadAppConfig();\n  }\n\n  /**\n   * By default, app support these URL parameters that related to load app config:\n   *  ?config=<url>: relative or absolute URL\n   *  ?id=<app id>: the item id.\n   *    * How to get portal URL?\n   *      TODO\n   */\n  loadAppConfigWithDefault(): Promise<AppConfig>{\n    if(!store.getState().appContext.isBuilder){\n      if(store.getState().queryObject.id){\n        return this.loadAppConfigFromPortal(store.getState().queryObject.id);\n      }\n    }\n    let configUrl = store.getState().queryObject.config;\n    if(!configUrl){\n      configUrl = 'config.json';\n    }\n    return fetch(configUrl).then(res => {\n      return res.json();\n    }).then(appConfig => {\n      return appConfig;\n    });\n  }\n\n  loadAppConfigFromPortal(appId: string): Promise<AppConfig>{\n    const sessionManager = SessionManager.getInstance();\n\n    // init session from the cookie if any\n    sessionManager.initFromLocalStorage();\n\n    // fetch the item's data\n    return getItemData(appId, {\n      authentication: sessionManager.getSession()\n    })\n    // retry if request was unauthenticated and the item is not shared with everyone\n    .catch(sessionManager.handleAuthError.bind(sessionManager));\n  }\n\n  applyAppConfigProcessorExtension(appConfig: AppConfig): Promise<AppConfig>{\n    let extension = ExtensionManager.getInstance().getExtensions(ExtensionPoints.AppConfigProcessor)[0];\n    if(!extension){\n      return Promise.resolve(appConfig);\n    }\n\n    return (extension as AppConfigProcessorExtension).process(appConfig);\n  }\n\n  loadAllWidgetsManifest(appConfig: AppConfig): Promise<AppConfig>{\n    let promises = [];\n    getAllWidgets(appConfig as IMAppConfig).forEach((w: IMWidgetJson, info) => {\n      if(!w.uri){\n        return;\n      }\n      promises.push(WidgetManager.getInstance().loadWidgetManifest(w).then(manifest => {\n        w.manifest = manifest;\n        return w;\n      }));\n    });\n\n    return Promise.all(promises).then(manifests => {\n      return appConfig;\n    });\n  }\n\n  loadAndUpgradeAllWidgetsConfig(appConfig: AppConfig): Promise<AppConfig>{\n    let promises = [];\n    getAllWidgets(appConfig as IMAppConfig).forEach((w: IMWidgetJson, info) => {\n      if(!w.uri){\n        return;\n      }\n      promises.push(WidgetManager.getInstance().loadWidgetConfig(w));\n    });\n\n    return Promise.all(promises).then(manifests => {\n      return appConfig;\n    })\n  }\n\n  processAppConfigAfterLoad(appConfig: AppConfig){\n    this.addWidgetContext(appConfig);\n    this.addDefaultValues(appConfig);\n  }\n\n  addWidgetContext(appConfig: AppConfig){\n    getAllWidgets(appConfig as IMAppConfig).forEach(w => {\n      let uriInfo = getWidgetContext(w.uri);\n      w.context = uriInfo as IMWidgetContext;\n    });\n  }\n\n  addDefaultValues(appConfig: AppConfig) {\n    // this.addDefaultPortalUrl(appConfig);\n    // this.addDefaultGeometryService(appConfig);\n    // this.addDefaultStyle(appConfig);\n    // this.addDefaultMap(appConfig);\n    // this.addDefaultDataSource(appConfig);\n    // this.addDefaultSharedTheme(appConfig);\n    if(!appConfig.attributes){\n      appConfig.attributes = {} as any;\n    }\n\n    //TODO for demo\n    if(!appConfig.sharedArea){\n      appConfig.sharedArea = {\n        header: {},\n        footer: {},\n        leftArea: {},\n        rightArea: {},\n        layout: '__app_layout'\n      } as any;\n    }\n\n    let defaultAppLayout = {\n      '__app_layout': {\n        \"0\": {\n          \"id\": \"0\",\n          \"pos\": {\n            \"x\": 0,\n            \"y\": 0,\n            \"w\": 100,\n            \"h\": 100\n          },\n          \"type\": \"sidebar\",\n          \"setting\": {\n            \"widthInPixel\": false,\n            \"alignCenter\": true,\n            \"heightInPixel\": false\n          }\n        },\n        \"1\": {\n          \"id\": \"1\",\n          \"parentId\": \"0\",\n          \"pos\": {\n            \"x\": 0,\n            \"y\": 0,\n            \"h\": 50\n          },\n          \"type\": \"fixed\",\n          \"setting\": {\n            \"attach\": \"top\",\n            \"togglable\": false\n          }\n        },\n        \"2\": {\n          \"id\": \"2\",\n          \"parentId\": \"0\",\n          \"pos\": {\n            \"x\": 0,\n            \"y\": 0,\n            \"h\": 50\n          },\n          \"type\": \"fixed\",\n          \"setting\": {\n            \"attach\": \"bottom\",\n            \"togglable\": false\n          }\n        },\n        \"3\": {\n          \"id\": \"3\",\n          \"parentId\": \"0\",\n          \"pos\": {\n            \"x\": 0,\n            \"y\": 0,\n            \"w\": 50\n          },\n          \"type\": \"fixed\",\n          \"setting\": {\n            \"attach\": \"left\",\n            \"togglable\": false\n          }\n        },\n        \"4\": {\n          \"id\": \"4\",\n          \"parentId\": \"0\",\n          \"pos\": {\n            \"x\": 0,\n            \"y\": 0,\n            \"w\": 50\n          },\n          \"type\": \"fixed\",\n          \"setting\": {\n            \"attach\": \"right\",\n            \"togglable\": false\n          }\n        }\n      }\n    } as any;\n\n    if(!appConfig.layouts){\n      appConfig.layouts = defaultAppLayout;\n    }else if(!appConfig.layouts['__app_layout']){\n      appConfig.layouts = Object.assign(appConfig.layouts, defaultAppLayout);\n    }\n    return appConfig;\n  }\n\n\n  addDefaultLabelAndIcon(appConfig: AppConfig){\n    getAllWidgets(appConfig as IMAppConfig).forEach(widgetJson => {\n      addWidgetDefaultLabelAndIcon(widgetJson);\n    });\n\n  }\n}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport * as invariant from 'invariant';\n\nimport {ImmutableObject} from 'seamless-immutable';\nimport debounce = require(\"lodash.debounce\");\nimport {connect} from 'react-redux';\nimport ConfigManager from './config-manager';\nimport {IMAppConfig} from './types/app-config';\nimport * as actions from './app-actions';\n\nimport JimuLayout from './layouts/layout-entry';\nimport JimuLayoutViewer from './layouts/layout-viewer-entry';\nimport { AppConfig, IMPageJson } from './types/app-config';\nimport { generateLayoutStructure } from './layouts/utils';\nimport { GlobalLayouts, Layout, AttachType, SidebarItemSetting } from './layouts/types';\nimport {UrlParameters} from './types/url-parameters';\nimport { isMobileSize } from './utils/utils';\n\ninterface Props{\n  dispatch;\n  appConfig: IMAppConfig;\n  queryObject: UrlParameters;\n  isMobile: boolean;\n}\n\nclass AppRootComponent extends React.PureComponent<Props, {width: number, height: number}>{\n  rootRef;\n  mounted: boolean;\n  _debouncedResize;\n\n  constructor(props){\n    super(props);\n    this.rootRef = React.createRef();\n    this.mounted = false;\n  }\n\n  componentDidMount(){\n    ConfigManager.getInstance().loadAppConfig().then(appConfig => {\n      this.props.dispatch(actions.appConfigLoaded(appConfig));\n\n      this.props.dispatch(actions.initStoreExtensionState());\n    });\n    this._debouncedResize = debounce(this.updateDimensions.bind(this), 100);\n    window.addEventListener(\"resize\", this._debouncedResize);\n    this.mounted = true;\n    const node: HTMLElement = this.rootRef.current;\n    const rect = node.getBoundingClientRect();\n    this.setState({\n      width: rect.width,\n      height: rect.height\n    });\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this._debouncedResize);\n  }\n\n  updateDimensions() {\n    const windowWidth = window.innerWidth ||\n      document.documentElement.clientWidth ||\n      document.body.clientWidth\n    const windowHeight = window.innerHeight ||\n      document.documentElement.clientHeight ||\n      document.body.clientHeight\n    this.setState({ width: windowWidth, height: windowHeight });\n\n    let isMobile = isMobileSize({ width: windowWidth, height: windowHeight });\n    if(this.props.isMobile !== isMobile){\n      this.props.dispatch(actions.isMobileChanged(isMobile));\n    }\n  }\n\n  _prepareLayout() {\n\n  }\n\n  render(){\n    if (!this.mounted) {\n      return <div style={{height: '100vh', width: '100vw'}} ref={this.rootRef}></div>;\n    }\n\n    if(!this.props.appConfig) {\n      return <div style={{height: '100vh', width: '100vw', display: 'flex', justifyContent: 'center', alignItems: 'center'}}>Loading...</div>;\n    }\n    const pageId = this.props.queryObject.page ? this.props.queryObject.page: 'default';\n    const page = this.props.appConfig.pages[pageId];\n    const layoutId = this.props.isMobile && page.mobileLayout ? page.mobileLayout : page.layout;\n\n    const rootLayout = preparePageLayout(page, this.props.appConfig, this.props.isMobile);\n    let skin = this.props.appConfig.skin;\n    let skinsFolder = window.amdRequire.toUrl('skins');\n    const {width, height} = this.state;\n    return <div ref={this.rootRef} style={{width: '100%', height: '100%'}}>\n        { skin ? ReactDOM.createPortal(\n        <link type=\"text/css\" rel=\"stylesheet\" href={`${skinsFolder}/${skin}/index.css`} />,\n        document.head) : null }\n        {renderPageLayout(page, rootLayout, width, height)}\n    </div>;\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    appConfig: state.appConfig,\n    queryObject: state.queryObject,\n    isMobile: state.appContext.isMobile\n  };\n};\n\nexport default connect(mapStateToProps)(AppRootComponent)\n\nfunction renderPageLayout(pageJson: IMPageJson, layout: Layout, width: number, height: number) {\n  if (window.jimuConfig.isInBuilder) {\n    return <div className='page'>\n      <JimuLayout layout={layout} width={width} height={height}></JimuLayout>\n    </div>;\n  }\n  return <div className='page'>\n    <JimuLayoutViewer layout={layout} width={width} height={height}></JimuLayoutViewer>\n  </div>;\n}\n\nfunction preparePageLayout(page: IMPageJson, appConfig: ImmutableObject<AppConfig>, isMobile: boolean) {\n  const layoutId = isMobile && page.mobileLayout ? page.mobileLayout : page.layout;\n  const layout = appConfig.layouts[layoutId];\n  invariant(layout, `Unknown layout id. ${layoutId}`);\n  const pageBodyLayout = generateLayoutStructure(layoutId, appConfig.layouts as GlobalLayouts);\n\n  let sa = appConfig.sharedArea;\n  if(sa) {\n    const saLayoutId = isMobile && sa.mobileLayout ? sa.mobileLayout : sa.layout;\n    const saLayout = appConfig.layouts[saLayoutId];\n    invariant(layout, `Unknown sharedArea layout id. ${saLayoutId}`);\n    const filterSaLayout = handleSharedArea(sa, saLayout as {[key:string]: Layout}, page);\n    const filterLayouts = appConfig.layouts.set(saLayoutId, filterSaLayout);\n    let pageLayout = generateLayoutStructure(saLayoutId, filterLayouts as GlobalLayouts);\n    pageLayout = pageLayout.update('content', value => [].concat(pageLayout.content || [], pageBodyLayout));\n    return pageLayout;\n  } else {\n    return pageBodyLayout;\n  }\n}\n\nfunction handleSharedArea(sharedArea, saLayout: {[key:string]: Layout}, page: IMPageJson){\n  const layout = {};\n  let keys = ['header', 'footer', 'leftArea', 'rightArea'];\n\n  //shared area must use sidebar-layout\n  Object.keys(saLayout).forEach(key => {\n    const setting = saLayout[key].setting as SidebarItemSetting || {};\n    switch (setting.attach) {\n      case AttachType.TOP: {\n        if(sharedArea['header'] && page.sharedArea && page.sharedArea.header){\n          layout[key] = saLayout[key];\n        }\n        break;\n      }\n      case AttachType.BOTTOM: {\n        if(sharedArea['footer'] && page.sharedArea && page.sharedArea.footer){\n          layout[key] = saLayout[key];\n        }\n        break;\n      }\n      case AttachType.LEFT: {\n        if(sharedArea['leftArea'] && page.sharedArea && page.sharedArea.leftArea){\n          layout[key] = saLayout[key];\n        }\n        break;\n      }\n      case AttachType.RIGHT: {\n        if(sharedArea['rightArea'] && page.sharedArea && page.sharedArea.rightArea){\n          layout[key] = saLayout[key];\n        }\n        break;\n      }\n      default: {\n        // if (saLayout[key].type === LayoutType.SIDEBAR_LAYOUT) {\n          layout[key] = saLayout[key]\n        // }\n        break;\n      }\n    }\n  })\n  return layout;\n}\n\n","import * as SeamlessImmutable from 'seamless-immutable';\nimport {ImmutableObject} from \"seamless-immutable\";\n\nimport {ActionKeys, ActionTypes, AppConfigChangedAction, WidgetStatePropChangeAction, QueryObjectChangedAction} from './app-actions';\nimport {State, IMState, IMRuntimeInfo, DataSourceInfo} from './types/state';\nimport {IMWidgetJson, WidgetJson} from './types/app-config';\nimport {AppMode} from './types/constants';\nimport ExtensionManager from './extension-manager';\nimport {ExtensionPoints, ReduxStoreExtension} from './extension-spec/extension-spec';\nimport {DataSourceStatus} from './data-source/base-types';\n\n\nexport default function rootReducer(state: IMState, action: ActionTypes){\n  if(!state){\n    return initState();\n  }\n  switch(action.type){\n    case ActionKeys.InitStoreExtensionState:\n      return initStoreExtensionState(state);\n    case ActionKeys.AppConfigLoaded:\n      let s = state.set('appConfig', action.appConfig);\n      if(action.appConfig.attributes.portalUrl){\n        s = s.set('portalUrl', action.appConfig.attributes.portalUrl);\n      }\n      return s;\n    case ActionKeys.InitPortalUrl:\n      return state.set('portalUrl', action.portalUrl);\n    case ActionKeys.AppConfigChanged:\n      return handleAppConfigChange(state, action);\n    case ActionKeys.AppModeChanged:\n      return state.set('appMode', action.mode);\n    case ActionKeys.AppContextInit:\n      return state.set('appContext', action.appContext);\n    case ActionKeys.JimuCoreNlsLoaded:\n      return state.set('jimuCoreNls', action.nls);\n    case ActionKeys.QueryObjectChanged:\n      return handleQueryObjectChange(state, action);\n      \n    case ActionKeys.SetAppInBuilder:\n      return state.set('appContext', state.appContext.merge({isInBuilder: true}));\n\n    case ActionKeys.WidgetClassLoaded:\n      return handleWidgetClassLoaded(state, action.widgetId);\n    case ActionKeys.OpenWidget:\n      return handleOpenWidet(state, action.widgetId);\n    case ActionKeys.CloseWidget:\n      return handleCloseWidet(state, action.widgetId);\n    case ActionKeys.ToggleWidgetHighLight:\n      return toggleWidgetHighlight(state, action.widgetId, action.isHighlight);\n    case ActionKeys.SetWidgetIsSettingState:\n      if(action.isSetting === false){\n        return state.setIn(['widgetsRuntimeInfo', action.widgetId, 'isSetting'], false);\n      }\n      //only one widget can be is setting\n      Object.keys(state.widgetsRuntimeInfo).forEach(wId => {\n        if(state.widgetsRuntimeInfo[wId].isSetting){\n          state = state.setIn(['widgetsRuntimeInfo', wId, 'isSetting'], false);\n        }\n      });\n      return state.setIn(['widgetsRuntimeInfo', action.widgetId, 'isSetting'], true);\n\n    case ActionKeys.LayoutClassLoaded:\n      return state.setIn(['isLayoutClassLoaded', action.layoutName], true);\n\n    case ActionKeys.DataSourceStatusChanged:\n      return state.setIn(['dataSourcesInfo', action.dataSourceId, 'status'], action.status);\n      \n    case ActionKeys.WidgetStatePropChange:\n      return handleWidgetPropChange(state, action);\n    \n    case ActionKeys.DataSourceCurrentIndexesChanged:\n      return state.setIn(['dataSourcesInfo', action.dataSourceId, 'currentIndexes'], action.currentIndexes);\n\n    case ActionKeys.SessionStart:\n      return state.set('token', action.token);\n    case ActionKeys.UserSignIn:\n      return state.set('user', SeamlessImmutable(action.user));\n    case ActionKeys.UserSignOut:\n      return state.merge({ token: null, user: null });\n    \n    case ActionKeys.IsMobileChanged:\n      return state.setIn(['appContext', 'isMobile'], action.isMobile);\n\n    default:\n      return dispatchActionToExtension(state, action);\n  }\n}\n\nfunction initState(): IMState{\n  const INIT_STATE: State = ({\n    appConfig: null,\n    // TODO: how to get portal URL from environment config?\n    portalUrl: 'https://www.arcgis.com/sharing/rest',\n    widgetsRuntimeInfo: SeamlessImmutable({}) as ImmutableObject<{[id: string]: IMRuntimeInfo}>,\n\n    appContext: null,\n\n    appMode: AppMode.Run,\n    jimuCoreNls: null,\n    queryObject: null,\n\n    dataSourcesInfo: SeamlessImmutable({}) as ImmutableObject<{[dsId: string]: DataSourceInfo}>,\n\n    widgetState: {},\n\n    token: null,\n    user: null\n  });\n\n  return SeamlessImmutable(INIT_STATE);\n}\n\nfunction initStoreExtensionState(state: IMState): IMState{\n  let extensions = ExtensionManager.getInstance().getExtensions(ExtensionPoints.ReduxStore);\n  for(let i = 0; i < extensions.length; i++){\n    let storeExt = extensions[i] as ReduxStoreExtension;\n    let storeKeySegs = storeExt.getStoreKey().split('.');\n    if(state.getIn(storeKeySegs)){\n      continue;\n    }\n    state = state.setIn(storeKeySegs, storeExt.getInitLocalState());\n  }\n\n  return state;\n}\n\nfunction dispatchActionToExtension(state: IMState, action): IMState{\n  let extensions = ExtensionManager.getInstance().getExtensions(ExtensionPoints.ReduxStore);\n  for(let i = 0; i < extensions.length; i++){\n    let storeExt = extensions[i] as ReduxStoreExtension;\n    if(storeExt.getActions().indexOf(action.type) > -1){\n      let storeKeySegs = storeExt.getStoreKey().split('.');\n      let localState = state.getIn(storeKeySegs);\n      return state.setIn(storeKeySegs, storeExt.getReducer()(localState, action, state));\n    }\n  }\n\n  return state;\n}\n\nfunction handleAppConfigChange(state: IMState, action: AppConfigChangedAction){\n  state = state.set('appConfig', action.appConfig);\n  state = state.set('widgetsRuntimeInfo', state.widgetsRuntimeInfo.without.apply(state.widgetsRuntimeInfo, action.appConfigDiff.removedWidgets));\n  return state;\n}\n\nfunction handleQueryObjectChange(state: IMState, action: QueryObjectChangedAction){\n  state = state.set('queryObject', SeamlessImmutable(action.query));\n  return state;\n}\n\nfunction handleWidgetPropChange(state: IMState, action: WidgetStatePropChangeAction){\n  let storeKeySegs = action.propKey.split('.');\n  return state.setIn(['widgetState', action.widgetId].concat(storeKeySegs), action.value);\n}\n\nfunction handleWidgetClassLoaded(state: IMState, widgetId: string){\n  if(!state.widgetsRuntimeInfo[widgetId]){\n    return state.setIn(['widgetsRuntimeInfo', widgetId], {\n      isClassLoaded: true,\n      state: 'closed',\n      windowState: 'normal',\n    } as IMRuntimeInfo);\n  }\n  if(state.widgetsRuntimeInfo[widgetId].isClassLoaded){\n    return state;\n  }\n\n  return state.setIn(['widgetsRuntimeInfo', widgetId, 'isClassLoaded'], true);\n}\n\nfunction handleOpenWidet(state: IMState, widgetId: string){\n  if(state.widgetsRuntimeInfo[widgetId].state !== 'closed'){\n    return state;\n  }\n\n  return state.setIn(['widgetsRuntimeInfo', widgetId, 'state'], 'opened');\n}\n\nfunction handleCloseWidet(state: IMState, widgetId: string){\n  if(state.widgetsRuntimeInfo[widgetId].state === 'closed'){\n    return state;\n  }\n\n  return state.setIn(['widgetsRuntimeInfo', widgetId, 'state'], 'closed');\n}\n\nfunction toggleWidgetHighlight(state: IMState, widgetId: string, isHighlight: boolean){\n  if(isHighlight === false){\n    return state.setIn(['widgetsRuntimeInfo', widgetId, 'isHighlight'], false);\n  }\n  //only one widget can be is highlight\n  Object.keys(state.widgetsRuntimeInfo).forEach(wId => {\n    if(state.widgetsRuntimeInfo[wId].isHighlight){\n      state = state.setIn(['widgetsRuntimeInfo', wId, 'isHighlight'], false);\n    }\n  });\n  return state.setIn(['widgetsRuntimeInfo', widgetId, 'isHighlight'], true);\n}\n//////////////////////// handle actions to app\n\nfunction handleWidgetChanged(state: IMState, widgetJson: WidgetJson){\n  // this._updateDataSourceForWidget(newJson);\n  // let oldJson = state.appConfig.getConfigElementById(widgetJson.id).asMutable();\n\n  // oldJson.label = widgetJson.label;\n  // oldJson.icon = widgetJson.icon;\n  // oldJson.config = widgetJson.config;\n\n  // return state.set('appConfig', state.appConfig.updateConfigElementJson(oldJson));\n  return state;\n}\n/////////////////////utils\n\n\n","import * as React from 'react';\nimport {Provider } from 'react-redux';\nimport {store} from './store';\nimport ConfigManager from './config-manager';\nimport * as actions from './app-actions';\nimport AppRootComponent from './app-root-component';\nimport {HistoryProvider} from './browser-history';\n\n\ninterface ErrorState{\n  error: Error;\n}\nclass ErrorBoundary extends React.Component<{}, ErrorState> {\n  constructor(props) {\n    super(props);\n    this.state = { error: null };\n  }\n\n  componentDidCatch(error, info) {\n    // Display fallback UI\n    this.setState({ error: error });\n  }\n\n  render() {\n    if (this.state.error) {\n      return <h1>this.state.error</h1>;\n    }\n    return this.props.children;\n  }\n}\n\ninterface State{\n  appConfigLoaded: boolean;\n}\n\nexport default class AppRoot extends React.PureComponent<{}, State>{\n  constructor(props){\n    super(props);\n  }\n\n  render(){\n    return <Provider store={store}>\n      <ErrorBoundary>\n        <HistoryProvider>\n          <AppRootComponent/>\n        </HistoryProvider>\n      </ErrorBoundary>\n    </Provider>;\n  }\n}\n\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport * as ReactRedux from 'react-redux';\nimport * as queryString from 'query-string';\nimport * as SeamlessImmutable from 'seamless-immutable';\nimport * as classNames from 'classnames';\nimport {ImmutableObject, ImmutableArray} from 'seamless-immutable';\n\nimport I18NManager from './lib/i18n-manager';\nimport ExtensionManager from './lib/extension-manager';\nimport {ExtensionPoints} from './lib/extension-spec/extension-spec';\nimport AppRoot from './lib/app-root';\nimport {isMobileBrowser, isMobileSize} from './lib/utils/utils';\nimport {listenBuilderEvents, publishAppStateChangeToBuilder} from './lib/app-builder-sync';\nimport {store} from './lib/store';\nimport {AppContext} from './lib/types/state';\nimport {initAppContext, jimuCoreNlsLoaded, queryObjectChanged} from './lib/app-actions';\nimport {LayoutInfo} from './lib/layouts/types';\nimport * as layoutActions from './lib/layouts/actions/global-layout-actions';\nimport BaseWidget from './lib/base-widget';\nimport WidgetManager from './lib/widget-manager';\nimport DataSourceManager from './lib/data-source-manager';\nimport MessageManager from './lib/message-manager';\nimport SessionManager from './lib/session-manager';\nimport * as appActions from './lib/app-actions';\nimport * as appBuilderSync from './lib/app-builder-sync';\nimport * as extensionSpec from './lib/extension-spec/extension-spec';\nimport * as utils from './lib/utils/utils';\nimport * as urlUtils from './lib/utils/url-utils';\nimport * as appConfigUtils from './lib/utils/app-config';\n\nexport {AppRoot, React, ReactDOM, ExtensionManager, ExtensionPoints, BaseWidget, WidgetManager, DataSourceManager, urlUtils, SessionManager, LayoutInfo, layoutActions,\nappActions, appBuilderSync, extensionSpec, utils, appConfigUtils, store, ReactRedux, I18NManager, MessageManager, SeamlessImmutable, ImmutableArray, ImmutableObject, classNames,\n};\n\nexport * from './lib/types/props';\nexport * from './lib/types/state';\nexport * from './lib/types/app-config';\nexport * from './lib/types/jimu-config';\nexport * from './lib/types/url-parameters';\nexport * from './lib/types/state';\nexport * from './lib/types/app-info';\nexport * from './lib/types/manifest';\nexport * from './lib/data-source/base-types';\nexport * from './lib/amd-loader';\nexport * from './lib/message/base-types';\nexport * from './lib/types/constants';\nexport * from './lib/browser-history';\n\nexport function init(): Promise<void>{\n  let isMobile = isMobileSize({\n    width: window.innerWidth,\n    height: window.innerHeight\n  });\n  let queryObject = queryString.parse(location.search);\n  \n  let appContext:AppContext = {\n    isInBuilder: window.jimuConfig.isInBuilder,\n    isBuilder: window.jimuConfig.isBuilder,\n    locale: window.jimuConfig.locale,\n    appPath: window.jimuConfig.appPath,\n    isRTL: isRTL(window.jimuConfig.locale),\n    isMobile: isMobile\n  };\n\n  setRTL(appContext.locale);\n  store.dispatch(initAppContext(appContext));\n  store.dispatch(queryObjectChanged(queryObject));\n\n  if(!window.jimuConfig.isBuilder){\n    listenBuilderEvents();\n  }\n\n  let currentState = store.getState();\n  store.subscribe(() => {\n    if(!window.jimuConfig.isBuilder){\n      if(currentState !== store.getState()){\n        currentState = store.getState();\n        publishAppStateChangeToBuilder();\n      }\n    }\n\n    window._appState = store.getState();\n  });\n\n  return I18NManager.getInstance().loadNls('jimu-core/lib/nls/strings').then((jimuNls) => {\n    store.dispatch(jimuCoreNlsLoaded(jimuNls))\n    return;\n  })\n}\n\nfunction localeIsSame(locale1, locale2){\n  return locale1.split('-')[0] === locale2.split('-')[0];\n}\n\nfunction isRTL(locale){\n  var isRTLLocale = false;\n  var rtlLocales = [\"ar\", \"he\"];\n  for (var i = 0; i < rtlLocales.length; i++) {\n    if (localeIsSame(rtlLocales[i], locale)) {\n      isRTLLocale = true;\n    }\n  }\n  return isRTLLocale;\n}\n\nfunction setRTL(locale){\n  var dirNode = document.getElementsByTagName(\"html\")[0];\n  let isRTLLocale = isRTL(locale);\n\n  if (isRTLLocale) {\n    dirNode.setAttribute(\"dir\", \"rtl\");\n    dirNode.className += \" esriRtl jimu-rtl\";\n    dirNode.className += \" \" + locale + \" \" +\n      (locale.indexOf(\"-\") !== -1 ? locale.split(\"-\")[0] : \"\");\n  }else {\n    dirNode.setAttribute(\"dir\", \"ltr\");\n    dirNode.className += \" esriLtr jimu-ltr\";\n    dirNode.className += \" \" + locale + \" \" +\n      (locale.indexOf(\"-\") !== -1 ? locale.split(\"-\")[0] : \"\");\n  }\n}\n"],"sourceRoot":""}