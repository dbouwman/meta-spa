{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./jimu-arcgis/lib/utils/portal-url-utils.ts","webpack:///external \"esri/portal/PortalItem\"","webpack:///external \"esri/identity/IdentityManager\"","webpack:///external \"esri/request\"","webpack:///external \"esri/config\"","webpack:///external \"esri/portal/Portal\"","webpack:///./jimu-arcgis/lib/services/portal/portal-service.ts","webpack:///./jimu-arcgis/portal.tsx"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","getServerByUrl","_url","trim","replace","indexOf","slice","split","getDomain","url","serverName","matched","result","match","test","isOnline","toLowerCase","isArcGIScom","server","getStandardPortalUrl","_portalUrl","getProtocol","addProtocol","pattern","RegExp","defaultProtocol","window","location","protocol","startWith","host","setHttpProtocol","setHttpsProtocol","getBaseItemUrl","baseItemUrl","portalUrl","getItemUrl","_itemId","itemUrl","getBaseUserUrl","baseUserUrl","getUserUrl","_userId","userUrl","getContentUrl","contentUrl","getUserContentUrl","_user","_folderId","userContentUrl","getUserItemsUrl","userItemsUrl","getServerWithProtocol","isSameServer","_url1","_url2","isSameDomain","url1","url2","domain1","domain2","isOrgOnline","isSamePortalUrl","_portalUrl1","_portalUrl2","patt1","patt2","updateUrlProtocolByOtherUrl","otherUrl","removeProtocol","setProtocol","getSharingUrl","sharingUrl","getOAuth2Url","oauth2Url","getAppIdUrl","_appId","appIdUrl","getSignInUrl","signInUrl","getBaseSearchUrl","searchUrl","getItemDataUrl","itemDataUrl","getItemGroupsUrl","getGenerateTokenUrl","tokenUrl","getItemDetailsPageUrl","getUserProfilePageUrl","getBaseGroupUrl","thePortalUrl","getPortalSelfInfoUrl","getCommunitySelfUrl","getUserTagsUrl","userTagsUrl","getUserThumbnailUrl","userId","thumbnail","thumbnailUrl","getUserContentItemUrl","userContentItemUrl","getItemResourceUrl","_customResUrl","itemResourceUrl","getAddItemUrl","addItemUrl","getDeleteItemUrl","deleteItemUrl","getUpdateItemUrl","updateItem","shareItemUrl","getHomeIndexUrl","getHomeMapViewerUrl","itemId","getHomeSceneViewerUrl","getHomeGalleryUrl","getHomeGroupsUrl","getHomeMyContentUrl","getHomeMyOrganizationUrl","getHomeUserUrl","getPortalHelpUrl","locale","getPortalAdminHelpUrl","getPortalProxyUrl","getOAuth2SignOutUrl","signOutUrl","getNewPrintUrl","getSwitchAccoutnsUrl","client_id","redirect_uri","__WEBPACK_EXTERNAL_MODULE__1__","__WEBPACK_EXTERNAL_MODULE__2__","__WEBPACK_EXTERNAL_MODULE__4__","__WEBPACK_EXTERNAL_MODULE__5__","__WEBPACK_EXTERNAL_MODULE__6__","Portal","PortalItem","esriConfig","IdentityManager","esriRequest","portalUrlUtils","portals","JimuPortal","_super","__extends","getItem","this","requestOptions","responseType","query","f","callbackParamName","getToken","token","then","res","data","getItemData","user","cred","findCredential","username","getPortal","createPortal","loaded","Promise","resolve","load","portal","checkItemTitleExist","userName","itemTitle","params","queryItems","queryResult","total","getDefaultWebScene","args","itemTypes","queryStr","allTypes","concat","getAllItemTypes","length","validStr","forEach","type","index","sumAllTypes","removedTypes","filter","removedType","every","itemType","getItemQueryStringByTypes","response","results","id","searchWABDefaultWebScene","webSceneId","getUser","operationalLayers","baseMap","title","baseMapLayers","layerType","elevationLayers","version","authoringApp","authoringAppVersion","spatialReference","wkid","latestWkid","viewingMode","initialState","viewpoint","scale","rotation","targetGeometry","x","y","z","camera","position","heading","tilt","environment","lighting","datetime","displayUTCOffset","presentation","slides","typeKeywords","tags","text","JSON","stringify","snippet","addItem","success","console","error","reject","createWABDefaultWebScene","portalService"],"mappings":"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","file":"jimu-arcgis/portal.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","export function getServerByUrl(_url){\n  _url = (_url || '').trim();\n  _url = _url.replace(/^(http(s?):?)\\/\\//gi, '');\n\n  if(_url.indexOf('//') === 0){\n    _url = _url.slice(2);\n  }\n\n  return _url.split('/')[0];\n};\n\nexport function getServerWithProtocol(_url){\n  var result = '';\n  _url = (_url || '').trim();\n\n  if(_url){\n    var server = getServerByUrl(_url);\n\n    if(!server){\n      return result;\n    }\n\n    var protocol = getProtocol(_url);\n\n    if(protocol){\n      result = protocol + \"://\" + server;\n    }\n    else if(_url.indexOf('//') === 0){\n      result = \"//\" + server;\n    }\n  }\n\n  return result;\n};\n\nexport function isSameServer(_url1, _url2){\n  _url1 = getServerByUrl(_url1) || \"\";\n  _url2 = getServerByUrl(_url2) || \"\";\n  return _url1.toLowerCase() === _url2.toLowerCase();\n};\n\nexport function getDomain(url) {\n  var serverName, matched, result = '';\n\n  serverName = getServerByUrl(url);\n  if (serverName) {\n    serverName = serverName.replace(/:\\d+$/, '');\n    matched = serverName.match(/[^.]\\w+\\.\\w+$/);\n    if (matched !== null) {\n      result = matched[0];\n      // if the url is an IP address, it isn't a vadli domain\n      if (/^\\d+\\.\\d+$/.test(result)) {\n        result = '';\n      }\n    }\n  }\n  return result;\n};\n\nexport function isSameDomain(url1, url2) {\n  var domain1 = getDomain(url1),\n    domain2 = getDomain(url2);\n\n  return domain1 !== '' && domain1 === domain2;\n};\n\nexport function isOrgOnline(_url){\n  var server = getServerByUrl(_url).toLowerCase();\n  return server.indexOf('.maps.arcgis.com') >= 0;\n};\n\nexport function isOnline(_url){\n  var server = getServerByUrl(_url).toLowerCase();\n  return server.indexOf('.arcgis.com') >= 0;\n};\n\nexport function isArcGIScom(_url){\n  var server = getServerByUrl(_url).toLowerCase();\n  return server === 'www.arcgis.com' || server === 'arcgis.com';\n};\n\nexport function getStandardPortalUrl(_portalUrl){\n  var server = getServerByUrl(_portalUrl);\n  if (server === '') {\n    return '';\n  }\n  if (isOnline(server)) {\n    if(isArcGIScom(server)){\n      server = 'www.arcgis.com';\n    }\n    _portalUrl = addProtocol(_portalUrl);\n    var protocol = getProtocol(_portalUrl);\n    _portalUrl = protocol + '://' + server;\n  } else {\n    _portalUrl = (_portalUrl || '').trim().replace(/sharing(.*)/gi, '').replace(/\\/*$/g, '');\n    _portalUrl = addProtocol(_portalUrl);\n    var pattStr = 'http(s?):\\/\\/' + server;\n    var pattern = new RegExp(pattStr, 'g');\n    var nail = _portalUrl.replace(pattern, '');\n    if (!nail) {\n      _portalUrl = _portalUrl + '/arcgis';\n    }\n  }\n\n  return _portalUrl;\n};\n\nexport function isSamePortalUrl(_portalUrl1, _portalUrl2){\n  //test: http://www.arcgis.com/sharing/rest === https://www.arcgis.com\n  //test: http://www.arcgis.com/ === https://www.arcgis.com\n  //test: //www.arcgis.com/sharing/rest === https://www.arcgis.com/\n  var patt1 = /^http(s?):\\/\\//gi;\n  var patt2 = /^\\/\\//gi;\n  _portalUrl1 = getStandardPortalUrl(_portalUrl1)\n  .toLowerCase().replace(patt1, '').replace(patt2, '');\n  _portalUrl2 = getStandardPortalUrl(_portalUrl2)\n  .toLowerCase().replace(patt1, '').replace(patt2, '');\n  return _portalUrl1 === _portalUrl2;\n};\n\nexport function addProtocol(url){\n  var noProtocol = url.toLowerCase().indexOf('http://') <= -1 &&\n    url.toLowerCase().indexOf('https://') <= -1;\n\n  if(noProtocol){\n    var defaultProtocol = '';\n    if(typeof window !== 'undefined' && window.location) {\n      //for client side\n      defaultProtocol = window.location.protocol;\n      if (url.startWith('//')) {\n        url = defaultProtocol + url; //http: + //js.arcgis.com\n      } else if (url.startWith('/')) {\n        // http: + // + localhost + /proxy.js\n        url = defaultProtocol + \"//\" + window.location.host + url;\n      } else {\n        url = defaultProtocol + \"//\" + url; //http: + // + www.arcgis.com\n      }\n    }\n    else{\n      //for server side\n      defaultProtocol = 'http:';\n      if (url.startWith('//')) {\n        url = defaultProtocol + url; //http: + //js.arcgis.com\n      } else {\n        url = defaultProtocol + \"//\" + url;\n      }\n    }\n\n  }\n  return url;\n};\n\nexport function getProtocol(url){\n  //test: http://www.arcgis.com => http\n  //test: https://www.arcgis.com => https\n  //test: //www.arcgis.com => ''\n  var protocol = '';\n  url = url.toLowerCase();\n  if(url.indexOf('https://') === 0){\n    protocol = 'https';\n  }\n  else if(url.indexOf('http://') === 0){\n    protocol = 'http';\n  }\n  return protocol;\n};\n\nexport function updateUrlProtocolByOtherUrl(url, otherUrl){\n  otherUrl = otherUrl.toLowerCase();\n  if(otherUrl.indexOf('https://') === 0){\n    url = setHttpsProtocol(url);\n  }else if(otherUrl.indexOf('http://') === 0){\n    url = setHttpProtocol(url);\n  }\n  return url;\n};\n\nexport function removeProtocol(_url){\n  //test: http://www.arcgis.com => //www.arcgis.com\n  //test: https://www.arcgis.com => //www.arcgis.com\n  return _url.replace(/^http(s?):\\/\\//i, '//');\n};\n\nexport function setHttpProtocol(_url){\n  _url = addProtocol(_url);\n  var reg = /^https:\\/\\//;\n  var url = _url.replace(reg, 'http://');\n  return url;\n};\n\nexport function setHttpsProtocol(_url){\n  _url = addProtocol(_url);\n  var reg = /^http:\\/\\//;\n  var url = _url.replace(reg, 'https://');\n  return url;\n};\n\nexport function setProtocol(_url, protocol){\n  if(protocol.indexOf('https') >= 0){\n    return setHttpsProtocol(_url);\n  }else if(protocol.indexOf('http') >= 0){\n    return setHttpProtocol(_url);\n  } else {\n    return _url;\n  }\n};\n\nexport function getSharingUrl(_portalUrl){\n  var sharingUrl = '';\n  var portalUrl = getStandardPortalUrl(_portalUrl);\n  if(portalUrl){\n    sharingUrl = portalUrl + '/sharing/rest';\n  }\n  return sharingUrl;\n};\n\nexport function getOAuth2Url(_portalUrl){\n  var oauth2Url = '';\n  var portalUrl = getStandardPortalUrl(_portalUrl);\n  if(portalUrl){\n    oauth2Url = portalUrl + '/sharing/rest/oauth2';\n  }\n  return oauth2Url;\n};\n\nexport function getAppIdUrl(_portalUrl, _appId){\n  var appIdUrl = '';\n  var portalUrl = getStandardPortalUrl(_portalUrl);\n  if(portalUrl){\n    appIdUrl = portalUrl + '/sharing/rest/oauth2/apps/' + _appId;\n  }\n  return appIdUrl;\n};\n\nexport function getSignInUrl(_portalUrl){\n  var signInUrl = \"\";\n  var portalUrl = getStandardPortalUrl(_portalUrl);\n  if(portalUrl){\n    signInUrl = portalUrl + \"/home/signin.html\";\n  }\n  return signInUrl;\n};\n\nexport function getBaseSearchUrl(_portalUrl){\n  var searchUrl = '';\n  var portalUrl = getStandardPortalUrl(_portalUrl);\n  portalUrl = portalUrl.replace(/\\/*$/g, '');\n  if(portalUrl){\n    searchUrl = portalUrl + '/sharing/rest/search';\n  }\n  return searchUrl;\n};\n\nexport function getBaseItemUrl(_portalUrl){\n  var baseItemUrl = '';\n  var portalUrl = getStandardPortalUrl(_portalUrl);\n  if(portalUrl){\n    baseItemUrl = portalUrl + '/sharing/rest/content/items';\n  }\n  return baseItemUrl;\n};\n\nexport function getItemUrl(_portalUrl, _itemId){\n  var itemUrl = '';\n  var baseItemUrl = getBaseItemUrl(_portalUrl);\n  if(baseItemUrl && _itemId){\n    itemUrl = baseItemUrl + '/' + _itemId;\n  }\n  return itemUrl;\n};\n\nexport function getItemDataUrl(_portalUrl, _itemId){\n  var itemDataUrl = '';\n  var itemUrl = getItemUrl(_portalUrl, _itemId);\n  if(itemUrl){\n    itemDataUrl = itemUrl + '/data';\n  }\n  return itemDataUrl;\n};\n\nexport function getItemGroupsUrl(_portalUrl, _itemId){\n  var itemDataUrl = '';\n  var itemUrl = getItemUrl(_portalUrl, _itemId);\n  if(itemUrl){\n    itemDataUrl = itemUrl + '/groups';\n  }\n  return itemDataUrl;\n};\n\nexport function getGenerateTokenUrl(_portalUrl){\n  var tokenUrl = '';\n  _portalUrl = getStandardPortalUrl(_portalUrl);\n  if(_portalUrl){\n    // tokenUrl = _portalUrl + '/sharing/rest/generateToken';\n    // The url should not include 'rest' because portal 10.3 doesn't support GET method with 'rest' and\n    // get following error\n    // {\"error\":{\"code\":405,\"messageCode\":\"GWM_0005\",\"message\":\"Method not supported.\",\"details\":[]}}\n    tokenUrl = _portalUrl + '/sharing/generateToken';\n  }\n  return tokenUrl;\n};\n\nexport function getItemDetailsPageUrl(_portalUrl, _itemId){\n  var url = '';\n  if(_portalUrl && _itemId){\n    _portalUrl = getStandardPortalUrl(_portalUrl);\n    url = _portalUrl + \"/home/item.html?id=\" + _itemId;\n  }\n  return url;\n};\n\nexport function getUserProfilePageUrl(_portalUrl, _user){\n  var url = '';\n  if(_portalUrl && _user){\n    _portalUrl = getStandardPortalUrl(_portalUrl);\n    url = _portalUrl + '/home/user.html?user=' + _user;\n  }\n  return url;\n};\n\nexport function getBaseGroupUrl(_portalUrl){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/sharing/rest/community/groups';\n  }\n  return url;\n};\n\nexport function getPortalSelfInfoUrl(_portalUrl){\n  var url = '';\n  var thePortalUrl = _portalUrl || '';\n  thePortalUrl = getStandardPortalUrl(thePortalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/sharing/rest/portals/self';\n  }\n  return url;\n};\n\nexport function getCommunitySelfUrl(_portalUrl){\n  var url = '';\n  var thePortalUrl = _portalUrl || '';\n  thePortalUrl = getStandardPortalUrl(thePortalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/sharing/rest/community/self';\n  }\n  return url;\n};\n\nexport function getBaseUserUrl(_portalUrl){\n  var baseUserUrl = '';\n  var portalUrl = getStandardPortalUrl(_portalUrl);\n  if(portalUrl){\n    baseUserUrl = portalUrl + '/sharing/rest/community/users';\n  }\n  return baseUserUrl;\n};\n\nexport function getUserUrl(_portalUrl, _userId){\n  var userUrl = '';\n  var baseUserUrl = getBaseUserUrl(_portalUrl);\n  if(_portalUrl && _userId){\n    userUrl = baseUserUrl + '/' + _userId;\n  }\n  return userUrl;\n};\n\nexport function getUserTagsUrl(_portalUrl, _userId){\n  var userTagsUrl = '';\n  var userUrl = getUserUrl(_portalUrl, _userId);\n  if(_portalUrl && _userId){\n    userTagsUrl = userUrl + '/tags';\n  }\n  return userTagsUrl;\n};\n\nexport function getUserThumbnailUrl(portalUrl, userId, thumbnail){\n  var thumbnailUrl = \"\";\n  var userUrl = getUserUrl(portalUrl, userId);\n  if(userUrl && thumbnail){\n    thumbnailUrl = userUrl + '/info/' + thumbnail;\n  }\n  return thumbnailUrl;\n};\n\nexport function getContentUrl(_portalUrl){\n  var contentUrl = '';\n  if(_portalUrl) {\n    _portalUrl = getStandardPortalUrl(_portalUrl);\n    contentUrl = _portalUrl + '/sharing/rest/content';\n  }\n  return contentUrl;\n};\n\nexport function getUserContentUrl(_portalUrl, _user, _folderId?){\n  var contentUrl = '', userContentUrl = '';\n  if(_portalUrl && _user) {\n    contentUrl = getContentUrl(_portalUrl);\n    if(_folderId) {\n      userContentUrl = contentUrl + '/users/' + _user + '/' + _folderId;\n    } else {\n      userContentUrl = contentUrl + '/users/' + _user;\n    }\n  }\n  return userContentUrl;\n};\n\nexport function getUserContentItemUrl(_portalUrl, _user, _itemId){\n  var userContentUrl = '',userContentItemUrl = '';\n  if(_portalUrl && _user && _itemId) {\n    userContentUrl = getUserContentUrl(_portalUrl, _user);\n    userContentItemUrl = userContentUrl + '/items/' + _itemId;\n  }\n  return userContentItemUrl;\n};\n\nexport function getItemResourceUrl(_portalUrl, _itemId, _customResUrl){\n  var contentUrl = '',itemResourceUrl = '';\n  if(_portalUrl && _itemId) {\n    contentUrl = getContentUrl(_portalUrl);\n    if(_customResUrl){\n      itemResourceUrl = contentUrl + '/items/' + _itemId + '/resources/' + _customResUrl;\n    }else{\n      itemResourceUrl = contentUrl + '/items/' + _itemId + '/resources';\n    }\n  }\n  return itemResourceUrl;\n};\n\nexport function getAddItemUrl(_portalUrl, _user, _folderId){\n  var userContentUrl = '', addItemUrl = '';\n  if(_portalUrl && _user) {\n    userContentUrl = getUserContentUrl(_portalUrl, _user, _folderId);\n    addItemUrl = userContentUrl + '/addItem' ;\n  }\n  return addItemUrl;\n};\n\nexport function getDeleteItemUrl(_portalUrl, _user, _itemId){\n  var deleteItemUrl = '';\n  var userItemsUrl = getUserItemsUrl(_portalUrl, _user);\n  if(userItemsUrl){\n    deleteItemUrl = userItemsUrl + '/' + _itemId + '/delete';\n  }\n  return deleteItemUrl;\n};\n\n\nexport function getUserItemsUrl(_portalUrl, _user, _folderId?) {\n  var userContentUrl = '', userItemsUrl = '';\n  if(_portalUrl && _user) {\n    userContentUrl = getUserContentUrl(_portalUrl, _user, _folderId);\n    userItemsUrl = userContentUrl + '/items' ;\n  }\n  return userItemsUrl;\n};\n\nexport function getUpdateItemUrl(_portalUrl, _user, _itemId, _folderId) {\n  var userItemsUrl = '', updateItem = '';\n  if(_portalUrl && _user) {\n    userItemsUrl = getUserItemsUrl(_portalUrl, _user, _folderId);\n    updateItem = userItemsUrl + '/' + _itemId + \"/update\";\n  }\n  return updateItem;\n};\n\nexport function shareItemUrl(_portalUrl, _user, _itemId, _folderId) {\n  var userItemsUrl = '', shareItemUrl = '';\n  if(_portalUrl && _user) {\n    userItemsUrl = getUserItemsUrl(_portalUrl, _user, _folderId);\n    shareItemUrl = userItemsUrl + '/' + _itemId + \"/share\";\n  }\n  return shareItemUrl;\n};\n\nexport function getHomeIndexUrl(_portalUrl){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/home/index.html';\n  }\n  return url;\n};\n\nexport function getHomeMapViewerUrl(_portalUrl, /* optional */ itemId){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/home/webmap/viewer.html';\n    if(itemId){\n      url += \"?webmap=\" + itemId;\n    }\n    else{\n      url += \"?useExisting=1\";\n    }\n  }\n  return url;\n};\n\nexport function getHomeSceneViewerUrl(_portalUrl, /* optional */ itemId){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/home/webscene/viewer.html';\n    if(itemId){\n      url += \"?webscene=\" + itemId;\n    }\n  }\n  return url;\n};\n\nexport function getHomeGalleryUrl(_portalUrl){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/home/gallery.html';\n  }\n  return url;\n};\n\nexport function getHomeGroupsUrl(_portalUrl){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/home/groups.html';\n  }\n  return url;\n};\n\nexport function getHomeMyContentUrl(_portalUrl){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/home/content.html';\n  }\n  return url;\n};\n\nexport function getHomeMyOrganizationUrl(_portalUrl){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/home/organization.html';\n  }\n  return url;\n};\n\nexport function getHomeUserUrl(_portalUrl){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/home/user.html';\n  }\n  return url;\n};\n\n//locale is optional, default value is 'en'\nexport function getPortalHelpUrl(_portalUrl, locale){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    var l = locale || \"en\";\n    url = thePortalUrl + \"/portalhelp/\" + l + \"/website/help/\";\n  }\n  return url;\n};\n\nexport function getPortalAdminHelpUrl(_portalUrl, locale){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    var l = locale || \"en\";\n    url = thePortalUrl + '/portalhelp/' + l + \"/admin/help/\";\n  }\n  return url;\n};\n\nexport function getPortalProxyUrl(_portalUrl){\n  //examples:\n  //http://esridevbeijing.maps.arcgis.com/sharing/proxy\n  //http://gallery.chn.esri.com/arcgis/sharing/proxy\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    url = thePortalUrl + '/sharing/proxy';\n  }\n  return url;\n};\n\nexport function getOAuth2SignOutUrl(_portalUrl){\n  var signOutUrl = \"\";\n  var portalUrl = getStandardPortalUrl(_portalUrl);\n  if(portalUrl){\n    signOutUrl = portalUrl + '/sharing/rest/oauth2/signout';//?redirect_uri=http://...\n  }\n  return signOutUrl;\n};\n\nexport function getNewPrintUrl(_portalUrl){\n  var url = '';\n  var thePortalUrl = getStandardPortalUrl(_portalUrl);\n  if(thePortalUrl){\n    thePortalUrl = setHttpProtocol(thePortalUrl);\n    url = thePortalUrl + '/sharing/tools/newPrint';\n  }\n  return url;\n};\n\nexport function getSwitchAccoutnsUrl(_portalUrl, client_id, /*optional*/ redirect_uri){\n  var url = '';\n  var portalUrl = getStandardPortalUrl(_portalUrl);\n  if(portalUrl){\n    url = portalUrl + \"/home/pages/Account/manage_accounts.html#client_id=\" + client_id;\n    if(redirect_uri){\n      url += \"&redirect_uri=\" + redirect_uri;\n    }\n  }\n  if(url){\n    url = setHttpsProtocol(url);\n  }\n  return url;\n};\n\n","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","module.exports = __WEBPACK_EXTERNAL_MODULE__4__;","module.exports = __WEBPACK_EXTERNAL_MODULE__5__;","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","import Portal = require('esri/portal/Portal');\nimport PortalItem = require('esri/portal/PortalItem');\nimport PortalQueryParams = require('esri/portal/PortalQueryParams');\nimport esriConfig = require('esri/config');\nimport IdentityManager = require('esri/identity/IdentityManager');\nimport esriRequest = require('esri/request');\n\nimport * as portalUrlUtils from '../../utils/portal-url-utils';\n\nvar portals: {[portalUrl: string]: JimuPortal} = {};\n\nexport class JimuPortal extends Portal{\n  getItem(itemId: string): Promise<PortalItem>{\n    var itemUrl = portalUrlUtils.getItemUrl(this.url, itemId);\n    var requestOptions: __esri.requestEsriRequestOptions = {\n      responseType: 'json',\n      query: {\n        f: 'json'\n      },\n      callbackParamName: 'callback'\n    };\n\n    if(this.getToken()){\n      requestOptions.query.token = this.getToken();\n    }\n\n    return esriRequest(itemUrl, requestOptions).then(res => {\n      var portalItem = new PortalItem(res.data);\n      return portalItem;\n    });\n  }\n\n  getItemData(itemId: string): Promise<any>{\n    var itemDataUrl = portalUrlUtils.getItemDataUrl(this.url, itemId);\n    var requestOptions: __esri.requestEsriRequestOptions = {\n      responseType: 'json',\n      query: {\n        f: 'json'\n      },\n      callbackParamName: 'callback'\n    };\n\n    if(this.getToken()){\n      requestOptions.query.token = this.getToken();\n    }\n\n    return esriRequest(itemDataUrl, requestOptions).then(res => {\n      return res.data;\n    });\n  }\n\n\n\n  /**\n   * get the signed in user's token.\n   * if there is user has signed in, return null\n   */\n  getToken(): string{\n    if(!this.user){\n      return null;\n    }\n\n    let cred = IdentityManager.findCredential(this.url, this.user.username);\n    if(!cred){\n      return null;\n    }\n\n    return cred.token;\n  }\n}\n\nexport function getPortal(portalUrl: string = esriConfig.portalUrl): JimuPortal{\n  return portals[portalUrl];\n}\n\nexport function createPortal(portalUrl: string = esriConfig.portalUrl): Promise<JimuPortal>{\n  if(portals[portalUrl]){\n    if(portals[portalUrl].loaded){\n      return Promise.resolve(portals[portalUrl]);\n    }else{\n      return portals[portalUrl].load().then(portal => portal) as Promise<JimuPortal>;\n    }\n  }else{\n    let portal = new JimuPortal({url: portalUrl});\n    portals[portalUrl] = portal;\n    return portals[portalUrl].load().then(portal => portal) as Promise<JimuPortal>;\n  }\n}\n\nexport function checkItemTitleExist(portalUrl: string, userName: string, itemTitle: string){\n  var q = 'owner:' + userName + ' title:' + itemTitle;\n  var params = {\n    query: q\n  };\n\n  return getPortal(portalUrl).queryItems(params as PortalQueryParams).then(function(queryResult) {\n    if(queryResult.total > 0) {\n      return true;\n    } else {\n      return false;\n    }\n  });\n}\n\nexport function getDefaultWebScene(_portalUrl: string): Promise<string>{\n  var portalUrl = portalUrlUtils.getStandardPortalUrl(_portalUrl);\n  return searchWABDefaultWebScene(portalUrl).then(function(webSceneId){\n    if(webSceneId){\n      return webSceneId;\n    }else{\n      return createWABDefaultWebScene(portalUrl).\n      then(function(webSceneId){\n        var portal = getPortal(portalUrl);\n        var canShareToPublic = false;\n        let user = portal.user;\n        // if(user && user.privileges && user.privileges.length > 0){\n        //   canShareToPublic = user.privileges.some(function(privilege){\n        //     return privilege.indexOf(\"shareToPublic\") >= 0;\n        //   });\n        // }\n        if(canShareToPublic){\n          //If user has \"shareToPublic\" privilege,\n          //we should share this newly created web scene to everyone.\n          var args = {\n            everyone: true\n          };\n          return webSceneId;\n          // return user.shareItem(args, webSceneId).then(function(){\n          //   return webSceneId;\n          // }, function(){\n          //   return webSceneId;\n          // });\n        }else{\n          return webSceneId;\n        }\n      });\n    }\n  });\n}\n\nfunction searchWABDefaultWebScene(_portalUrl): Promise<string>{\n  var portalUrl = portalUrlUtils.getStandardPortalUrl(_portalUrl);\n  var portal = getPortal(portalUrl);\n  var webSceneQueryStr = ' ' + getItemQueryStringByTypes(['Web Scene']) + ' ';\n  //must use double quotation marks around typeKeywords\n  //such as typekeywords:\"Web AppBuilder\" or typekeywords:\"Web AppBuilder,Web Map\"\n  var q = 'typekeywords:\"WABDefaultWebScene\" access:public ' + webSceneQueryStr;\n  var args = {\n    query: q\n  };\n  return portal.queryItems(args as PortalQueryParams).then(function(response){\n    if(response && response.results && response.results.length > 0){\n      return response.results[0].id;\n    }else{\n      return null;\n    }\n  });\n}\n\nfunction createWABDefaultWebScene(portalUrl){\n  portalUrl = portalUrlUtils.getStandardPortalUrl(portalUrl);\n  var portal = this.getPortal(portalUrl);\n  return portal.getUser().then(function(user){\n    var url1 = \"http://services.arcgisonline.com/ArcGIS/rest/services/\" +\n               \"World_Imagery/MapServer\";\n    var url2 = \"http://elevation3d.arcgis.com/arcgis/rest/services/\" +\n               \"WorldElevation3D/Terrain3D/ImageServer\";\n    var data = {\n      \"operationalLayers\": [],\n      \"baseMap\": {\n        \"id\": \"151b431fe65-basemap-0\",\n        \"title\": \"Topographic\",\n        \"baseMapLayers\": [{\n          \"id\": \"defaultBasemap\",\n          \"url\": url1,\n          \"layerType\": \"ArcGISTiledMapServiceLayer\"\n        }],\n        \"elevationLayers\": [{\n          \"id\": \"globalElevation\",\n          \"url\": url2,\n          \"layerType\": \"ArcGISTiledElevationServiceLayer\"\n        }]\n      },\n      \"version\": \"1.3\",\n      \"authoringApp\": \"WebSceneViewer\",\n      \"authoringAppVersion\": \"3.10.0.0\",\n      \"spatialReference\": {\n        \"wkid\": 102100,\n        \"latestWkid\": 3857\n      },\n      \"viewingMode\": \"global\",\n      \"initialState\": {\n        \"viewpoint\": {\n          \"scale\": 45188197.847224146,\n          \"rotation\": 0,\n          \"targetGeometry\": {\n            \"x\": 144770.99872895706,\n            \"y\": 3232837.215000455,\n            \"spatialReference\": {\n              \"wkid\": 102100,\n              \"latestWkid\": 3857\n            },\n            \"z\": -127.7412482528016\n          },\n          \"camera\": {\n            \"position\": {\n              \"x\": 144770.99767624016,\n              \"y\": 3182557.105058348,\n              \"spatialReference\": {\n                \"wkid\": 102100,\n                \"latestWkid\": 3857\n              },\n              \"z\": 25512548.00000001\n            },\n            \"heading\": 0,\n            \"tilt\": 0.0999986601088944\n          }\n        },\n        \"environment\": {\n          \"lighting\": {\n            \"datetime\": 1426420488000,\n            \"displayUTCOffset\": 0\n          }\n        }\n      },\n      \"presentation\": {\n        \"slides\": []\n      }\n    };\n    var text = JSON.stringify(data);\n    var args = {\n      title: \"Default Web Scene\",\n      type: \"Web Scene\",\n      typeKeywords: \"WABDefaultWebScene\",\n      tags: \"default\",\n      text: text,\n      snippet: \"\"\n    };\n    return user.addItem(args, \"\").then(function(response){\n      if (response.success) {\n        return response.id;\n      }else{\n        console.error(\"Can't create default web scene:\", response);\n        return Promise.reject(response);\n      }\n    });\n  });\n}\n\nfunction getAllItemTypes() {\n  var allTypes = [];\n  //Web Content\n  var maps1 = ['Web Map', 'Web Scene', 'CityEngine Web Scene'];\n  var layers1 = ['Feature Service', 'Map Service', 'Image Service', 'KML', 'WMS',\n  'Feature Collection', 'Feature Collection Template', 'Geodata Service', 'Globe Service'];\n  var tools1 = ['Geometry Service', 'Geocoding Service', 'Network Analysis Service',\n  'Geoprocessing Service'];\n  var applications1 = ['Web Mapping Application', 'Mobile Application', 'Code Attachment',\n  'Operations Dashboard Add In', 'Operation View'];\n  var datafiles1 = ['Symbol Set', 'Color Set', 'Shapefile', 'CSV', 'Service Definition',\n  'Document Link', 'Microsoft Word', 'Microsoft PowerPoint', 'Microsoft Excel', 'PDF',\n  'Image', 'Visio Document'];\n  //Desktop Content\n  var maps2 = ['Map Document', 'Map Package', 'Tile Package', 'ArcPad Package',\n  'Explorer Map', 'Globe Document', 'Scene Document', 'Published Map', 'Map Template',\n  'Windows Mobile Package'];\n  var layers2 = ['Layer', 'Layer Package', 'Explorer Layer'];\n  var tools2 = ['Geoprocessing Package', 'Geoprocessing Sample', 'Locator Package',\n  'Rule Package'];\n  var applications2 = ['Workflow Manager Package', 'Desktop Application',\n  'Desktop Application Template', 'Code Sample', 'Desktop Add In', 'Explorer Add In'];\n\n  allTypes = allTypes.concat(maps1).concat(layers1).concat(tools1)\n  .concat(applications1).concat(datafiles1);\n  allTypes = allTypes.concat(maps2).concat(layers2).concat(tools2).concat(applications2);\n  return allTypes;\n}\n\nfunction getItemQueryStringByTypes(itemTypes) {\n  var queryStr = '';\n  var allTypes = getAllItemTypes();\n  if (itemTypes && itemTypes.length > 0) {\n    if (itemTypes.length > 0) {\n      var validStr = '';\n      itemTypes.forEach(function(type, index) {\n        var s = ' type:\"' + type + '\" ';\n        validStr += s;\n        if (index !== itemTypes.length - 1) {\n          validStr += ' OR ';\n        }\n      });\n      queryStr = ' ( ' + validStr + ' ) ';\n      var sumAllTypes = itemTypes.concat(allTypes);\n      var removedTypes = sumAllTypes.filter(function(removedType){\n        return itemTypes.every(function(itemType){\n          return itemType.toLowerCase().indexOf(removedType.toLowerCase()) < 0;\n        });\n      });\n\n      removedTypes.forEach(function(type) {\n        var s = ' -type:\"' + type + '\" ';\n        queryStr += s;\n      });\n    }\n  }\n  return queryStr;\n};","import * as portalService from './lib/services/portal/portal-service';\nimport * as portalUrlUtils from './lib/utils/portal-url-utils';\n\nexport {portalService, portalUrlUtils}\n\n"],"sourceRoot":""}